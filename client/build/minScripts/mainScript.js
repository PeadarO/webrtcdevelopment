
if(function(e,t){var n=e;n.version="0.9.0",n.protocol=1,n.transports=[],n.j=[],n.sockets={},n.connect=function(e,o){var i,r,s,a=n.util.parseUri(e);return t&&t.location&&(a.protocol=a.protocol||t.location.protocol.slice(0,-1),a.host=a.host||(t.document?t.document.domain:t.location.hostname),a.port=a.port||t.location.port),i=n.util.uniqueUri(a),s={host:a.host,secure:"https"==a.protocol,port:a.port||("https"==a.protocol?443:80),query:a.query||""},n.util.merge(s,o),(s["force new connection"]||!n.sockets[i])&&(r=new n.Socket(s)),!s["force new connection"]&&r&&(n.sockets[i]=r),r=r||n.sockets[i],r.of(a.path.length>1?a.path:"")}}("object"==typeof module?module.exports:this.io={},this),function(e,t){var n,o=e.util={},i=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,r=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];o.parseUri=function(e){for(var t=i.exec(e||""),n={},o=14;o--;)n[r[o]]=t[o]||"";return n},o.uniqueUri=function(e){var n=e.protocol,o=e.host,i=e.port;return"document"in t?(o=o||document.domain,i=i||("https"==n&&"https:"!==document.location.protocol?443:document.location.port)):(o=o||"localhost",i||"https"!=n||(i=443)),(n||"http")+"://"+o+":"+(i||80)},o.query=function(e,t){var n,i=o.chunkQuery(e||""),r=[];o.merge(i,o.chunkQuery(t||""));for(n in i)i.hasOwnProperty(n)&&r.push(n+"="+i[n]);return r.length?"?"+r.join("&"):""},o.chunkQuery=function(e){for(var t,n={},o=e.split("&"),i=0,r=o.length;r>i;++i)t=o[i].split("="),t[0]&&(n[t[0]]=t[1]);return n},n=!1,o.load=function(e){return"document"in t&&"complete"===document.readyState||n?e():void o.on(t,"load",e,!1)},o.on=function(e,t,n,o){e.attachEvent?e.attachEvent("on"+t,n):e.addEventListener&&e.addEventListener(t,n,o)},o.request=function(e){if(e&&"undefined"!=typeof XDomainRequest)return new XDomainRequest;if("undefined"!=typeof XMLHttpRequest&&(!e||o.ua.hasCORS))return new XMLHttpRequest;if(!e)try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}return null},"undefined"!=typeof window&&o.load(function(){n=!0}),o.defer=function(e){return o.ua.webkit&&"undefined"==typeof importScripts?void o.load(function(){setTimeout(e,100)}):e()},o.merge=function(e,t,n,i){var r,s=i||[],a="undefined"==typeof n?2:n;for(r in t)t.hasOwnProperty(r)&&o.indexOf(s,r)<0&&("object"==typeof e[r]&&a?o.merge(e[r],t[r],a-1,s):(e[r]=t[r],s.push(t[r])));return e},o.mixin=function(e,t){o.merge(e.prototype,t.prototype)},o.inherit=function(e,t){function n(){}n.prototype=t.prototype,e.prototype=new n},o.isArray=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},o.intersect=function(e,t){for(var n=[],i=e.length>t.length?e:t,r=e.length>t.length?t:e,s=0,a=r.length;a>s;s++)~o.indexOf(i,r[s])&&n.push(r[s]);return n},o.indexOf=function(e,t,n){for(var o=e.length,n=0>n?0>n+o?0:n+o:n||0;o>n&&e[n]!==t;n++);return n>=o?-1:n},o.toArray=function(e){for(var t=[],n=0,o=e.length;o>n;n++)t.push(e[n]);return t},o.ua={},o.ua.hasCORS="undefined"!=typeof XMLHttpRequest&&function(){try{var e=new XMLHttpRequest}catch(t){return!1}return void 0!=e.withCredentials}(),o.ua.webkit="undefined"!=typeof navigator&&/webkit/i.test(navigator.userAgent)}("undefined"!=typeof io?io:module.exports,this),function(e,t){function n(){}e.EventEmitter=n,n.prototype.on=function(e,n){return this.$events||(this.$events={}),this.$events[e]?t.util.isArray(this.$events[e])?this.$events[e].push(n):this.$events[e]=[this.$events[e],n]:this.$events[e]=n,this},n.prototype.addListener=n.prototype.on,n.prototype.once=function(e,t){function n(){o.removeListener(e,n),t.apply(this,arguments)}var o=this;return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,n){var o,i,r,s;if(this.$events&&this.$events[e])if(o=this.$events[e],t.util.isArray(o)){for(i=-1,r=0,s=o.length;s>r;r++)if(o[r]===n||o[r].listener&&o[r].listener===n){i=r;break}if(0>i)return this;o.splice(i,1),o.length||delete this.$events[e]}else(o===n||o.listener&&o.listener===n)&&delete this.$events[e];return this},n.prototype.removeAllListeners=function(e){return this.$events&&this.$events[e]&&(this.$events[e]=null),this},n.prototype.listeners=function(e){return this.$events||(this.$events={}),this.$events[e]||(this.$events[e]=[]),t.util.isArray(this.$events[e])||(this.$events[e]=[this.$events[e]]),this.$events[e]},n.prototype.emit=function(e){var n,o,i,r,s;if(!this.$events)return!1;if(n=this.$events[e],!n)return!1;if(o=Array.prototype.slice.call(arguments,1),"function"==typeof n)n.apply(this,o);else{if(!t.util.isArray(n))return!1;for(i=n.slice(),r=0,s=i.length;s>r;r++)i[r].apply(this,o)}return!0}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(n,t){"use strict";function u(e){return 10>e?"0"+e:e}function a(e){return isFinite(e.valueOf())?e.getUTCFullYear()+"-"+u(e.getUTCMonth()+1)+"-"+u(e.getUTCDate())+"T"+u(e.getUTCHours())+":"+u(e.getUTCMinutes())+":"+u(e.getUTCSeconds())+"Z":null}function s(e){return h.lastIndex=0,h.test(e)?'"'+e.replace(h,function(e){var t=l[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function e(t,n){var o,c,p,u,l,h=i,d=n[t];switch(d instanceof Date&&(d=a(t)),"function"==typeof r&&(d=r.call(n,t,d)),typeof d){case"string":return s(d);case"number":return isFinite(d)?String(d):"null";case"boolean":case"null":return String(d);case"object":if(!d)return"null";if(i+=f,l=[],"[object Array]"===Object.prototype.toString.apply(d)){for(u=d.length,o=0;u>o;o+=1)l[o]=e(o,d)||"null";return p=0===l.length?"[]":i?"[\n"+i+l.join(",\n"+i)+"\n"+h+"]":"["+l.join(",")+"]",i=h,p}if(r&&"object"==typeof r)for(u=r.length,o=0;u>o;o+=1)"string"==typeof r[o]&&(c=r[o],p=e(c,d),p&&l.push(s(c)+(i?": ":":")+p));else for(c in d)Object.prototype.hasOwnProperty.call(d,c)&&(p=e(c,d),p&&l.push(s(c)+(i?": ":":")+p));return p=0===l.length?"{}":i?"{\n"+i+l.join(",\n"+i)+"\n"+h+"}":"{"+l.join(",")+"}",i=h,p}}var o;if(t&&t.parse)return n.JSON={parse:t.parse,stringify:t.stringify};o=n.JSON={};var c=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,h=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,i,f,l={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},r;o.stringify=function(t,n,o){var s;if(i="",f="","number"==typeof o)for(s=0;o>s;s+=1)f+=" ";else"string"==typeof o&&(f=o);if(r=n,n&&"function"!=typeof n&&("object"!=typeof n||"number"!=typeof n.length))throw new Error("JSON.stringify");return e("",{"":t})},o.parse=function(n,t){function r(e,n){var o,i,s=e[n];if(s&&"object"==typeof s)for(o in s)Object.prototype.hasOwnProperty.call(s,o)&&(i=r(s,o),void 0!==i?s[o]=i:delete s[o]);return t.call(e,n,s)}var i;if(n=String(n),c.lastIndex=0,c.test(n)&&(n=n.replace(c,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(n.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return i=eval("("+n+")"),"function"==typeof t?r({"":i},""):i;throw new SyntaxError("JSON.parse")}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof JSON?JSON:void 0),function(e,t){var n,o=e.parser={},i=o.packets=["disconnect","connect","heartbeat","message","json","event","ack","error","noop"],r=o.reasons=["transport not supported","client not handshaken","unauthorized"],s=o.advice=["reconnect"],a=t.JSON,c=t.util.indexOf;o.encodePacket=function(e){var t,n,o,p,u=c(i,e.type),l=e.id||"",h=e.endpoint||"",f=e.ack,d=null;switch(e.type){case"error":t=e.reason?c(r,e.reason):"",n=e.advice?c(s,e.advice):"",(""!==t||""!==n)&&(d=t+(""!==n?"+"+n:""));break;case"message":""!==e.data&&(d=e.data);break;case"event":o={name:e.name},e.args&&e.args.length&&(o.args=e.args),d=a.stringify(o);break;case"json":d=a.stringify(e.data);break;case"connect":e.qs&&(d=e.qs);break;case"ack":d=e.ackId+(e.args&&e.args.length?"+"+a.stringify(e.args):"")}return p=[u,l+("data"==f?"+":""),h],null!==d&&void 0!==d&&p.push(d),p.join(":")},o.encodePayload=function(e){var t,n,o,i="";if(1==e.length)return e[0];for(t=0,n=e.length;n>t;t++)o=e[t],i+="�"+o.length+"�"+e[t];return i},n=/([^:]+):([0-9]+)?(\+)?:([^:]+)?:?([\s\S]*)?/,o.decodePacket=function(e){var t,o=e.match(n);if(!o)return{};var c=o[2]||"",e=o[5]||"",p={type:i[o[1]],endpoint:o[4]||""};switch(c&&(p.id=c,p.ack=o[3]?"data":!0),p.type){case"error":o=e.split("+"),p.reason=r[o[0]]||"",p.advice=s[o[1]]||"";break;case"message":p.data=e||"";break;case"event":try{t=a.parse(e),p.name=t.name,p.args=t.args}catch(u){}p.args=p.args||[];break;case"json":try{p.data=a.parse(e)}catch(u){}break;case"connect":p.qs=e||"";break;case"ack":if(o=e.match(/^([0-9]+)(\+)?(.*)/),o&&(p.ackId=o[1],p.args=[],o[3]))try{p.args=o[3]?a.parse(o[3]):[]}catch(u){}}return p},o.decodePayload=function(e){var t,n,i;if("�"==e.charAt(0)){for(t=[],n=1,i="";n<e.length;n++)"�"==e.charAt(n)?(t.push(o.decodePacket(e.substr(n+1).substr(0,i))),n+=Number(i)+1,i=""):i+=e.charAt(n);return t}return[o.decodePacket(e)]}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(e,t){function n(e,t){this.socket=e,this.sessid=t}e.Transport=n,t.util.mixin(n,t.EventEmitter),n.prototype.onData=function(e){var n,o,i;if(this.clearCloseTimeout(),(this.socket.connected||this.socket.connecting||this.socket.reconnecting)&&this.setCloseTimeout(),""!==e&&(n=t.parser.decodePayload(e),n&&n.length))for(o=0,i=n.length;i>o;o++)this.onPacket(n[o]);return this},n.prototype.onPacket=function(e){return"heartbeat"==e.type?this.onHeartbeat():("connect"==e.type&&""==e.endpoint&&this.onConnect(),this.socket.onPacket(e),this)},n.prototype.setCloseTimeout=function(){if(!this.closeTimeout){var e=this;this.closeTimeout=setTimeout(function(){e.onDisconnect()},this.socket.closeTimeout)}},n.prototype.onDisconnect=function(){return this.close&&this.open&&this.close(),this.clearTimeouts(),this.socket.onDisconnect(),this},n.prototype.onConnect=function(){return this.socket.onConnect(),this},n.prototype.clearCloseTimeout=function(){this.closeTimeout&&(clearTimeout(this.closeTimeout),this.closeTimeout=null)},n.prototype.clearTimeouts=function(){this.clearCloseTimeout(),this.reopenTimeout&&clearTimeout(this.reopenTimeout)},n.prototype.packet=function(e){this.send(t.parser.encodePacket(e))},n.prototype.onHeartbeat=function(){this.packet({type:"heartbeat"})},n.prototype.onOpen=function(){this.open=!0,this.clearCloseTimeout(),this.socket.onOpen()},n.prototype.onClose=function(){this.open=!1,this.socket.onClose(),this.onDisconnect()},n.prototype.prepareUrl=function(){var e=this.socket.options;return this.scheme()+"://"+e.host+":"+e.port+"/"+e.resource+"/"+t.protocol+"/"+this.name+"/"+this.sessid},n.prototype.ready=function(e,t){t.call(this)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(e,t,n){function o(e){if(this.options={port:80,secure:!1,document:"document"in n?document:!1,resource:"socket.io",transports:t.transports,"connect timeout":1e4,"try multiple transports":!0,reconnect:!0,"reconnection delay":500,"reconnection limit":1/0,"reopen delay":3e3,"max reconnection attempts":10,"sync disconnect on unload":!0,"auto connect":!0,"flash policy port":10843},t.util.merge(this.options,e),this.connected=!1,this.open=!1,this.connecting=!1,this.reconnecting=!1,this.namespaces={},this.buffer=[],this.doBuffer=!1,this.options["sync disconnect on unload"]&&(!this.isXDomain()||t.util.ua.hasCORS)){var o=this;t.util.on(n,"beforeunload",function(){o.disconnectSync()},!1)}this.options["auto connect"]&&this.connect()}function i(){}e.Socket=o,t.util.mixin(o,t.EventEmitter),o.prototype.of=function(e){return this.namespaces[e]||(this.namespaces[e]=new t.SocketNamespace(this,e),""!==e&&this.namespaces[e].packet({type:"connect"})),this.namespaces[e]},o.prototype.publish=function(){var e,t;this.emit.apply(this,arguments);for(t in this.namespaces)this.namespaces.hasOwnProperty(t)&&(e=this.of(t),e.$emit.apply(e,arguments))},o.prototype.handshake=function(e){function n(t){t instanceof Error?a.onError(t.message):e.apply(null,t.split(":"))}var o,r,s,a=this,c=this.options,p=["http"+(c.secure?"s":"")+":/",c.host+":"+c.port,c.resource,t.protocol,t.util.query(this.options.query,"t="+ +new Date)].join("/");this.isXDomain()&&!t.util.ua.hasCORS?(o=document.getElementsByTagName("script")[0],r=document.createElement("script"),r.src=p+"&jsonp="+t.j.length,o.parentNode.insertBefore(r,o),t.j.push(function(e){n(e),r.parentNode.removeChild(r)})):(s=t.util.request(),s.open("GET",p,!0),s.withCredentials=!0,s.onreadystatechange=function(){4==s.readyState&&(s.onreadystatechange=i,200==s.status?n(s.responseText):!a.reconnecting&&a.onError(s.responseText))},s.send(null))},o.prototype.getTransport=function(e){for(var n,o=e||this.transports,i=0;n=o[i];i++)if(t.Transport[n]&&t.Transport[n].check(this)&&(!this.isXDomain()||t.Transport[n].xdomainCheck()))return new t.Transport[n](this,this.sessionid);return null},o.prototype.connect=function(e){if(this.connecting)return this;var n=this;return this.handshake(function(o,i,r,s){function a(e){return n.transport&&n.transport.clearTimeouts(),n.transport=n.getTransport(e),n.transport?void n.transport.ready(n,function(){n.connecting=!0,n.publish("connecting",n.transport.name),n.transport.open(),n.options["connect timeout"]&&(n.connectTimeoutTimer=setTimeout(function(){if(!n.connected&&(n.connecting=!1,n.options["try multiple transports"])){n.remainingTransports||(n.remainingTransports=n.transports.slice(0));for(var e=n.remainingTransports;e.length>0&&e.splice(0,1)[0]!=n.transport.name;);e.length?a(e):n.publish("connect_failed")}},n.options["connect timeout"]))}):n.publish("connect_failed")}n.sessionid=o,n.closeTimeout=1e3*r,n.heartbeatTimeout=1e3*i,n.transports=t.util.intersect(s.split(","),n.options.transports),a(),n.once("connect",function(){clearTimeout(n.connectTimeoutTimer),e&&"function"==typeof e&&e()})}),this},o.prototype.packet=function(e){return this.connected&&!this.doBuffer?this.transport.packet(e):this.buffer.push(e),this},o.prototype.setBuffer=function(e){this.doBuffer=e,!e&&this.connected&&this.buffer.length&&(this.transport.payload(this.buffer),this.buffer=[])},o.prototype.disconnect=function(){return this.connected&&(this.open&&this.of("").packet({type:"disconnect"}),this.onDisconnect("booted")),this},o.prototype.disconnectSync=function(){var e=t.util.request(),n=this.resource+"/"+t.protocol+"/"+this.sessionid;e.open("GET",n,!0),this.onDisconnect("booted")},o.prototype.isXDomain=function(){var e=n.location.port||("https:"==n.location.protocol?443:80);return this.options.host!==n.location.hostname||this.options.port!=e},o.prototype.onConnect=function(){this.connected||(this.connected=!0,this.connecting=!1,this.doBuffer||this.setBuffer(!1),this.emit("connect"))},o.prototype.onOpen=function(){this.open=!0},o.prototype.onClose=function(){this.open=!1},o.prototype.onPacket=function(e){this.of(e.endpoint).onPacket(e)},o.prototype.onError=function(e){e&&e.advice&&this.options.reconnect&&"reconnect"===e.advice&&this.connected&&(this.disconnect(),this.reconnect()),this.publish("error",e&&e.reason?e.reason:e)},o.prototype.onDisconnect=function(e){var t=this.connected;this.connected=!1,this.connecting=!1,this.open=!1,t&&(this.transport.close(),this.transport.clearTimeouts(),this.publish("disconnect",e),"booted"!=e&&this.options.reconnect&&!this.reconnecting&&this.reconnect())},o.prototype.reconnect=function(){function e(){if(n.connected){for(var e in n.namespaces)n.namespaces.hasOwnProperty(e)&&""!==e&&n.namespaces[e].packet({type:"connect"});n.publish("reconnect",n.transport.name,n.reconnectionAttempts)}clearTimeout(n.reconnectionTimer),n.removeListener("connect_failed",t),n.removeListener("connect",t),n.reconnecting=!1,delete n.reconnectionAttempts,delete n.reconnectionDelay,delete n.reconnectionTimer,delete n.redoTransports,n.options["try multiple transports"]=i}function t(){return n.reconnecting?n.connected?e():n.connecting&&n.reconnecting?n.reconnectionTimer=setTimeout(t,1e3):void(n.reconnectionAttempts++<o?(n.reconnectionDelay<r&&(n.reconnectionDelay*=2),n.connect(),n.publish("reconnecting",n.reconnectionDelay,n.reconnectionAttempts),n.reconnectionTimer=setTimeout(t,n.reconnectionDelay)):n.redoTransports?(n.publish("reconnect_failed"),e()):(n.on("connect_failed",t),n.options["try multiple transports"]=!0,n.transport=n.getTransport(),n.redoTransports=!0,n.connect())):void 0}this.reconnecting=!0,this.reconnectionAttempts=0,this.reconnectionDelay=this.options["reconnection delay"];var n=this,o=this.options["max reconnection attempts"],i=this.options["try multiple transports"],r=this.options["reconnection limit"];this.options["try multiple transports"]=!1,this.reconnectionTimer=setTimeout(t,this.reconnectionDelay),this.on("connect",t)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(e,t){function n(e,t){this.socket=e,this.name=t||"",this.flags={},this.json=new o(this,"json"),this.ackPackets=0,this.acks={}}function o(e,t){this.namespace=e,this.name=t}e.SocketNamespace=n,t.util.mixin(n,t.EventEmitter),n.prototype.$emit=t.EventEmitter.prototype.emit,n.prototype.of=function(){return this.socket.of.apply(this.socket,arguments)},n.prototype.packet=function(e){return e.endpoint=this.name,this.socket.packet(e),this.flags={},this},n.prototype.send=function(e,t){var n={type:this.flags.json?"json":"message",data:e};return"function"==typeof t&&(n.id=++this.ackPackets,n.ack=!0,this.acks[n.id]=t),this.packet(n)},n.prototype.emit=function(e){var t=Array.prototype.slice.call(arguments,1),n=t[t.length-1],o={type:"event",name:e};return"function"==typeof n&&(o.id=++this.ackPackets,o.ack="data",this.acks[o.id]=n,t=t.slice(0,t.length-1)),o.args=t,this.packet(o)},n.prototype.disconnect=function(){return""===this.name?this.socket.disconnect():(this.packet({type:"disconnect"}),this.$emit("disconnect")),this},n.prototype.onPacket=function(e){function n(){i.packet({type:"ack",args:t.util.toArray(arguments),ackId:e.id})}var o,i=this;switch(e.type){case"connect":this.$emit("connect");break;case"disconnect":""===this.name?this.socket.onDisconnect(e.reason||"booted"):this.$emit("disconnect",e.reason);break;case"message":case"json":o=["message",e.data],"data"==e.ack?o.push(n):e.ack&&this.packet({type:"ack",ackId:e.id}),this.$emit.apply(this,o);break;case"event":o=[e.name].concat(e.args),"data"==e.ack&&o.push(n),this.$emit.apply(this,o);break;case"ack":this.acks[e.ackId]&&(this.acks[e.ackId].apply(this,e.args),delete this.acks[e.ackId]);break;case"error":e.advice?this.socket.onError(e):"unauthorized"==e.reason?this.$emit("connect_failed",e.reason):this.$emit("error",e.reason)}},o.prototype.send=function(){this.namespace.flags[this.name]=!0,this.namespace.send.apply(this.namespace,arguments)},o.prototype.emit=function(){this.namespace.flags[this.name]=!0,this.namespace.emit.apply(this.namespace,arguments)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(e,t,n){function o(){t.Transport.apply(this,arguments)}e.websocket=o,t.util.inherit(o,t.Transport),o.prototype.name="websocket",o.prototype.open=function(){var e,o=t.util.query(this.socket.options.query),i=this;return e||(e=n.MozWebSocket||n.WebSocket),this.websocket=new e(this.prepareUrl()+o),this.websocket.onopen=function(){i.onOpen(),i.socket.setBuffer(!1)},this.websocket.onmessage=function(e){i.onData(e.data)},this.websocket.onclose=function(){i.onClose(),i.socket.setBuffer(!0)},this.websocket.onerror=function(e){i.onError(e)},this},o.prototype.send=function(e){return this.websocket.send(e),this},o.prototype.payload=function(e){for(var t=0,n=e.length;n>t;t++)this.packet(e[t]);return this},o.prototype.close=function(){return this.websocket.close(),this},o.prototype.onError=function(e){this.socket.onError(e)},o.prototype.scheme=function(){return this.socket.options.secure?"wss":"ws"},o.check=function(){return"WebSocket"in n&&!("__addTask"in WebSocket)||"MozWebSocket"in n},o.xdomainCheck=function(){return!0},t.transports.push("websocket")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(e,t){function n(){t.Transport.websocket.apply(this,arguments)}e.flashsocket=n,t.util.inherit(n,t.Transport.websocket),n.prototype.name="flashsocket",n.prototype.open=function(){var e=this,n=arguments;return WebSocket.__addTask(function(){t.Transport.websocket.prototype.open.apply(e,n)}),this},n.prototype.send=function(){var e=this,n=arguments;return WebSocket.__addTask(function(){t.Transport.websocket.prototype.send.apply(e,n)}),this},n.prototype.close=function(){return WebSocket.__tasks.length=0,t.Transport.websocket.prototype.close.call(this),this},n.prototype.ready=function(e,o){function i(){var t=e.options,i=t["flash policy port"],s=["http"+(t.secure?"s":"")+":/",t.host+":"+t.port,t.resource,"static/flashsocket","WebSocketMain"+(e.isXDomain()?"Insecure":"")+".swf"];n.loaded||("undefined"==typeof WEB_SOCKET_SWF_LOCATION&&(WEB_SOCKET_SWF_LOCATION=s.join("/")),843!==i&&WebSocket.loadFlashPolicyFile("xmlsocket://"+t.host+":"+i),WebSocket.__initialize(),n.loaded=!0),o.call(r)}var r=this;return document.body?i():void t.util.load(i)},n.check=function(){return"undefined"!=typeof WebSocket&&"__initialize"in WebSocket&&swfobject?swfobject.getFlashPlayerVersion().major>=10:!1},n.xdomainCheck=function(){return!0},"undefined"!=typeof window&&(WEB_SOCKET_DISABLE_AUTO_INITIALIZATION=!0),t.transports.push("flashsocket")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports),"undefined"!=typeof window)var swfobject=function(){function e(){var e,t,n;if(!H){try{e=B.getElementsByTagName("body")[0].appendChild(m("span")),e.parentNode.removeChild(e)}catch(o){return}for(H=!0,t=R.length,n=0;t>n;n++)R[n]()}}function t(e){H?e():R[R.length]=e}function n(e){if(typeof D.addEventListener!=W)D.addEventListener("load",e,!1);else if(typeof B.addEventListener!=W)B.addEventListener("load",e,!1);else if(typeof D.attachEvent!=W)v(D,"onload",e);else if("function"==typeof D.onload){var t=D.onload;D.onload=function(){t(),e()}}else D.onload=e}function o(){P?i():r()}function i(){var e,t,n=B.getElementsByTagName("body")[0],o=m(O);o.setAttribute("type",N),e=n.appendChild(o),e?(t=0,function(){if(typeof e.GetVariable!=W){var i=e.GetVariable("$version");i&&(i=i.split(" ")[1].split(","),G.pv=[parseInt(i[0],10),parseInt(i[1],10),parseInt(i[2],10)])}else if(10>t)return t++,void setTimeout(arguments.callee,10);n.removeChild(o),e=null,r()}()):r()}function r(){var e,t,n,o,i,r=F.length;if(r>0)for(e=0;r>e;e++){var u=F[e].id,l=F[e].callbackFn,h={success:!1,id:u};if(G.pv[0]>0){if(t=y(u))if(!k(F[e].swfVersion)||G.wk&&G.wk<312)if(F[e].expressInstall&&a()){n={},n.data=F[e].expressInstall,n.width=t.getAttribute("width")||"0",n.height=t.getAttribute("height")||"0",t.getAttribute("class")&&(n.styleclass=t.getAttribute("class")),t.getAttribute("align")&&(n.align=t.getAttribute("align"));var f={},d=t.getElementsByTagName("param"),m=d.length;for(o=0;m>o;o++)"movie"!=d[o].getAttribute("name").toLowerCase()&&(f[d[o].getAttribute("name")]=d[o].getAttribute("value"));c(n,f,u,l)}else p(t),l&&l(h);else g(u,!0),l&&(h.success=!0,h.ref=s(u),l(h))}else g(u,!0),l&&(i=s(u),i&&typeof i.SetVariable!=W&&(h.success=!0,h.ref=i),l(h))}}function s(e){var t,n=null,o=y(e);return o&&"OBJECT"==o.nodeName&&(typeof o.SetVariable!=W?n=o:(t=o.getElementsByTagName(O)[0],t&&(n=t))),n}function a(){return!M&&k("6.0.65")&&(G.win||G.mac)&&!(G.wk&&G.wk<312)}function c(e,t,n,o){var i,r,s,a;M=!0,_=o||null,E={success:!1,id:n},i=y(n),i&&("OBJECT"==i.nodeName?(S=u(i),T=null):(S=i,T=n),e.id=j,(typeof e.width==W||!/%$/.test(e.width)&&parseInt(e.width,10)<310)&&(e.width="310"),(typeof e.height==W||!/%$/.test(e.height)&&parseInt(e.height,10)<137)&&(e.height="137"),B.title=B.title.slice(0,47)+" - Flash Player Installation",r=G.ie&&G.win?"ActiveX":"PlugIn",s="MMredirectURL="+D.location.toString().replace(/&/g,"%26")+"&MMplayerType="+r+"&MMdoctitle="+B.title,typeof t.flashvars!=W?t.flashvars+="&"+s:t.flashvars=s,G.ie&&G.win&&4!=i.readyState&&(a=m("div"),n+="SWFObjectNew",a.setAttribute("id",n),i.parentNode.insertBefore(a,i),i.style.display="none",function(){4==i.readyState?i.parentNode.removeChild(i):setTimeout(arguments.callee,10)}()),l(e,t,n))}function p(e){if(G.ie&&G.win&&4!=e.readyState){var t=m("div");e.parentNode.insertBefore(t,e),t.parentNode.replaceChild(u(e),t),e.style.display="none",function(){4==e.readyState?e.parentNode.removeChild(e):setTimeout(arguments.callee,10)}()}else e.parentNode.replaceChild(u(e),e)}function u(e){var t,n,o,i,r=m("div");if(G.win&&G.ie)r.innerHTML=e.innerHTML;else if(t=e.getElementsByTagName(O)[0],t&&(n=t.childNodes))for(o=n.length,i=0;o>i;i++)1==n[i].nodeType&&"PARAM"==n[i].nodeName||8==n[i].nodeType||r.appendChild(n[i].cloneNode(!0));return r}function l(e,t,n){var o,i,r,s,a,c,p,u,l=y(n);if(G.wk&&G.wk<312)return o;if(l)if(typeof e.id==W&&(e.id=n),G.ie&&G.win){i="";for(r in e)e[r]!=Object.prototype[r]&&("data"==r.toLowerCase()?t.movie=e[r]:"styleclass"==r.toLowerCase()?i+=' class="'+e[r]+'"':"classid"!=r.toLowerCase()&&(i+=" "+r+'="'+e[r]+'"'));s="";for(a in t)t[a]!=Object.prototype[a]&&(s+='<param name="'+a+'" value="'+t[a]+'" />');l.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+i+">"+s+"</object>",q[q.length]=e.id,o=y(e.id)}else{c=m(O),c.setAttribute("type",N);for(p in e)e[p]!=Object.prototype[p]&&("styleclass"==p.toLowerCase()?c.setAttribute("class",e[p]):"classid"!=p.toLowerCase()&&c.setAttribute(p,e[p]));for(u in t)t[u]!=Object.prototype[u]&&"movie"!=u.toLowerCase()&&h(c,u,t[u]);l.parentNode.replaceChild(c,l),o=c}return o}function h(e,t,n){var o=m("param");o.setAttribute("name",t),o.setAttribute("value",n),e.appendChild(o)}function f(e){var t=y(e);t&&"OBJECT"==t.nodeName&&(G.ie&&G.win?(t.style.display="none",function(){4==t.readyState?d(e):setTimeout(arguments.callee,10)}()):t.parentNode.removeChild(t))}function d(e){var t,n=y(e);if(n){for(t in n)"function"==typeof n[t]&&(n[t]=null);n.parentNode.removeChild(n)}}function y(e){var t=null;try{t=B.getElementById(e)}catch(n){}return t}function m(e){return B.createElement(e)}function v(e,t,n){e.attachEvent(t,n),X[X.length]=[e,t,n]}function k(e){var t=G.pv,n=e.split(".");return n[0]=parseInt(n[0],10),n[1]=parseInt(n[1],10)||0,n[2]=parseInt(n[2],10)||0,t[0]>n[0]||t[0]==n[0]&&t[1]>n[1]||t[0]==n[0]&&t[1]==n[1]&&t[2]>=n[2]}function b(e,t,n,o){var i,r,s;G.ie&&G.mac||(i=B.getElementsByTagName("head")[0],i&&(r=n&&"string"==typeof n?n:"screen",o&&(C=null,x=null),C&&x==r||(s=m("style"),s.setAttribute("type","text/css"),s.setAttribute("media",r),C=i.appendChild(s),G.ie&&G.win&&typeof B.styleSheets!=W&&B.styleSheets.length>0&&(C=B.styleSheets[B.styleSheets.length-1]),x=r),G.ie&&G.win?C&&typeof C.addRule==O&&C.addRule(e,t):C&&typeof B.createTextNode!=W&&C.appendChild(B.createTextNode(e+" {"+t+"}"))))}function g(e,t){if(U){var n=t?"visible":"hidden";H&&y(e)?y(e).style.visibility=n:b("#"+e,"visibility:"+n)}}function w(e){var t=/[\\\"<>\.;]/,n=null!=t.exec(e);return n&&typeof encodeURIComponent!=W?encodeURIComponent(e):e}var S,T,_,E,C,x,W="undefined",O="object",A="Shockwave Flash",I="ShockwaveFlash.ShockwaveFlash",N="application/x-shockwave-flash",j="SWFObjectExprInst",L="onreadystatechange",D=window,B=document,$=navigator,P=!1,R=[o],F=[],q=[],X=[],H=!1,M=!1,U=!0,G=function(){var e,t=typeof B.getElementById!=W&&typeof B.getElementsByTagName!=W&&typeof B.createElement!=W,n=$.userAgent.toLowerCase(),o=$.platform.toLowerCase(),i=/win/.test(o?o:n),r=/mac/.test(o?o:n),s=/webkit/.test(n)?parseFloat(n.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,a=!1,c=[0,0,0],p=null;if(typeof $.plugins!=W&&typeof $.plugins[A]==O)p=$.plugins[A].description,!p||typeof $.mimeTypes!=W&&$.mimeTypes[N]&&!$.mimeTypes[N].enabledPlugin||(P=!0,a=!1,p=p.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),c[0]=parseInt(p.replace(/^(.*)\..*$/,"$1"),10),c[1]=parseInt(p.replace(/^.*\.(.*)\s.*$/,"$1"),10),c[2]=/[a-zA-Z]/.test(p)?parseInt(p.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof D.ActiveXObject!=W)try{e=new ActiveXObject(I),e&&(p=e.GetVariable("$version"),p&&(a=!0,p=p.split(" ")[1].split(","),c=[parseInt(p[0],10),parseInt(p[1],10),parseInt(p[2],10)]))}catch(u){}return{w3:t,pv:c,wk:s,ie:a,win:i,mac:r}}();return!function(){G.w3&&((typeof B.readyState!=W&&"complete"==B.readyState||typeof B.readyState==W&&(B.getElementsByTagName("body")[0]||B.body))&&e(),H||(typeof B.addEventListener!=W&&B.addEventListener("DOMContentLoaded",e,!1),G.ie&&G.win&&(B.attachEvent(L,function(){"complete"==B.readyState&&(B.detachEvent(L,arguments.callee),e())}),D==top&&function(){if(!H){try{B.documentElement.doScroll("left")}catch(t){return void setTimeout(arguments.callee,0)}e()}}()),G.wk&&function(){return H?void 0:/loaded|complete/.test(B.readyState)?void e():void setTimeout(arguments.callee,0)}(),n(e)))}(),function(){G.ie&&G.win&&window.attachEvent("onunload",function(){for(var e,t,n,o,i=X.length,r=0;i>r;r++)X[r][0].detachEvent(X[r][1],X[r][2]);for(e=q.length,t=0;e>t;t++)f(q[t]);for(n in G)G[n]=null;G=null;for(o in swfobject)swfobject[o]=null;swfobject=null})}(),{registerObject:function(e,t,n,o){if(G.w3&&e&&t){var i={};i.id=e,i.swfVersion=t,i.expressInstall=n,i.callbackFn=o,F[F.length]=i,g(e,!1)}else o&&o({success:!1,id:e})},getObjectById:function(e){return G.w3?s(e):void 0},embedSWF:function(e,n,o,i,r,s,p,u,h,f){var d={success:!1,id:n};G.w3&&!(G.wk&&G.wk<312)&&e&&n&&o&&i&&r?(g(n,!1),t(function(){var t,y,m,v,b,w;if(o+="",i+="",t={},h&&typeof h===O)for(y in h)t[y]=h[y];if(t.data=e,t.width=o,t.height=i,m={},u&&typeof u===O)for(v in u)m[v]=u[v];if(p&&typeof p===O)for(b in p)typeof m.flashvars!=W?m.flashvars+="&"+b+"="+p[b]:m.flashvars=b+"="+p[b];if(k(r))w=l(t,m,n),t.id==n&&g(n,!0),d.success=!0,d.ref=w;else{if(s&&a())return t.data=s,void c(t,m,n,f);g(n,!0)}f&&f(d)})):f&&f(d)},switchOffAutoHideShow:function(){U=!1},ua:G,getFlashPlayerVersion:function(){return{major:G.pv[0],minor:G.pv[1],release:G.pv[2]}},hasFlashPlayerVersion:k,createSWF:function(e,t,n){return G.w3?l(e,t,n):void 0},showExpressInstall:function(e,t,n,o){G.w3&&a()&&c(e,t,n,o)},removeSWF:function(e){G.w3&&f(e)},createCSS:function(e,t,n,o){G.w3&&b(e,t,n,o)},addDomLoadEvent:t,addLoadEvent:n,getQueryParamValue:function(e){var t,n,o=B.location.search||B.location.hash;if(o){if(/\?/.test(o)&&(o=o.split("?")[1]),null==e)return w(o);for(t=o.split("&"),n=0;n<t.length;n++)if(t[n].substring(0,t[n].indexOf("="))==e)return w(t[n].substring(t[n].indexOf("=")+1))}return""},expressInstallCallback:function(){if(M){var e=y(j);e&&S&&(e.parentNode.replaceChild(S,e),T&&(g(T,!0),G.ie&&G.win&&(S.style.display="block")),_&&_(E)),M=!1}}}}();!function(){if("undefined"!=typeof window&&!window.WebSocket){var e=window.console;return e&&e.log&&e.error||(e={log:function(){},error:function(){}}),swfobject.hasFlashPlayerVersion("10.0.0")?("file:"==location.protocol&&e.error("WARNING: web-socket-js doesn't work in file:///... URL unless you set Flash Security Settings properly. Open the page via Web server i.e. http://..."),WebSocket=function(e,t,n,o,i){var r=this;r.__id=WebSocket.__nextId++,WebSocket.__instances[r.__id]=r,r.readyState=WebSocket.CONNECTING,r.bufferedAmount=0,r.__events={},t?"string"==typeof t&&(t=[t]):t=[],setTimeout(function(){WebSocket.__addTask(function(){WebSocket.__flash.create(r.__id,e,t,n||null,o||0,i||null)})},0)},WebSocket.prototype.send=function(e){if(this.readyState==WebSocket.CONNECTING)throw"INVALID_STATE_ERR: Web Socket connection has not been established";var t=WebSocket.__flash.send(this.__id,encodeURIComponent(e));return 0>t?!0:(this.bufferedAmount+=t,
!1)},WebSocket.prototype.close=function(){this.readyState!=WebSocket.CLOSED&&this.readyState!=WebSocket.CLOSING&&(this.readyState=WebSocket.CLOSING,WebSocket.__flash.close(this.__id))},WebSocket.prototype.addEventListener=function(e,t){e in this.__events||(this.__events[e]=[]),this.__events[e].push(t)},WebSocket.prototype.removeEventListener=function(e,t){var n,o;if(e in this.__events)for(n=this.__events[e],o=n.length-1;o>=0;--o)if(n[o]===t){n.splice(o,1);break}},WebSocket.prototype.dispatchEvent=function(e){for(var t,n=this.__events[e.type]||[],o=0;o<n.length;++o)n[o](e);t=this["on"+e.type],t&&t(e)},WebSocket.prototype.__handleEvent=function(e){var t,n;if("readyState"in e&&(this.readyState=e.readyState),"protocol"in e&&(this.protocol=e.protocol),"open"==e.type||"error"==e.type)t=this.__createSimpleEvent(e.type);else if("close"==e.type)t=this.__createSimpleEvent("close");else{if("message"!=e.type)throw"unknown event type: "+e.type;n=decodeURIComponent(e.message),t=this.__createMessageEvent("message",n)}this.dispatchEvent(t)},WebSocket.prototype.__createSimpleEvent=function(e){if(document.createEvent&&window.Event){var t=document.createEvent("Event");return t.initEvent(e,!1,!1),t}return{type:e,bubbles:!1,cancelable:!1}},WebSocket.prototype.__createMessageEvent=function(e,t){if(document.createEvent&&window.MessageEvent&&!window.opera){var n=document.createEvent("MessageEvent");return n.initMessageEvent("message",!1,!1,t,null,null,window,null),n}return{type:e,data:t,bubbles:!1,cancelable:!1}},WebSocket.CONNECTING=0,WebSocket.OPEN=1,WebSocket.CLOSING=2,WebSocket.CLOSED=3,WebSocket.__flash=null,WebSocket.__instances={},WebSocket.__tasks=[],WebSocket.__nextId=0,WebSocket.loadFlashPolicyFile=function(e){WebSocket.__addTask(function(){WebSocket.__flash.loadManualPolicyFile(e)})},WebSocket.__initialize=function(){var t,n;return WebSocket.__flash?void 0:(WebSocket.__swfLocation&&(window.WEB_SOCKET_SWF_LOCATION=WebSocket.__swfLocation),window.WEB_SOCKET_SWF_LOCATION?(t=document.createElement("div"),t.id="webSocketContainer",t.style.position="absolute",WebSocket.__isFlashLite()?(t.style.left="0px",t.style.top="0px"):(t.style.left="-100px",t.style.top="-100px"),n=document.createElement("div"),n.id="webSocketFlash",t.appendChild(n),document.body.appendChild(t),void swfobject.embedSWF(WEB_SOCKET_SWF_LOCATION,"webSocketFlash","1","1","10.0.0",null,null,{hasPriority:!0,swliveconnect:!0,allowScriptAccess:"always"},null,function(t){t.success||e.error("[WebSocket] swfobject.embedSWF failed")})):void e.error("[WebSocket] set WEB_SOCKET_SWF_LOCATION to location of WebSocketMain.swf"))},WebSocket.__onFlashInitialized=function(){setTimeout(function(){WebSocket.__flash=document.getElementById("webSocketFlash"),WebSocket.__flash.setCallerUrl(location.href),WebSocket.__flash.setDebug(!!window.WEB_SOCKET_DEBUG);for(var e=0;e<WebSocket.__tasks.length;++e)WebSocket.__tasks[e]();WebSocket.__tasks=[]},0)},WebSocket.__onFlashEvent=function(){return setTimeout(function(){var t,n;try{for(t=WebSocket.__flash.receiveEvents(),n=0;n<t.length;++n)WebSocket.__instances[t[n].webSocketId].__handleEvent(t[n])}catch(o){e.error(o)}},0),!0},WebSocket.__log=function(t){e.log(decodeURIComponent(t))},WebSocket.__error=function(t){e.error(decodeURIComponent(t))},WebSocket.__addTask=function(e){WebSocket.__flash?e():WebSocket.__tasks.push(e)},WebSocket.__isFlashLite=function(){if(!window.navigator||!window.navigator.mimeTypes)return!1;var e=window.navigator.mimeTypes["application/x-shockwave-flash"];return!!(e&&e.enabledPlugin&&e.enabledPlugin.filename&&e.enabledPlugin.filename.match(/flashlite/i))},void(window.WEB_SOCKET_DISABLE_AUTO_INITIALIZATION||(window.addEventListener?window.addEventListener("load",function(){WebSocket.__initialize()},!1):window.attachEvent("onload",function(){WebSocket.__initialize()})))):void e.error("Flash Player >= 10.0.0 is required.")}}(),function(e,t,n){function o(e){e&&(t.Transport.apply(this,arguments),this.sendBuffer=[])}function i(){}e.XHR=o,t.util.inherit(o,t.Transport),o.prototype.open=function(){return this.socket.setBuffer(!1),this.onOpen(),this.get(),this.setCloseTimeout(),this},o.prototype.payload=function(e){for(var n=[],o=0,i=e.length;i>o;o++)n.push(t.parser.encodePacket(e[o]));this.send(t.parser.encodePayload(n))},o.prototype.send=function(e){return this.post(e),this},o.prototype.post=function(e){function t(){4==this.readyState&&(this.onreadystatechange=i,r.posting=!1,200==this.status?r.socket.setBuffer(!1):r.onClose())}function o(){this.onload=i,r.socket.setBuffer(!1)}var r=this;this.socket.setBuffer(!0),this.sendXHR=this.request("POST"),n.XDomainRequest&&this.sendXHR instanceof XDomainRequest?this.sendXHR.onload=this.sendXHR.onerror=o:this.sendXHR.onreadystatechange=t,this.sendXHR.send(e)},o.prototype.close=function(){return this.onClose(),this},o.prototype.request=function(e){var n=t.util.request(this.socket.isXDomain()),o=t.util.query(this.socket.options.query,"t="+ +new Date);if(n.open(e||"GET",this.prepareUrl()+o,!0),"POST"==e)try{n.setRequestHeader?n.setRequestHeader("Content-type","text/plain;charset=UTF-8"):n.contentType="text/plain"}catch(i){}return n},o.prototype.scheme=function(){return this.socket.options.secure?"https":"http"},o.check=function(e,n){try{if(t.util.request(n))return!0}catch(o){}return!1},o.xdomainCheck=function(){return o.check(null,!0)}}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(e,t){function n(){t.Transport.XHR.apply(this,arguments)}e.htmlfile=n,t.util.inherit(n,t.Transport.XHR),n.prototype.name="htmlfile",n.prototype.get=function(){var e,n,o;this.doc=new ActiveXObject("htmlfile"),this.doc.open(),this.doc.write("<html></html>"),this.doc.close(),this.doc.parentWindow.s=this,e=this.doc.createElement("div"),e.className="socketio",this.doc.body.appendChild(e),this.iframe=this.doc.createElement("iframe"),e.appendChild(this.iframe),n=this,o=t.util.query(this.socket.options.query,"t="+ +new Date),this.iframe.src=this.prepareUrl()+o,t.util.on(window,"unload",function(){n.destroy()})},n.prototype._=function(e,t){this.onData(e);try{var n=t.getElementsByTagName("script")[0];n.parentNode.removeChild(n)}catch(o){}},n.prototype.destroy=function(){if(this.iframe){try{this.iframe.src="about:blank"}catch(e){}this.doc=null,this.iframe.parentNode.removeChild(this.iframe),this.iframe=null,CollectGarbage()}},n.prototype.close=function(){return this.destroy(),t.Transport.XHR.prototype.close.call(this)},n.check=function(){if("undefined"!=typeof window&&"ActiveXObject"in window)try{var e=new ActiveXObject("htmlfile");return e&&t.Transport.XHR.check()}catch(n){}return!1},n.xdomainCheck=function(){return!1},t.transports.push("htmlfile")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(e,t,n){function o(){t.Transport.XHR.apply(this,arguments)}function i(){}e["xhr-polling"]=o,t.util.inherit(o,t.Transport.XHR),t.util.merge(o,t.Transport.XHR),o.prototype.name="xhr-polling",o.prototype.open=function(){var e=this;return t.Transport.XHR.prototype.open.call(e),!1},o.prototype.get=function(){function e(){4==this.readyState&&(this.onreadystatechange=i,200==this.status?(r.onData(this.responseText),r.get()):r.onClose())}function t(){this.onload=i,this.onerror=i,r.onData(this.responseText),r.get()}function o(){r.onClose()}if(this.open){var r=this;this.xhr=this.request(),n.XDomainRequest&&this.xhr instanceof XDomainRequest?(this.xhr.onload=t,this.xhr.onerror=o):this.xhr.onreadystatechange=e,this.xhr.send(null)}},o.prototype.onClose=function(){if(t.Transport.XHR.prototype.onClose.call(this),this.xhr){this.xhr.onreadystatechange=this.xhr.onload=this.xhr.onerror=i;try{this.xhr.abort()}catch(e){}this.xhr=null}},o.prototype.ready=function(e,n){var o=this;t.util.defer(function(){n.call(o)})},t.transports.push("xhr-polling")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(e,t,n){function o(){t.Transport["xhr-polling"].apply(this,arguments),this.index=t.j.length;var e=this;t.j.push(function(t){e._(t)})}var i=n.document&&"MozAppearance"in n.document.documentElement.style;e["jsonp-polling"]=o,t.util.inherit(o,t.Transport["xhr-polling"]),o.prototype.name="jsonp-polling",o.prototype.post=function(e){function n(){o(),i.socket.setBuffer(!1)}function o(){i.iframe&&i.form.removeChild(i.iframe);try{s=document.createElement('<iframe name="'+i.iframeId+'">')}catch(e){s=document.createElement("iframe"),s.name=i.iframeId}s.id=i.iframeId,i.form.appendChild(s),i.iframe=s}var i=this,r=t.util.query(this.socket.options.query,"t="+ +new Date+"&i="+this.index);if(!this.form){var s,a=document.createElement("form"),c=document.createElement("textarea"),p=this.iframeId="socketio_iframe_"+this.index;a.className="socketio",a.style.position="absolute",a.style.top="-1000px",a.style.left="-1000px",a.target=p,a.method="POST",a.setAttribute("accept-charset","utf-8"),c.name="d",a.appendChild(c),document.body.appendChild(a),this.form=a,this.area=c}this.form.action=this.prepareUrl()+r,o(),this.area.value=t.JSON.stringify(e);try{this.form.submit()}catch(u){}this.iframe.attachEvent?s.onreadystatechange=function(){"complete"==i.iframe.readyState&&n()}:this.iframe.onload=n,this.socket.setBuffer(!0)},o.prototype.get=function(){var e,n=this,o=document.createElement("script"),r=t.util.query(this.socket.options.query,"t="+ +new Date+"&i="+this.index);this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),o.async=!0,o.src=this.prepareUrl()+r,o.onerror=function(){n.onClose()},e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(o,e),this.script=o,i&&setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)},100)},o.prototype._=function(e){return this.onData(e),this.open&&this.get(),this},o.prototype.ready=function(e,n){var o=this;return i?void t.util.load(function(){n.call(o)}):n.call(this)},o.check=function(){return"document"in n},o.xdomainCheck=function(){return!0},t.transports.push("jsonp-polling")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this);
!function(){function g(t){throw t}function aa(t){return function(){return this[t]}}function p(t){return function(){return t}}function ca(t,e){var n=t.split("."),i=ba;!(n[0]in i)&&i.execScript&&i.execScript("var "+n[0]);for(var r;n.length&&(r=n.shift());)!n.length&&s(e)?i[r]=e:i=i[r]?i[r]:i[r]={}}function da(){}function ea(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&"undefined"!=typeof t.splice&&"undefined"!=typeof t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||"undefined"!=typeof t.call&&"undefined"!=typeof t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&"undefined"==typeof t.call)return"object";return e}function s(t){return t!==j}function fa(t){var e=ea(t);return"array"==e||"object"==e&&"number"==typeof t.length}function t(t){return"string"==typeof t}function ga(t){return"number"==typeof t}function ha(t){var e=typeof t;return"object"==e&&t!=l||"function"==e}function ia(t,e,n){return t.call.apply(t.bind,arguments)}function ja(t,e,n){if(t||g(Error()),2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function u(t,e,n){return u=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ia:ja,u.apply(l,arguments)}function ka(t,e){function n(){}n.prototype=e.prototype,t.Jd=e.prototype,t.prototype=new n}function la(a){if(a=String(a),/^\s*$/.test(a)?0:/^[\],:{}\s\u2028\u2029]*$/.test(a.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r\u2028\u2029\x00-\x08\x10-\x1f\x80-\x9f]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:[\s\u2028\u2029]*\[)+/g,"")))try{return eval("("+a+")")}catch(b){}g(Error("Invalid JSON string: "+a))}function ma(){this.Xb=j}function na(t,e,n){switch(typeof e){case"string":oa(e,n);break;case"number":n.push(isFinite(e)&&!isNaN(e)?e:"null");break;case"boolean":n.push(e);break;case"undefined":n.push("null");break;case"object":if(e==l){n.push("null");break}if("array"==ea(e)){var i=e.length;n.push("[");for(var r="",o=0;i>o;o++)n.push(r),r=e[o],na(t,t.Xb?t.Xb.call(e,String(o),r):r,n),r=",";n.push("]");break}n.push("{"),i="";for(o in e)Object.prototype.hasOwnProperty.call(e,o)&&(r=e[o],"function"!=typeof r&&(n.push(i),oa(o,n),n.push(":"),na(t,t.Xb?t.Xb.call(e,o,r):r,n),i=","));n.push("}");break;case"function":break;default:g(Error("Unknown type: "+typeof e))}}function oa(t,e){e.push('"',t.replace(qa,function(t){if(t in pa)return pa[t];var e=t.charCodeAt(0),n="\\u";return 16>e?n+="000":256>e?n+="00":4096>e&&(n+="0"),pa[t]=n+e.toString(16)}),'"')}function y(t){if("undefined"!=typeof JSON&&s(JSON.stringify))t=JSON.stringify(t);else{var e=[];na(new ma,t,e),t=e.join("")}return t}function ra(t){for(var e=[],n=0,i=0;i<t.length;i++){var r=t.charCodeAt(i);r>=55296&&56319>=r&&(r-=55296,i++,z(i<t.length,"Surrogate pair missing trail surrogate."),r=65536+(r<<10)+(t.charCodeAt(i)-56320)),128>r?e[n++]=r:(2048>r?e[n++]=r>>6|192:(65536>r?e[n++]=r>>12|224:(e[n++]=r>>18|240,e[n++]=r>>12&63|128),e[n++]=r>>6&63|128),e[n++]=63&r|128)}return e}function A(t,e,n,i){var r;e>i?r="at least "+e:i>n&&(r=0===n?"none":"no more than "+n),r&&g(Error(t+" failed: Was called with "+i+(1===i?" argument.":" arguments.")+" Expects "+r+"."))}function B(t,e,n){var i="";switch(e){case 1:i=n?"first":"First";break;case 2:i=n?"second":"Second";break;case 3:i=n?"third":"Third";break;case 4:i=n?"fourth":"Fourth";break;default:sa.assert(o,"errorPrefix_ called with argumentNumber > 4.  Need to update it?")}return t+" failed: "+(i+" argument ")}function C(t,e,n,i){(!i||s(n))&&"function"!=ea(n)&&g(Error(B(t,e,i)+"must be a valid function."))}function ta(t,e,n){s(n)&&(!ha(n)||n===l)&&g(Error(B(t,e,k)+"must be a valid context object."))}function D(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function ua(t,e){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0}function ya(e){return t(e)&&0!==e.length&&!wa.test(e)}function za(t,e,n){(!n||s(e))&&Aa(B(t,1,n),e)}function Aa(e,n,i,r){if(i||(i=0),r||(r=[]),s(n)||g(Error(e+"contains undefined"+Ba(r))),"function"==ea(n)&&g(Error(e+"contains a function"+Ba(r))),Ca(n)&&g(Error(e+"contains "+n.toString()+Ba(r))),i>1e3&&g(new TypeError(e+"contains a cyclic object value ("+r.slice(0,100).join(".")+"...)")),t(n)&&n.length>10485760/3&&10485760<va.Kd.Id(n).length&&g(Error(e+"contains a string greater than 10485760 utf8 bytes"+Ba(r)+" ('"+n.substring(0,50)+"...')")),ha(n))for(var o in n)D(n,o)&&(".priority"!==o&&".value"!==o&&!ya(o)&&g(Error(e+"contains an invalid key ("+o+")"+Ba(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')),r.push(o),Aa(e,n[o],i+1,r),r.pop())}function Ba(t){return 0==t.length?"":" in property "+t.join(".")}function Da(t,e){ha(e)||g(Error(B(t,1,o)+" must be an object containing the children to replace.")),za(t,e,o)}function Ea(e,n,i,r){(!r||s(i))&&i!==l&&!ga(i)&&!t(i)&&g(Error(B(e,n,r)+"must be a valid firebase priority (null or a string.)"))}function Fa(t,e,n){if(!n||s(e))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:g(Error(B(t,1,n)+'must be a valid event type: "value", "child_added", "child_removed", "child_changed", or "child_moved".'))}}function Ga(t,e){s(e)&&!ya(e)&&g(Error(B(t,2,k)+'must be a valid firebase key (non-empty string, not containing ".", "#", "$", "/", "[", or "]").'))}function Ha(e,n){(!t(n)||0===n.length||xa.test(n))&&g(Error(B(e,1,o)+'must be a non-empty string and can\'t contain ".", "#", "$", "[", or "]".'))}function E(t,e){".info"===F(e)&&g(Error(t+" failed: Can't modify data under /.info/"))}function G(t,e,n,i,r,o,a){this.o=t,this.path=e,this.ta=n,this.Z=i,this.la=r,this.ra=o,this.Pa=a,s(this.Z)&&s(this.ra)&&s(this.ta)&&g("Query: Can't combine startAt(), endAt(), and limit().")}function Ja(t){var e={};return s(t.Z)&&(e.sp=t.Z),s(t.la)&&(e.sn=t.la),s(t.ra)&&(e.ep=t.ra),s(t.Pa)&&(e.en=t.Pa),s(t.ta)&&(e.l=t.ta),s(t.Z)&&s(t.la)&&t.Z===l&&t.la===l&&(e.vf="l"),e}function Ia(t,e,n){var i={};return e&&n?(i.cancel=e,C(t,3,i.cancel,k),i.W=n,ta(t,4,i.W)):e&&("object"==typeof e&&e!==l?i.W=e:"function"==typeof e?i.cancel=e:g(Error(B(t,3,k)+"must either be a cancel callback or a context object."))),i}function I(t){if(t instanceof I)return t;if(1==arguments.length){this.m=t.split("/");for(var e=0,n=0;n<this.m.length;n++)0<this.m[n].length&&(this.m[e]=this.m[n],e++);this.m.length=e,this.X=0}else this.m=arguments[0],this.X=arguments[1]}function F(t){return t.X>=t.m.length?l:t.m[t.X]}function La(t){var e=t.X;return e<t.m.length&&e++,new I(t.m,e)}function Ma(t){return t.X<t.m.length?t.m[t.m.length-1]:l}function Na(t,e){var n=F(t);return n===l?e:n===F(e)?Na(La(t),La(e)):void g("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function Oa(){this.children={},this.hc=0,this.value=l}function Ra(t,e,n){this.ua=t?t:"",this.ob=e?e:l,this.u=n?n:new Oa}function J(t,e){for(var n,i=e instanceof I?e:new I(e),r=t;(n=F(i))!==l;)r=new Ra(n,r,ua(r.u.children,n)||new Oa),i=La(i);return r}function M(t,e){z("undefined"!=typeof e),t.u.value=e,Sa(t)}function Ta(t,e,n,i){n&&!i&&e(t),t.B(function(t){Ta(t,e,k,i)}),n&&i&&e(t)}function Ua(t,e,n){for(t=n?t:t.parent();t!==l;){if(e(t))return k;t=t.parent()}return o}function Sa(t){if(t.ob!==l){var e=t.ob,n=t.ua,i=t.f(),r=D(e.u.children,n);i&&r?(delete e.u.children[n],e.u.hc--,Sa(e)):!i&&!r&&(e.u.children[n]=t.u,e.u.hc++,Sa(e))}}function Va(t,e){this.Ma=t?t:Wa,this.Y=e?e:Xa}function Wa(t,e){return e>t?-1:t>e?1:0}function Ya(t,e){for(var n,i=t.Y,r=l;!i.f();){if(n=t.Ma(e,i.key),0===n){if(i.left.f())return r?r.key:l;for(i=i.left;!i.right.f();)i=i.right;return i.key}0>n?i=i.left:n>0&&(r=i,i=i.right)}g(Error("Attempted to find predecessor key for a nonexistent key.  What gives?"))}function Za(t,e){for(this.Wc=e,this.Gb=[];!t.f();)this.Gb.push(t),t=t.left}function $a(t){if(0===t.Gb.length)return l;var e,n=t.Gb.pop();for(e=t.Wc?t.Wc(n.key,n.value):{key:n.key,value:n.value},n=n.right;!n.f();)t.Gb.push(n),n=n.left;return e}function ab(t,e,n,i,r){this.key=t,this.value=e,this.color=n!=l?n:k,this.left=i!=l?i:Xa,this.right=r!=l?r:Xa}function bb(t){return t.left.f()?t:bb(t.left)}function db(t){return t.left.f()?Xa:(!t.left.H()&&!t.left.left.H()&&(t=eb(t)),t=t.copy(l,l,l,db(t.left),l),cb(t))}function cb(t){return t.right.H()&&!t.left.H()&&(t=ib(t)),t.left.H()&&t.left.left.H()&&(t=gb(t)),t.left.H()&&t.right.H()&&(t=hb(t)),t}function eb(t){return t=hb(t),t.right.left.H()&&(t=t.copy(l,l,l,l,gb(t.right)),t=ib(t),t=hb(t)),t}function ib(t){var e;return e=t.copy(l,l,k,l,t.right.left),t.right.copy(l,l,t.color,e,l)}function gb(t){var e;return e=t.copy(l,l,k,t.left.right,l),t.left.copy(l,l,t.color,l,e)}function hb(t){var e,n;return e=t.left.copy(l,l,!t.left.color,l,l),n=t.right.copy(l,l,!t.right.color,l,l),t.copy(l,l,!t.color,e,n)}function jb(){}function nb(){}function ob(){this.z=[],this.gc=[],this.hd=[],this.Ob=[],this.Ob[0]=128;for(var t=1;64>t;++t)this.Ob[t]=0;this.reset()}function pb(t,e){var n;n||(n=0);for(var i=t.hd,r=n;n+64>r;r+=4)i[r/4]=e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3];for(r=16;80>r;r++){var o=i[r-3]^i[r-8]^i[r-14]^i[r-16];i[r]=4294967295&(o<<1|o>>>31)}n=t.z[0];for(var a,s=t.z[1],c=t.z[2],h=t.z[3],u=t.z[4],r=0;80>r;r++)40>r?20>r?(o=h^s&(c^h),a=1518500249):(o=s^c^h,a=1859775393):60>r?(o=s&c|h&(s|c),a=2400959708):(o=s^c^h,a=3395469782),o=(n<<5|n>>>27)+o+u+a+i[r]&4294967295,u=h,h=c,c=4294967295&(s<<30|s>>>2),s=n,n=o;t.z[0]=t.z[0]+n&4294967295,t.z[1]=t.z[1]+s&4294967295,t.z[2]=t.z[2]+c&4294967295,t.z[3]=t.z[3]+h&4294967295,t.z[4]=t.z[4]+u&4294967295}function qb(){this.La={},this.length=0}function sb(t,e,n,i){this.host=t,this.Yb=e,this.jb=n,this.aa=i||N.getItem(t)||this.host}function tb(t,e){e!==t.aa&&(t.aa=e,"s-"===t.aa.substr(0,2)&&N.setItem(t.host,t.aa))}function yb(){return ba.navigator?ba.navigator.userAgent:l}function Ib(t,e){if(fa(t)||g(Error("encodeByteArray takes an array as a parameter")),!Gb){Gb={},Hb={};for(var n=0;65>n;n++)Gb[n]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(n),Hb[n]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(n)}for(var n=e?Hb:Gb,i=[],r=0;r<t.length;r+=3){var o=t[r],a=r+1<t.length,s=a?t[r+1]:0,c=r+2<t.length,h=c?t[r+2]:0,u=o>>2,o=(3&o)<<4|s>>4,s=(15&s)<<2|h>>6,h=63&h;c||(h=64,a||(s=64)),i.push(n[u],n[o],n[s],n[h])}return i.join("")}function z(t,e){t||g(Error("Firebase INTERNAL ASSERT FAILED:"+e))}function Lb(t){var e=ra(t),t=new ob;t.update(e);var e=[],n=8*t.Ac;56>t.eb?t.update(t.Ob,56-t.eb):t.update(t.Ob,64-(t.eb-56));for(var i=63;i>=56;i--)t.gc[i]=255&n,n/=256;for(pb(t,t.gc),i=n=0;5>i;i++)for(var r=24;r>=0;r-=8)e[n++]=t.z[i]>>r&255;return Ib(e)}function Mb(){for(var t="",e=0;e<arguments.length;e++)t=fa(arguments[e])?t+Mb.apply(l,arguments[e]):"object"==typeof arguments[e]?t+y(arguments[e]):t+arguments[e],t+=" ";return t}function Pb(){if(Ob===k&&(Ob=o,Nb===l&&"true"===N.getItem("logging_enabled")&&Qb(k)),Nb){var t=Mb.apply(l,arguments);Nb(t)}}function Sb(t){return function(){Pb(t,arguments)}}function Tb(){if("undefined"!=typeof console){var t="FIREBASE INTERNAL ERROR: "+Mb.apply(l,arguments);"undefined"!=typeof console.error?console.error(t):console.log(t)}}function Ub(){var t=Mb.apply(l,arguments);g(Error("FIREBASE FATAL ERROR: "+t))}function Vb(){if("undefined"!=typeof console){var t="FIREBASE WARNING: "+Mb.apply(l,arguments);"undefined"!=typeof console.warn?console.warn(t):console.log(t)}}function Ca(t){return ga(t)&&(t!=t||t==Number.POSITIVE_INFINITY||t==Number.NEGATIVE_INFINITY)}function Wb(t,e){return t!==e?t===l?-1:e===l?1:typeof t!=typeof e?"number"==typeof t?-1:1:t>e?1:-1:0}function Xb(t,e){return e&&t in e?e[t]:void g(Error("Missing required key ("+t+") in object: "+y(e)))}function Ka(t){if("object"!=typeof t||t===l)return y(t);var e,n=[];for(e in t)n.push(e);n.sort(),e="{";for(var i=0;i<n.length;i++)0!==i&&(e+=","),e+=y(n[i]),e+=":",e+=Ka(t[n[i]]);return e+"}"}function Zb(t,e){if(t.length<=e)return[t];for(var n=[],i=0;i<t.length;i+=e)i+e>t?n.push(t.substring(i,t.length)):n.push(t.substring(i,i+e));return n}function $b(t){z(!Ca(t));var e,n,i,r;for(0===t?(i=n=0,e=-(1/0)===1/t?1:0):(e=0>t,t=Math.abs(t),t>=Math.pow(2,-1022)?(i=Math.min(Math.floor(Math.log(t)/Math.LN2),1023),n=i+1023,i=Math.round(t*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,i=Math.round(t/Math.pow(2,-1074)))),r=[],t=52;t;t-=1)r.push(i%2?1:0),i=Math.floor(i/2);for(t=11;t;t-=1)r.push(n%2?1:0),n=Math.floor(n/2);for(r.push(e?1:0),r.reverse(),e=r.join(""),n="",t=0;64>t;t+=8)i=parseInt(e.substr(t,8),2).toString(16),1===i.length&&(i="0"+i),n+=i;return n.toLowerCase()}function ac(t,e){this.oa=t,z(this.oa!==l,"LeafNode shouldn't be created with null value."),this.Ua="undefined"!=typeof e?e:l}function P(t,e){this.R=t||new Va,this.Ua="undefined"!=typeof e?e:l}function cc(t,e,n){P.call(this,t,n),e===l&&(e=new Va(ec),t.sa(function(t,n){e=e.ia({name:t,wa:n.k()},n)})),this.ka=e}function Q(t,e){if("object"!=typeof t)return new ac(t,e);if(t===l)return O;var n=l;if(".priority"in t?n=t[".priority"]:"undefined"!=typeof e&&(n=e),z(n===l||"string"==typeof n||"number"==typeof n),".value"in t&&t[".value"]!==l)return new ac(t[".value"],n);var i,n=new P(new Va,n);for(i in t)if(D(t,i)&&"."!==i.substring(0,1)){var r=Q(t[i]);!r.J()&&r.f()||(n=n.D(i,r))}return n}function ec(t,e){return Wb(t.wa,e.wa)||(t.name!==e.name?t.name<e.name?-1:1:0)}function bc(t){return"number"==typeof t?"number:"+$b(t):"string:"+t}function R(t,e){this.u=t,this.Vb=e}function fc(t){this.sc=t,this.Qb=[],this.Oa=0,this.ic=-1,this.Ga=l}function S(t,e){for(var n in t)e.call(j,t[n],n,t)}function gc(t){var e,n={};for(e in t)n[e]=t[e];return n}function hc(){this.$a={}}function ic(t,e,n){s(n)||(n=1),D(t.$a,e)||(t.$a[e]=0),t.$a[e]+=n}function jc(t){this.jd=t,this.Fb=l}function kc(t,e){this.ad={},this.$b=new jc(t),this.n=e,setTimeout(u(this.Uc,this),10+6e4*Math.random())}function nc(t){return t=t.toString(),lc[t]||(lc[t]=new hc),lc[t]}function pc(t,e,n){this.jc=t,this.e=Sb(this.jc),this.frames=this.gb=l,this.zc=0,this.$=nc(e),this.Na=(e.Yb?"wss://":"ws://")+e.aa+"/.ws?v=5",e.host!==e.aa&&(this.Na=this.Na+"&ns="+e.jb),n&&(this.Na=this.Na+"&s="+n)}function sc(t,e){if(t.frames.push(e),t.frames.length==t.zc){var n=t.frames.join("");t.frames=l,n="undefined"!=typeof JSON&&s(JSON.parse)?JSON.parse(n):la(n),t.Mb(n)}}function rc(t){clearTimeout(t.gb),t.gb=setInterval(function(){t.U.send("0"),rc(t)},45e3)}function tc(){this.set={}}function wc(t,e,n){this.jc=t,this.e=Sb(t),this.Hd=e,this.$=nc(e),this.Zb=n,this.ab=o,this.Ab=function(t){e.host!==e.aa&&(t.ns=e.jb);var n,i=[];for(n in t)t.hasOwnProperty(n)&&i.push(n+"="+t[n]);return(e.Yb?"https://":"http://")+e.aa+"/.lp?"+i.join("&")}}function zc(t,e,n,i){this.Ab=i,this.da=n,this.tc=new tc,this.qb=[],this.kc=Math.floor(1e8*Math.random()),this.Zc=k,this.cc=Jb(),window[uc+this.cc]=t,window[vc+this.cc]=e,t=document.createElement("iframe"),t.style.display="none",document.body?document.body.appendChild(t):g("Document body has not initialized. Wait to initialize Firebase until after the document is ready."),t.contentDocument?t.qa=t.contentDocument:t.contentWindow?t.qa=t.contentWindow.document:t.document&&(t.qa=t.document),this.ca=t;try{this.ca.qa.open(),this.ca.qa.write("<html><body></body></html>"),this.ca.qa.close()}catch(r){Pb("frame writing exception"),r.stack&&Pb(r.stack),Pb(r)}}function Bc(t){if(t.fc&&t.Zc&&t.tc.count()<(0<t.qb.length?2:1)){t.kc++;var e={};e.id=t.td,e.pw=t.ud,e.ser=t.kc;for(var e=t.Ab(e),n="",i=0;0<t.qb.length&&1870>=t.qb[0].Fc.length+30+n.length;){var r=t.qb.shift(),n=n+"&seg"+i+"="+r.Ad+"&ts"+i+"="+r.Gd+"&d"+i+"="+r.Fc;i++}var e=e+n,a=t.kc;t.tc.add(a);var s=function(){t.tc.remove(a),Bc(t)},c=setTimeout(s,25e3);return Ac(t,e,function(){clearTimeout(c),s()}),k}return o}function Ac(t,e,n){setTimeout(function(){try{var i=t.ca.qa.createElement("script");i.type="text/javascript",i.async=k,i.src=e,i.onload=i.onreadystatechange=function(){var t=i.readyState;t&&"loaded"!==t&&"complete"!==t||(i.onload=i.onreadystatechange=l,i.parentNode&&i.parentNode.removeChild(i),n())},i.onerror=function(){Pb("Long-poll script failed to load."),t.close()},t.ca.qa.body.appendChild(i)}catch(r){}},1)}function Cc(){function t(t,n){n&&n.isAvailable()&&e.push(n)}var e=[],n=Dc;if("array"==ea(n))for(var i=0;i<n.length;++i)t(0,n[i]);else S(n,t);this.bc=e}function Ec(t,e,n,i,r,o){this.id=t,this.e=Sb("c:"+this.id+":"),this.sc=n,this.mb=i,this.va=r,this.rc=o,this.M=e,this.Pb=[],this.Dc=0,this.Bc=new Cc,this.ma=0,this.e("Connection created"),Fc(this)}function Fc(t){var e,n=t.Bc;0<n.bc.length?e=n.bc[0]:g(Error("No transports available")),t.G=new e("c:"+t.id+":"+t.Dc++,t.M);var i=Gc(t,t.G),r=Hc(t,t.G);t.yb=t.G,t.vb=t.G,t.w=l,setTimeout(function(){t.G&&t.G.open(i,r)},0)}function Hc(t,e){return function(n){e===t.G?(t.G=l,n||0!==t.ma?1===t.ma&&t.e("Realtime connection lost."):(t.e("Realtime connection failed."),"s-"===t.M.aa.substr(0,2)&&(N.removeItem(t.M.jb),t.M.aa=t.M.host)),t.close()):e===t.w?(n=t.w,t.w=l,(t.yb===n||t.vb===n)&&t.close()):t.e("closing an old connection")}}function Gc(t,e){return function(n){if(2!=t.ma)if(e===t.vb){var i=Xb("t",n),n=Xb("d",n);if("c"==i){if(i=Xb("t",n),"d"in n)if(n=n.d,"h"===i){var i=n.ts,r=n.v,o=n.h;t.Zb=n.s,tb(t.M,o),0==t.ma&&(t.G.start(),n=t.G,t.e("Realtime connection established."),t.G=n,t.ma=1,t.mb&&(t.mb(i),t.mb=l),"5"!==r&&Vb("Protocol version mismatch detected"),n=1<t.Bc.bc.length?t.Bc.bc[1]:l)&&(t.w=new n("c:"+t.id+":"+t.Dc++,t.M,t.Zb),t.w.open(Gc(t,t.w),Hc(t,t.w)))}else if("n"===i){for(t.e("recvd end transmission on primary"),t.vb=t.w,n=0;n<t.Pb.length;++n)t.Kb(t.Pb[n]);t.Pb=[],Ic(t)}else"s"===i?(t.e("Connection shutdown command received. Shutting down..."),t.rc&&(t.rc(n),t.rc=l),t.va=l,t.close()):"r"===i?(t.e("Reset packet received.  New host: "+n),tb(t.M,n),1===t.ma?t.close():(Jc(t),Fc(t))):Tb("Unknown control packet command: "+i)}else"d"==i&&t.Kb(n)}else e===t.w?(i=Xb("t",n),n=Xb("d",n),"c"==i?"t"in n&&(n=n.t,"a"===n?(t.w.start(),t.e("sending client ack on secondary"),t.w.send({t:"c",d:{t:"a",d:{}}}),t.e("Ending transmission on primary"),t.G.send({t:"c",d:{t:"n",d:{}}}),t.yb=t.w,Ic(t)):"r"===n&&(t.e("Got a reset on secondary, closing it"),t.w.close(),(t.yb===t.w||t.vb===t.w)&&t.close())):"d"==i?t.Pb.push(n):g(Error("Unknown protocol layer: "+i))):t.e("message on old connection")}}function Ic(t){t.yb===t.w&&t.vb===t.w&&(t.e("cleaning up and promoting a connection: "+t.w.jc),t.G=t.w,t.w=l)}function Jc(t){t.e("Shutting down all connections"),t.G&&(t.G.close(),t.G=l),t.w&&(t.w.close(),t.w=l)}function Kc(t,e,n,i){this.id=Lc++,this.e=Sb("p:"+this.id+":"),this.wb=k,this.ba={},this.O=[],this.nb=0,this.lb=[],this.S=o,this.Ub=1e3,this.Lb=e||da,this.Jb=n||da,this.kb=i||da,this.M=t,this.vc=l,this.Rb=[],this.xa={},this.zd=0,this.hb=this.Oc=l,setTimeout(u(this.Gc,this),0)}function Nc(t,e,n,i,r){t.e("Listen on "+e+" for "+n);var o={p:e},i=mb(i,function(t){return Ja(t)});"{}"!==n&&(o.q=i),t.ya("l",o,function(i){t.e("listen response",i),i=i.s,"ok"!==i&&Oc(t,e,n),r&&r(i)},function(){t.e("timed out on listen...")})}function Pc(t){var e=t.Ca;t.S&&e&&t.ya("auth",{cred:e.kd},function(n){var i=n.s,n=n.d||"error";"ok"!==i&&t.Ca===e&&delete t.Ca,e.Ic?"ok"!==i&&e.Cb&&e.Cb(i,n):(e.Ic=k,e.fa&&e.fa(i,n)),t.kb("ok"===i)},function(){t.e("timed out on auth...")})}function Qc(t,e,n,i){t.S?Rc(t,"o",e,n,i):t.lb.push({uc:e,action:"o",data:n,A:i})}function Rc(t,e,n,i,r){n={p:n,d:i},t.e("onDisconnect "+e,n),t.ya(e,n,function(t){r&&setTimeout(function(){r(t.s)},0)},function(){t.e("timed out on onDisconnect...")})}function Sc(t,e,n,i,r,o){n={p:n,d:i},s(o)&&(n.h=o),t.O.push({action:e,Vc:n,A:r}),t.nb++,e=t.O.length-1,t.S&&Tc(t,e)}function Tc(t,e){var n=t.O[e].action,i=t.O[e].A;t.ya(n,t.O[e].Vc,function(r){t.e(n+" response",r),delete t.O[e],t.nb--,0===t.nb&&(t.O=[]),i&&i(r.s)},function(){t.e("timed out on put...")})}function Oc(t,e,n){e=new I(e).toString(),n||(n="{}");var i=t.ba[e][n];return delete t.ba[e][n],i}function Uc(){this.Ka=O}function T(t,e){return t.Ka.F(e)}function U(t,e,n){t.Ka=t.Ka.Ya(e,n)}function Vc(){this.za=new Uc,this.K=new Uc,this.Aa=new Uc,this.pb=new Ra}function Wc(t,e){for(var n=T(t.za,e),i=T(t.K,e),r=J(t.pb,e),a=o,s=r;s!==l;){if(s.j()!==l){a=k;break}s=s.parent()}return a?o:(n=Xc(n,i,r),n!==i?(U(t.K,e,n),k):o)}function Xc(t,e,n){return n.f()?t:n.j()!==l?e:(t=t||O,n.B(function(i){var i=i.name(),r=t.N(i),o=e.N(i),a=J(n,i),r=Xc(r,o,a);t=t.D(i,r)}),t)}function Yc(t,e){lb(e,function(e){var n=e.Bd,e=J(t.pb,e.path),i=e.j();z(i!==l,"pendingPut should not be null."),i===n&&M(e,l)})}function Zc(){this.Da=[]}function $c(t,e){if(0!==e.length){t.Da.push.apply(t.Da,e);for(var n=0;n<t.Da.length;n++)if(t.Da[n]){var i=t.Da[n];t.Da[n]=l;var r=i.fa;r(i.$c,i.rb)}t.Da=[]}}function V(t,e,n,i){this.type=t,this.ja=e,this.V=n,this.rb=i}function ad(t){this.I=t,this.ga=[],this.Hc=new Zc}function bd(t,e,n,i,r){t.ga.push({type:e,fa:n,cancel:i,W:r});var i=[],o=cd(t.g);t.fb&&o.push(new V("value",t.g));for(var a=0;a<o.length;a++)if(o[a].type===e){var s=new W(t.I.o,t.I.path);o[a].V&&(s=s.C(o[a].V)),i.push({fa:r?u(n,r):n,$c:new R(o[a].ja,s),rb:o[a].rb})}$c(t.Hc,i)}function fd(t,e){for(var n=[],i=0;i<e.length;i++){var r=e[i],o=r.type,a=new W(t.I.o,t.I.path);for(e[i].V&&(a=a.C(e[i].V)),a=new R(e[i].ja,a),"value"!==r.type||a.Eb()?"value"!==r.type&&(o+=" "+a.name()):o+="("+a.P()+")",Pb(t.I.o.n.id+": event:"+t.I.path+":"+t.I.Ia()+":"+o),o=0;o<t.ga.length;o++){var s=t.ga[o];e[i].type===s.type&&n.push({fa:s.W?u(s.fa,s.W):s.fa,$c:a,rb:r.rb})}}$c(t.Hc,n)}function cd(t){var e=[];if(!t.J()){var n=l;t.B(function(t,i){e.push(new V("child_added",i,t,n)),n=t})}return e}function gd(t){t.fb||(t.fb=k,fd(t,[new V("value",t.g)]))}function hd(t,e){ad.call(this,t),this.g=e}function id(t,e){this.Db=t,this.pc=e}function jd(t,e,n,i,r){var a=t.F(n),s=e.F(n),i=new id(i,r),r=kd(i,n,a,s),c=o;if(!a.f()&&!s.f()&&a.k()!==s.k())var c=t.F(n.parent()),h=e.F(n.parent()),u=Ma(n),c=c.T(u,a)!=h.T(u,s);if(r||c)for(a=n,n=r,s=c;a.parent()!==l;){var f=t.F(a),r=e.F(a),c=a.parent();i.Db&&!J(i.Db,c).j()||(h=e.F(c),u=[],a=Ma(a),f.f()?(f=h.T(a,r),u.push(new V("child_added",r,a,f))):r.f()?u.push(new V("child_removed",f,a)):(f=h.T(a,r),s&&u.push(new V("child_moved",r,a,f)),n&&u.push(new V("child_changed",r,a,f))),i.pc(c,h,u)),s&&(s=o,n=k),a=c}}function kd(t,e,n,i){var r,a=[];return n===i?r=o:n.J()&&i.J()?r=n.j()!==i.j():n.J()?(ld(t,e,O,i,a),r=k):i.J()?(ld(t,e,n,O,a),r=k):r=ld(t,e,n,i,a),r?t.pc(e,i,a):n.k()!==i.k()&&t.pc(e,i,l),r}function ld(t,e,n,i,r){var a,c,h,u,f=o,p=!t.Db||!J(t.Db,e).f(),d=[],b=[],y=[],g=[],v={},m={};for(a=n.Qa(),h=$a(a),c=i.Qa(),u=$a(c);h!==l||u!==l;)if(n=h===l?1:u===l?-1:h.key===u.key?0:ec({name:h.key,wa:h.value.k()},{name:u.key,wa:u.value.k()}),0>n?(f=ua(v,h.key),s(f)?(y.push({Jc:h,cd:d[f]}),d[f]=l):(m[h.key]=b.length,b.push(h)),f=k,h=$a(a)):(n>0?(f=ua(m,u.key),s(f)?(y.push({Jc:b[f],cd:u}),b[f]=l):(v[u.key]=d.length,d.push(u)),f=k):(n=e.C(u.key),(n=kd(t,n,h.value,u.value))&&(g.push(u),f=k),h=$a(a)),u=$a(c)),!p&&f)return k;for(p=0;p<b.length;p++)(v=b[p])&&(n=e.C(v.key),kd(t,n,v.value,O),r.push(new V("child_removed",v.value,v.key)));for(p=0;p<d.length;p++)(v=d[p])&&(n=e.C(v.key),b=i.T(v.key,v.value),kd(t,n,O,v.value),r.push(new V("child_added",v.value,v.key,b)));for(p=0;p<y.length;p++)v=y[p].Jc,d=y[p].cd,n=e.C(d.key),b=i.T(d.key,d.value),r.push(new V("child_moved",d.value,d.key,b)),(n=kd(t,n,v.value,d.value))&&g.push(d);for(p=0;p<g.length;p++)t=g[p],b=i.T(t.key,t.value),r.push(new V("child_changed",t.value,t.key,b));return f}function md(){this.L=this.na=l,this.set={}}function nd(t){return t.contains("default")}function od(t){return t.na!=l&&nd(t)}function pd(t,e){ad.call(this,t),this.g=O,this.Tb(e,cd(e))}function qd(t,e,n,i){if(t.J())return l;var r=l;return(i?t.lc:t.B).call(t,function(t,i){return rd(e,t,i)&&(r=t,n--,0===n)?k:void 0}),r}function rd(t,e,n){for(var i=0;i<t.length;i++)if(!t[i](e,n.k()))return o;return k}function sd(t,e){this.n=t,this.i=e,this.Qc=e.Ka,this.pa=new Ra}function vd(t,e,n,i,r){for(var a=t.get(e),s=o,c=a.ga.length-1;c>=0;c--){var h=a.ga[c];if(!(n&&h.type!==n||i&&h.fa!==i||r&&h.W!==r)&&(a.ga.splice(c,1),s=k,n&&i))break}return(n=s&&!(0<a.ga.length))&&t.remove(e),n}function wd(t,e,n,i,r,a){var s=e.path(),s=J(t.pa,s),n=n?n.Ia():l,c=[];if(n&&"default"!==n?vd(e,n,i,r,a)&&c.push(n):lb(e.keys(),function(t){vd(e,t,i,r,a)&&c.push(t)}),e.f()&&M(s,l),n=td(s),0<c.length&&!n){for(var h=s,u=s.parent(),n=o;!n&&u;){var f=u.j();if(f){z(!od(f));var p=h.name(),d=o;S(f.set,function(t){d=t.mc(p)||d}),d&&(n=k)}h=u,u=u.parent()}if(h=l,!od(e)){u=e.na,e.na=l;var b=[],y=function(e){var n=e.j();n&&nd(n)?(b.push(n.path()),n.na==l&&n.setActive(ud(t,n))):(n&&n.na==l&&n.setActive(ud(t,n)),e.B(y))};y(s),h=b,u&&u()}return n?l:h}return l}function xd(t,e,n){Ta(J(t.pa,e),function(t){(t=t.j())&&S(t.set,function(t){gd(t)})},n,k)}function yd(t,e,n){function i(t){for(var e=0;e<n.length;++e)if(n[e].contains(t))return k;return o}var r=t.Qc,a=t.i.Ka;t.Qc=a,jd(r,a,e,t.pa,function(n,r,a){if(e.contains(n)){var s=i(n);s&&xd(t,n,o),t.Sb(n,r,a),s&&xd(t,n,k)}else t.Sb(n,r,a)}),i(e)&&xd(t,e,k)}function td(t){return Ua(t,function(t){return t.j()&&od(t.j())})}function ud(t,e){if(t.n){var n=e.keys(),i=t.n,r=function(i){"ok"!==i?(Vb("on() or once() for "+e.path().toString()+" failed: "+i),e&&S(e.set,function(t){for(var e=0;e<t.ga.length;e++){var n=t.ga[e];n.cancel&&(n.W?u(n.cancel,n.W):n.cancel)()}}),wd(t,e)):lb(n,function(t){(t=e.get(t))&&gd(t)})},o=e.toString(),a=e.path().toString();return i.ba[a]=i.ba[a]||{},z(!i.ba[a][o],"listen() called twice for same path/queryId."),i.ba[a][o]={Va:e.Va(),A:r},i.S&&Nc(i,a,o,e.Va(),r),u(t.n.dd,t.n,e.path(),e.toString(),e.Va())}return da}function zd(t,e,n,i,r,o){var a=e.path();if(o!==l){var s=[];return i.J()||i.B(function(t,e){s.push({path:a.C(t),Fa:e}),delete o[t]}),S(o,function(t,e){s.push({path:a.C(e),Fa:O})}),s}var e=t.bb(a,e,i,r),c=O,h=[];return S(e,function(e,o){var a=new I(o);e?c=c.D(o,i.F(a)):h=h.concat(Ad(t,i.F(a),J(n,a),r))}),[{path:a,Fa:c}].concat(h)}function Bd(t,e,n,i,r){for(var a=J(t.pa,e),s=a.parent(),c=o;!c&&s!==l;){var h=s.j();h!==l&&(nd(h)?c=k:(h=t.bb(e,h,n,i),a=a.name(),ua(h,a)&&(c=k))),a=s,s=s.parent()}return c?[{path:e,Fa:n}]:(s=J(t.pa,e),c=s.j(),c!==l?nd(c)?[{path:e,Fa:n}]:zd(t,c,s,n,i,r):Ad(t,n,s,i))}function Ad(t,e,n,i){var r=n.j();if(r!==l)return nd(r)?[{path:n.path(),Fa:e}]:zd(t,r,n,e,i,l);if(e.J())return[];var o=[];return e.B(function(e,r){var a=new I(e);o=o.concat(Ad(t,r,J(n,a),i))}),o}function Cd(t){this.M=t,this.$=nc(t),this.n=new Kc(this.M,u(this.Lb,this),u(this.Jb,this),u(this.kb,this));var e=u(function(){return new kc(this.$,this.n)},this),t=t.toString();mc[t]||(mc[t]=e()),this.Fd=mc[t],this.ac=new Ra,this.i=new Vc,this.Q=new sd(this.n,this.i.Aa),this.Mc=new Uc,this.nc=new sd(l,this.Mc),Dd(this,"connected",o),Dd(this,"authenticated",o)}function Dd(t,e,n){e=new I("/.info/"+e),U(t.Mc,e,Q(n)),yd(t.nc,e,[e])}function Hd(t,e,n,i){n=Q(n),Qc(t.n,e.toString(),n.P(k),function(t){X(i,t)})}function Id(t){ic(t.$,"deprecated_on_disconnect"),t.Fd.ad.deprecated_on_disconnect=k}function Jd(t,e){var n=new W(t,e);return new R(T(t.i.Aa,e),n)}function X(t,e,n){if(t)if("ok"==e)t(l,n);else{var i=e=(e||"error").toUpperCase();n&&(i+=": "+n),n=Error(i),n.code=e,t(n)}}function Gd(t,e){var n=J(t.ac,e);Ua(n,function(e){Kd(t,e)}),Kd(t,n),Ta(n,function(e){Kd(t,e)})}function Kd(t,e){var n=e.j();if(n!==l){for(var i=-1,r=[],a=0;a<n.length;a++)if(2===n[a].status)z(i===a-1,"All SENT items should be at beginning of queue."),i=a,n[a].status=4,n[a].Cc="set";else if(n[a].dc(),n[a].A){var s=Jd(t,e.path());r.push(u(n[a].A,l,Error("set"),o,s))}for(-1===i?M(e,l):n.length=i+1,a=0;a<r.length;a++)r[a]()}}function Ld(t,e){var n=e||t.ac;if(e||Md(t,n),!n.f())if(n.j()!==l){var i=Nd(t,n);if(0!==i.length){var r=n.path();if(2!==i[0].status&&4!==i[0].status){for(var o=0;o<i.length;o++)z(1===i[o].status,"tryToSendTransactionForNode_: items in queue should all be run."),i[o].status=2,i[o].Yc++;var a=T(t.i.K,r).hash();U(t.i.K,r,T(t.i.Aa,r));var s=T(t.i.K,r).P(k),c=Jb();M(J(t.i.pb,r),c),t.n.put(r.toString(),s,function(e){t.e("transaction put response",{path:r.toString(),status:e});var a=J(t.i.pb,r),s=a.j();if(z(s!==l,"tryToSendTransactionsForNode_: pendingPut should not be null."),s===c&&(M(a,l),U(t.i.K,r,T(t.i.za,r))),"ok"===e){for(e=[],o=0;o<i.length;o++)i[o].status=3,i[o].A&&(a=Jd(t,i[o].path),e.push(u(i[o].A,l,l,k,a))),i[o].dc();for(Md(t,n),Ld(t),o=0;o<e.length;o++)e[o]()}else{if("datastale"===e)for(o=0;o<i.length;o++)i[o].status=4===i[o].status?5:1;else for(Vb("transaction at "+r+" failed: "+e),o=0;o<i.length;o++)i[o].status=5,i[o].Cc=e;e=Ed(t,r),Fd(t,e),yd(t.Q,e.path(),[r])}},a)}}}else n.B(function(e){Ld(t,e)})}function Fd(t,e){var n=e.path();U(t.i.Aa,n,T(t.i.K,n));var i=Nd(t,e);if(0!==i.length){for(var r=T(t.i.Aa,n),a=[],c=0;c<i.length;c++){var h,f=Na(n,i[c].path),p=o;if(z(f!==l,"rerunTransactionsUnderNode_: relativePath should not be null."),5===i[c].status)p=k,h=i[c].Cc;else if(1===i[c].status)if(25<=i[c].Yc)p=k,h="maxretry";else{var d=i[c].update(r.F(f).P());s(d)?(Aa("transaction failed: Data returned ",d),r=r.Ya(f,Q(d))):(p=k,h="nodata")}p&&(i[c].dc(),i[c].status=3,i[c].A&&(p=new W(t,i[c].path),f=new R(r.F(f),p),"nodata"===h?a.push(u(i[c].A,l,l,o,f)):a.push(u(i[c].A,l,Error(h),o,f))))}for(i=T(t.i.K,n).k(),U(t.i.Aa,n,r.ec(i)),Ld(t),c=0;c<a.length;c++)a[c]()}}function Ed(t,e){for(var n,i=t.ac;(n=F(e))!==l&&i.j()===l;)i=J(i,n),e=La(e);return i}function Nd(t,e){var n=[];return Od(t,e,n),n.sort(function(t,e){return t.Sc-e.Sc}),n}function Od(t,e,n){var i=e.j();if(i!==l)for(var r=0;r<i.length;r++)n.push(i[r]);e.B(function(e){Od(t,e,n)})}function Md(t,e){var n=e.j();if(n){for(var i=0,r=0;r<n.length;r++)3!==n[r].status&&(n[i]=n[r],i++);n.length=i,M(e,0<n.length?n:l)}e.B(function(e){Md(t,e)})}function Y(){this.Wa={}}function $(t,e,n){this.tb=t,this.L=e,this.ua=n}function W(){var e,n,i;if(arguments[0]instanceof Cd)i=arguments[0],e=arguments[1];else{A("new Firebase",1,2,arguments.length);var r=arguments[0];n=e="";var a=k,s="";if(t(r)){var c=r.indexOf("//");if(c>=0)var h=r.substring(0,c-1),r=r.substring(c+2);c=r.indexOf("/"),-1===c&&(c=r.length),e=r.substring(0,c);var r=r.substring(c+1),u=e.split(".");if(3==u.length){if(c=u[2].indexOf(":"),a=c>=0?"https"===h:k,"firebase"===u[1])Ub(e+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead");else for(n=u[0],s="",r=("/"+r).split("/"),h=0;h<r.length;h++)if(0<r[h].length){c=r[h];try{c=decodeURIComponent(c.replace(/\+/g," "))}catch(f){}s+="/"+c}n=n.toLowerCase()}else n=l}a||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&Vb("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),e=new sb(e,a,n),n=new I(s),a=n.toString(),(r=!t(e.host))||(r=0===e.host.length)||(r=!ya(e.jb))||(r=0!==a.length)&&(a&&(a=a.replace(/^\/*\.info(\/|$)/,"/")),r=!(t(a)&&0!==a.length&&!xa.test(a))),r&&g(Error(B("new Firebase",1,o)+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')),arguments[1]?arguments[1]instanceof Y?i=arguments[1]:g(Error("Expected a valid Firebase.Context for second argument to new Firebase()")):i=Y.pd(),a=e.toString(),r=ua(i.Wa,a),r||(r=new Cd(e),i.Wa[a]=r),i=r,e=n}G.call(this,i,e)}function Qb(t,e){z(!e||t===k||t===o,"Can't turn on custom loggers persistently."),t===k?("undefined"!=typeof console&&("function"==typeof console.log?Nb=u(console.log,console):"object"==typeof console.log&&(Nb=function(t){console.log(t)})),e&&N.setItem("logging_enabled","true")):t?Nb=t:(Nb=l,N.removeItem("logging_enabled"))}var j=void 0,k=!0,l=null,o=!1,r,ba=this;
Math.floor(2147483648*Math.random()).toString(36);var pa={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","\x0B":"\\u000b"},qa=/\uffff/.test("￿")?/[\\\"\x00-\x1f\x7f-\uffff]/g:/[\\\"\x00-\x1f\x7f-\xff]/g,va={},sa={},wa=/[\[\].#$\/]/,xa=/[\[\].#$]/;G.prototype.oc=function(t,e){A("Query.on",2,4,arguments.length),Fa("Query.on",t,o),C("Query.on",2,e,o);var n=Ia("Query.on",arguments[2],arguments[3]);return this.o.Bb(this,t,e,n.cancel,n.W),e},G.prototype.on=G.prototype.oc,G.prototype.Ib=function(t,e,n){A("Query.off",0,3,arguments.length),Fa("Query.off",t,k),C("Query.off",2,e,k),ta("Query.off",3,n),this.o.Wb(this,t,e,n)},G.prototype.off=G.prototype.Ib,G.prototype.vd=function(t,e){function n(s){a&&(a=o,r.Ib(t,n),e.call(i.W,s))}A("Query.once",2,4,arguments.length),Fa("Query.once",t,o),C("Query.once",2,e,o);var i=Ia("Query.once",arguments[2],arguments[3]),r=this,a=k;this.oc(t,n,function(){r.Ib(t,n),i.cancel&&i.cancel.call(i.W)})},G.prototype.once=G.prototype.vd,G.prototype.rd=function(t){return A("Query.limit",1,1,arguments.length),(!ga(t)||Math.floor(t)!==t||0>=t)&&g("Query.limit: First argument must be a positive integer."),new G(this.o,this.path,t,this.Z,this.la,this.ra,this.Pa)},G.prototype.limit=G.prototype.rd,G.prototype.Ed=function(t,e){return A("Query.startAt",0,2,arguments.length),Ea("Query.startAt",1,t,k),Ga("Query.startAt",e),s(t)||(e=t=l),new G(this.o,this.path,this.ta,t,e,this.ra,this.Pa)},G.prototype.startAt=G.prototype.Ed,G.prototype.ld=function(t,e){return A("Query.endAt",0,2,arguments.length),Ea("Query.endAt",1,t,k),Ga("Query.endAt",e),new G(this.o,this.path,this.ta,this.Z,this.la,t,e)},G.prototype.endAt=G.prototype.ld,G.prototype.Ia=function(){var t=Ka(Ja(this));return"{}"===t?"default":t},r=I.prototype,r.toString=function(){for(var t="",e=this.X;e<this.m.length;e++)""!==this.m[e]&&(t+="/"+this.m[e]);return t||"/"},r.parent=function(){if(this.X>=this.m.length)return l;for(var t=[],e=this.X;e<this.m.length-1;e++)t.push(this.m[e]);return new I(t,0)},r.C=function(t){for(var e=[],n=this.X;n<this.m.length;n++)e.push(this.m[n]);if(t instanceof I)for(n=t.X;n<t.m.length;n++)e.push(t.m[n]);else for(t=t.split("/"),n=0;n<t.length;n++)0<t[n].length&&e.push(t[n]);return new I(e,0)},r.f=function(){return this.X>=this.m.length},r.contains=function(t){var e=0;if(this.m.length>t.m.length)return o;for(;e<this.m.length;){if(this.m[e]!==t.m[e])return o;++e}return k},r=Ra.prototype,r.j=function(){return this.u.value},r.Eb=function(){return 0<this.u.hc},r.f=function(){return this.j()===l&&!this.Eb()},r.B=function(t){for(var e in this.u.children)t(new Ra(e,this,this.u.children[e]))},r.path=function(){return new I(this.ob===l?this.ua:this.ob.path()+"/"+this.ua)},r.name=aa("ua"),r.parent=aa("ob"),r=Va.prototype,r.ia=function(t,e){return new Va(this.Ma,this.Y.ia(t,e,this.Ma).copy(l,l,o,l,l))},r.remove=function(t){return new Va(this.Ma,this.Y.remove(t,this.Ma).copy(l,l,o,l,l))},r.get=function(t){for(var e,n=this.Y;!n.f();){if(e=this.Ma(t,n.key),0===e)return n.value;0>e?n=n.left:e>0&&(n=n.right)}return l},r.f=function(){return this.Y.f()},r.count=function(){return this.Y.count()},r.ib=function(){return this.Y.ib()},r.Sa=function(){return this.Y.Sa()},r.sa=function(t){return this.Y.sa(t)},r.Ja=function(t){return this.Y.Ja(t)},r.Qa=function(t){return new Za(this.Y,t)},r=ab.prototype,r.copy=function(t,e,n,i,r){return new ab(t!=l?t:this.key,e!=l?e:this.value,n!=l?n:this.color,i!=l?i:this.left,r!=l?r:this.right)},r.count=function(){return this.left.count()+1+this.right.count()},r.f=p(o),r.sa=function(t){return this.left.sa(t)||t(this.key,this.value)||this.right.sa(t)},r.Ja=function(t){return this.right.Ja(t)||t(this.key,this.value)||this.left.Ja(t)},r.ib=function(){return bb(this).key},r.Sa=function(){return this.right.f()?this.key:this.right.Sa()},r.ia=function(t,e,n){var i,r;return r=this,i=n(t,r.key),r=0>i?r.copy(l,l,l,r.left.ia(t,e,n),l):0===i?r.copy(l,e,l,l,l):r.copy(l,l,l,l,r.right.ia(t,e,n)),cb(r)},r.remove=function(t,e){var n,i;if(n=this,0>e(t,n.key))!n.left.f()&&!n.left.H()&&!n.left.left.H()&&(n=eb(n)),n=n.copy(l,l,l,n.left.remove(t,e),l);else{if(n.left.H()&&(n=gb(n)),!n.right.f()&&!n.right.H()&&!n.right.left.H()&&(n=hb(n),n.left.left.H()&&(n=gb(n),n=hb(n))),0===e(t,n.key)){if(n.right.f())return Xa;i=bb(n.right),n=n.copy(i.key,i.value,l,l,db(n.right))}n=n.copy(l,l,l,l,n.right.remove(t,e))}return cb(n)},r.H=aa("color"),r=jb.prototype,r.copy=function(){return this},r.ia=function(t,e){return new ab(t,e,j,j,j)},r.remove=function(){return this},r.get=p(l),r.count=p(0),r.f=p(k),r.sa=p(o),r.Ja=p(o),r.ib=p(l),r.Sa=p(l),r.H=p(o);var Xa=new jb,kb=Array.prototype,lb=kb.forEach?function(t,e,n){kb.forEach.call(t,e,n)}:function(e,n,i){for(var r=e.length,o=t(e)?e.split(""):e,a=0;r>a;a++)a in o&&n.call(i,o[a],a,e)},mb=kb.map?function(t,e,n){return kb.map.call(t,e,n)}:function(e,n,i){for(var r=e.length,o=Array(r),a=t(e)?e.split(""):e,s=0;r>s;s++)s in a&&(o[s]=n.call(i,a[s],s,e));return o};ka(ob,nb),ob.prototype.reset=function(){this.z[0]=1732584193,this.z[1]=4023233417,this.z[2]=2562383102,this.z[3]=271733878,this.z[4]=3285377520,this.Ac=this.eb=0},ob.prototype.update=function(e,n){s(n)||(n=e.length);var i=this.gc,r=this.eb,o=0;if(t(e))for(;n>o;)i[r++]=e.charCodeAt(o++),64==r&&(pb(this,i),r=0);else for(;n>o;)i[r++]=e[o++],64==r&&(pb(this,i),r=0);this.eb=r,this.Ac+=n},qb.prototype.setItem=function(t,e){D(this.La,t)||(this.length+=1),this.La[t]=e},qb.prototype.getItem=function(t){return D(this.La,t)?this.La[t]:l},qb.prototype.removeItem=function(t){D(this.La,t)&&(this.length-=1,delete this.La[t])};var N=l;if("undefined"!=typeof sessionStorage)try{sessionStorage.setItem("firebase-sentinel","cache"),sessionStorage.removeItem("firebase-sentinel"),N=sessionStorage}catch(rb){N=new qb}else N=new qb;sb.prototype.toString=function(){return(this.Yb?"https://":"http://")+this.host};var ub,vb,wb,xb;xb=wb=vb=ub=o;var zb;if(zb=yb()){var Ab=ba.navigator;ub=0==zb.indexOf("Opera"),vb=!ub&&-1!=zb.indexOf("MSIE"),wb=!ub&&-1!=zb.indexOf("WebKit"),xb=!ub&&!wb&&"Gecko"==Ab.product}var Bb=vb,Cb=xb,Db=wb,Eb;if(ub&&ba.opera){var Fb=ba.opera.version;"function"==typeof Fb&&Fb()}else Cb?Eb=/rv\:([^\);]+)(\)|;)/:Bb?Eb=/MSIE\s+([^\);]+)(\)|;)/:Db&&(Eb=/WebKit\/(\S+)/),Eb&&Eb.exec(yb());var Gb=l,Hb=l,Jb,Kb=1;Jb=function(){return Kb++};var Nb=l,Ob=k,Yb=0;r=ac.prototype,r.J=p(k),r.k=aa("Ua"),r.ec=function(t){return new ac(this.oa,t)},r.N=function(){return O},r.F=function(t){return F(t)===l?this:O},r.T=p(l),r.D=function(t,e){return new P(new Va,this.Ua).D(t,e)},r.Ya=function(t,e){var n=F(t);return n===l?e:this.D(n,O.Ya(La(t),e))},r.f=p(o),r.Hb=p(0),r.P=function(t){return t&&this.k()!==l?{".value":this.j(),".priority":this.k()}:this.j()},r.hash=function(){var t="";this.k()!==l&&(t+="priority:"+bc(this.k())+":");var e=typeof this.oa,t=t+(e+":"),t="number"===e?t+$b(this.oa):t+this.oa;return Lb(t)},r.j=aa("oa"),r.toString=function(){return"string"==typeof this.oa?'"'+this.oa+'"':this.oa},r=P.prototype,r.J=p(o),r.k=aa("Ua"),r.ec=function(t){return new P(this.R,t)},r.D=function(t,e){var n=this.R.remove(t);return e&&e.f()&&(e=l),e!==l&&(n=n.ia(t,e)),e&&e.k()!==l?new cc(n,l,this.Ua):new P(n,this.Ua)},r.Ya=function(t,e){var n=F(t);if(n===l)return e;var i=this.N(n).Ya(La(t),e);return this.D(n,i)},r.f=function(){return this.R.f()},r.Hb=function(){return this.R.count()};var dc=/^\d+$/;r=P.prototype,r.P=function(t){if(this.f())return l;var e={},n=0,i=0,r=k;if(this.B(function(a,s){e[a]=s.P(t),n++,r&&dc.test(a)?i=Math.max(i,Number(a)):r=o}),!t&&r&&2*n>i){var a,s=[];for(a in e)s[a]=e[a];return s}return t&&this.k()!==l&&(e[".priority"]=this.k()),e},r.hash=function(){var t="";return this.k()!==l&&(t+="priority:"+bc(this.k())+":"),this.B(function(e,n){var i=n.hash();""!==i&&(t+=":"+e+":"+i)}),""===t?"":Lb(t)},r.N=function(t){return t=this.R.get(t),t===l?O:t},r.F=function(t){var e=F(t);return e===l?this:this.N(e).F(La(t))},r.T=function(t){return Ya(this.R,t)},r.Kc=function(){return this.R.ib()},r.Lc=function(){return this.R.Sa()},r.B=function(t){return this.R.sa(t)},r.lc=function(t){return this.R.Ja(t)},r.Qa=function(){return this.R.Qa()},r.toString=function(){var t="{",e=k;return this.B(function(n,i){e?e=o:t+=", ",t+='"'+n+'" : '+i.toString()}),t+="}"};var O=new P(new Va);ka(cc,P),r=cc.prototype,r.D=function(t,e){var n=this.N(t),i=this.R,r=this.ka;return n!==l&&(i=i.remove(t),r=r.remove({name:t,wa:n.k()})),e&&e.f()&&(e=l),e!==l&&(i=i.ia(t,e),r=r.ia({name:t,wa:e.k()},e)),new cc(i,r,this.k())},r.T=function(t,e){var n=Ya(this.ka,{name:t,wa:e.k()});return n?n.name:l},r.B=function(t){return this.ka.sa(function(e,n){return t(e.name,n)})},r.lc=function(t){return this.ka.Ja(function(e,n){return t(e.name,n)})},r.Qa=function(){return this.ka.Qa(function(t,e){return{key:t.name,value:e}})},r.Kc=function(){return this.ka.f()?l:this.ka.ib().name},r.Lc=function(){return this.ka.f()?l:this.ka.Sa().name},R.prototype.P=function(){return A("Firebase.DataSnapshot.val",0,0,arguments.length),this.u.P()},R.prototype.val=R.prototype.P,R.prototype.md=function(){return A("Firebase.DataSnapshot.exportVal",0,0,arguments.length),this.u.P(k)},R.prototype.exportVal=R.prototype.md,R.prototype.C=function(t){A("Firebase.DataSnapshot.child",0,1,arguments.length),ga(t)&&(t=String(t)),Ha("Firebase.DataSnapshot.child",t);var e=new I(t),n=this.Vb.C(e);return new R(this.u.F(e),n)},R.prototype.child=R.prototype.C,R.prototype.mc=function(t){A("Firebase.DataSnapshot.hasChild",1,1,arguments.length),Ha("Firebase.DataSnapshot.hasChild",t);var e=new I(t);return!this.u.F(e).f()},R.prototype.hasChild=R.prototype.mc,R.prototype.k=function(){return A("Firebase.DataSnapshot.getPriority",0,0,arguments.length),this.u.k()},R.prototype.getPriority=R.prototype.k,R.prototype.forEach=function(t){if(A("Firebase.DataSnapshot.forEach",1,1,arguments.length),C("Firebase.DataSnapshot.forEach",1,t,o),this.u.J())return o;var e=this;return this.u.B(function(n,i){return t(new R(i,e.Vb.C(n)))})},R.prototype.forEach=R.prototype.forEach,R.prototype.Eb=function(){return A("Firebase.DataSnapshot.hasChildren",0,0,arguments.length),this.u.J()?o:!this.u.f()},R.prototype.hasChildren=R.prototype.Eb,R.prototype.name=function(){return A("Firebase.DataSnapshot.name",0,0,arguments.length),this.Vb.name()},R.prototype.name=R.prototype.name,R.prototype.Hb=function(){return A("Firebase.DataSnapshot.numChildren",0,0,arguments.length),this.u.Hb()},R.prototype.numChildren=R.prototype.Hb,R.prototype.wd=function(){return A("Firebase.DataSnapshot.ref",0,0,arguments.length),this.Vb},R.prototype.ref=R.prototype.wd,hc.prototype.get=function(){return gc(this.$a)},jc.prototype.get=function(){var t=this.jd.get(),e=gc(t);if(this.Fb)for(var n in this.Fb)e[n]-=this.Fb[n];return this.Fb=t,e},kc.prototype.Uc=function(){var t,e=this.$b.get(),n={},i=o;for(t in e)0<e[t]&&D(this.ad,t)&&(n[t]=e[t],i=k);i&&(e=this.n,e.S&&(n={c:n},e.e("reportStats",n),e.ya("s",n))),setTimeout(u(this.Uc,this),6e5*Math.random())};var lc={},mc={},oc=l;"undefined"!=typeof MozWebSocket?oc=MozWebSocket:"undefined"!=typeof WebSocket&&(oc=WebSocket);var qc;pc.prototype.open=function(t,e){this.da=e,this.Mb=t,this.e("websocket connecting to "+this.Na),this.U=new oc(this.Na),this.ab=o;var n=this;this.U.onopen=function(){n.e("Websocket connected."),n.ab=k},this.U.onclose=function(){n.e("Websocket connection was disconnected."),n.U=l,n.Ha()},this.U.onmessage=function(t){if(n.U!==l)if(t=t.data,ic(n.$,"bytes_received",t.length),rc(n),n.frames!==l)sc(n,t);else{t:{if(z(n.frames===l,"We already have a frame buffer"),4>=t.length){var e=Number(t);if(!isNaN(e)){n.zc=e,n.frames=[],t=l;break t}}n.zc=1,n.frames=[]}t!==l&&sc(n,t)}},this.U.onerror=function(){n.e("WebSocket error.  Closing connection."),n.Ha()}},pc.prototype.start=function(){},pc.isAvailable=function(){return!("undefined"!=typeof navigator&&"Opera"===navigator.appName||oc===l||qc)},pc.prototype.send=function(t){rc(this),t=y(t),ic(this.$,"bytes_sent",t.length),t=Zb(t,16384),1<t.length&&this.U.send(String(t.length));for(var e=0;e<t.length;e++)this.U.send(t[e])},pc.prototype.xb=function(){this.Ea=k,this.gb&&(clearTimeout(this.gb),this.gb=l),this.U&&(this.U.close(),this.U=l)},pc.prototype.Ha=function(){this.Ea||(this.e("WebSocket is closing itself"),this.xb(),this.da&&(this.da(this.ab),this.da=l))},pc.prototype.close=function(){this.Ea||(this.e("WebSocket is being closed"),this.xb())},r=tc.prototype,r.add=function(t,e){this.set[t]=e!==l?e:k},r.contains=function(t){return D(this.set,t)},r.get=function(t){return this.set[t]},r.remove=function(t){delete this.set[t]},r.f=function(){var t;t:{for(t in this.set){t=o;break t}t=k}return t},r.count=function(){var t,e=0;for(t in this.set)e++;return e},r.keys=function(){var t,e=[];for(t in this.set)D(this.set,t)&&e.push(t);return e};var uc="pLPCommand",vc="pRTLPCB",xc,yc;wc.prototype.open=function(t,e){function n(){if(!i.Ea){i.ea=new zc(function(t,e,n,r,a){if(ic(i.$,"bytes_received",y(arguments).length),i.ea)if(i.Ba&&(clearTimeout(i.Ba),i.Ba=l),i.ab=k,"start"==t)i.id=e,i.Tc=n;else if("close"===t)if(e){i.ea.Zc=o;var s=i.Pc;s.ic=e,s.Ga=function(){i.Ha()},s.ic<s.Oa&&(s.Ga(),s.Ga=l)}else i.Ha();else g(Error("Unrecognized command received: "+t))},function(t,e){ic(i.$,"bytes_received",y(arguments).length);var n=i.Pc;for(n.Qb[t]=e;n.Qb[n.Oa];){var r=n.Qb[n.Oa];delete n.Qb[n.Oa];for(var o=0;o<r.length;++o)r[o]&&n.sc(r[o]);if(n.Oa===n.ic){n.Ga&&(clearTimeout(n.Ga),n.Ga(),n.Ga=l);break}n.Oa++}},function(){i.Ha()},i.Ab);var t={start:"t"};t.ser=Math.floor(1e8*Math.random()),i.ea.cc&&(t.cb=i.ea.cc),t.v="5",i.Zb&&(t.s=i.Zb),t=i.Ab(t),i.e("Connecting via long-poll to "+t),Ac(i.ea,t,function(){})}}this.Ec=0,this.va=e,this.Pc=new fc(t),this.Ea=o;var i=this;if(this.Ba=setTimeout(function(){i.e("Timed out trying to connect."),i.Ha(),i.Ba=l},3e4),"complete"===document.readyState)n();else{var r=o,a=function(){document.body?r||(r=k,n()):setTimeout(a,10)};document.addEventListener?(document.addEventListener("DOMContentLoaded",a,o),window.addEventListener("load",a,o)):document.attachEvent&&(document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&a()},o),window.attachEvent("onload",a,o))}},wc.prototype.start=function(){var t=this.ea,e=this.Tc;for(t.td=this.id,t.ud=e,t.fc=k;Bc(t););t=this.id,e=this.Tc,this.Ta=document.createElement("iframe");var n={dframe:"t"};n.id=t,n.pw=e,t=this.Ab(n),this.Ta.src=t,this.Ta.style.display="none",document.body.appendChild(this.Ta)},wc.isAvailable=function(){return!yc&&(xc||k)},wc.prototype.xb=function(){this.Ea=k,this.ea&&(this.ea.close(),this.ea=l),this.Ta&&(document.body.removeChild(this.Ta),this.Ta=l),this.Ba&&(clearTimeout(this.Ba),this.Ba=l)},wc.prototype.Ha=function(){this.Ea||(this.e("Longpoll is closing itself"),this.xb(),this.va&&(this.va(this.ab),this.va=l))},wc.prototype.close=function(){this.Ea||(this.e("Longpoll is being closed."),this.xb())},wc.prototype.send=function(t){t=y(t),ic(this.$,"bytes_sent",t.length);for(var t=ra(t),t=Ib(t,k),t=Zb(t,1840),e=0;e<t.length;e++){var n=this.ea;n.qb.push({Ad:this.Ec,Gd:t.length,Fc:t[e]}),n.fc&&Bc(n),this.Ec++}},zc.prototype.close=function(){if(this.fc=o,this.ca){this.ca.qa.body.innerHTML="";var t=this;setTimeout(function(){t.ca!==l&&(document.body.removeChild(t.ca),t.ca=l)},0)}var e=this.da;e&&(this.da=l,e())};var Dc=[wc,{isAvailable:p(o)},pc];Ec.prototype.wc=function(t){t={t:"d",d:t},1!==this.ma&&g("Connection is not connected"),this.yb.send(t)},Ec.prototype.Kb=function(t){this.sc(t)},Ec.prototype.close=function(){2!==this.ma&&(this.e("Closing realtime connection."),this.ma=2,Jc(this),this.va&&(this.va(),this.va=l))};var Lc=0,Mc=0;r=Kc.prototype,r.ya=function(t,e,n,i){var r=++this.zd,t={r:r,a:t,b:e};this.e(y(t)),this.S?this.sb.wc(t):this.Rb.push(t);var o=this,t=setTimeout(function(){var t=o.xa[r];t&&(delete o.xa[r],t.ha&&t.ha.Nb&&t.ha.Nb())},45e3);this.xa[r]={ha:{Mb:n,Nb:i},bd:t}},r.Za=function(t,e,n){this.Ca={kd:t,Ic:o,fa:e,Cb:n},this.e("Authenticating using credential: "+this.Ca),Pc(this)},r.zb=function(){delete this.Ca,this.kb(o),this.S&&this.ya("unauth",{},function(){},function(){})},r.dd=function(t,e,n){if(t=t.toString(),Oc(this,t,e)&&this.S){this.e("Unlisten on "+t+" for "+e);var i=this,t={p:t},n=mb(n,function(t){return Ja(t)});"{}"!==e&&(t.q=n),this.ya("u",t,l,function(){i.e("timed out on unlisten...")})}},r.qc=function(t,e){this.S?Rc(this,"oc",t,l,e):this.lb.push({uc:t,action:"oc",data:l,A:e})},r.put=function(t,e,n,i){Sc(this,"p",t,e,n,i)},r.Kb=function(t){if("r"in t){this.e("from server: "+y(t));var e=t.r,n=this.xa[e];n&&(delete this.xa[e],clearTimeout(n.bd),n.ha&&n.ha.Mb&&n.ha.Mb(t.b))}else"error"in t&&g("A server-side error has occurred: "+t.error),"a"in t&&(e=t.a,t=t.b,this.e("handleServerMessage",e,t),"d"===e?this.Lb(t.p,t.d):"m"===e?this.Lb(t.p,t.d,k):"c"===e?(e=t.p,t=(t=t.q)?mb(t,function(t){return Ka(t)}).join("$"):"{}",(t=Oc(this,e,t))&&t.A&&t.A("permission_denied")):"ac"===e?(e=t.s,t=t.d,n=this.Ca,delete this.Ca,n&&n.Cb&&n.Cb(e,t),this.kb(o)):"sd"===e?this.vc?this.vc(t):"msg"in t&&"undefined"!=typeof console&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: ")):Tb("Unrecognized action received from server: "+y(e)+"\nAre you using the latest client?"))},r.mb=function(t){for(this.e("connection ready"),this.S=k,this.hb=(new Date).getTime(),Yb=t-(new Date).getTime(),t=0;t<this.Rb.length;t++)this.sb.wc(this.Rb[t]);for(this.Rb=[],Pc(this),t=0;t<this.O.length;t++)this.O[t]&&Tc(this,t);for(var e in this.ba)for(var n in this.ba[e])t=this.ba[e][n],Nc(this,e,n,t.Va,t.A);for(;this.lb.length;)e=this.lb.shift(),Rc(this,e.action,e.uc,e.data,e.A);this.Jb(k)},r.Rc=function(){this.S=o,this.e("data client disconnected");var t=u(function(){this.Gc()},this);if(this.wb){this.hb&&(3e4<(new Date).getTime()-this.hb&&(this.Ub=1e3),this.hb=l);var e=Math.max(0,this.Ub-((new Date).getTime()-this.Oc)),e=Math.random()*e;this.e("Trying to reconnect in "+e+"ms"),setTimeout(t,e),this.Ub=Math.min(3e5,1.5*this.Ub)}else{for(var n=0;n<this.O.length;n++){var i=this.O[n];i&&"h"in i.Vc&&(i.A&&i.A("disconnect"),delete this.O[n],this.nb--)}0===this.nb&&(this.O=[]);for(e in this.xa)n=this.xa[e],delete this.xa[e],n!==l&&(n.ha&&n.ha.Nb&&n.ha.Nb(),clearTimeout(n.bd));this.Xc=function(){setTimeout(t,0)}}this.Jb(o)},r.Gc=function(){if(this.wb){this.e("Making a connection attempt"),this.Oc=(new Date).getTime(),this.hb=l;var t=u(this.Kb,this),e=u(this.mb,this),n=u(this.Rc,this),i=this.id+":"+Mc++,r=this;this.sb=new Ec(i,this.M,t,e,n,function(t){r.wb=o,g(Error(t))})}},r.Ra=function(){this.wb=o,this.sb?this.sb.close():this.Rc()},r.ub=function(){this.wb=k,this.Xc(),this.Xc=j},Uc.prototype.toString=function(){return this.Ka.toString()},Vc.prototype.set=function(t,e){var n=this,i=[];return lb(e,function(t){var e=t.path,t=t.Fa,r=Jb();M(J(n.pb,e),r),U(n.K,e,t),i.push({path:e,Bd:r})}),i},ad.prototype.Sb=function(t,e){e=this.Tb(t,e),e!=l&&fd(this,e)},ka(hd,ad),hd.prototype.Tb=function(t,e){return this.g=t,this.fb&&e!=l&&e.push(new V("value",this.g)),e},hd.prototype.bb=function(){return{}},ka(md,tc),r=md.prototype,r.setActive=function(t){this.na=t},r.defaultView=function(){return nd(this)?this.get("default"):l},r.path=aa("L"),r.toString=function(){return mb(this.keys(),function(t){return"default"===t?"{}":t}).join("$")},r.Va=function(){var t=[];return S(this.set,function(e){t.push(e.I)}),t},ka(pd,ad),pd.prototype.Tb=function(t,e){if(e===l)return e;var n=[],i=this.I;s(i.Z)&&(s(i.la)&&i.la!=l?n.push(function(t,e){var n=Wb(e,i.Z);return n>0||0===n&&t>=i.la}):n.push(function(t,e){return 0<=Wb(e,i.Z)})),s(i.ra)&&(s(i.Pa)?n.push(function(t,e){var n=Wb(e,i.ra);return 0>n||0===n&&t<=i.Pa}):n.push(function(t,e){return 0>=Wb(e,i.ra)}));var r=l,a=l;if(s(this.I.ta))if(s(this.I.Z)){if(r=qd(t,n,this.I.ta,o)){var c=t.N(r).k();n.push(function(t,e){var n=Wb(e,c);return 0>n||0===n&&r>=t})}}else if(a=qd(t,n,this.I.ta,k)){var h=t.N(a).k();n.push(function(t,e){var n=Wb(e,h);return n>0||0===n&&t>=a})}for(var u=[],f=[],p=[],d=[],b=0;b<e.length;b++){var y=e[b].V,g=e[b].ja;switch(e[b].type){case"child_added":rd(n,y,g)&&(this.g=this.g.D(y,g),f.push(e[b]));break;case"child_removed":this.g.N(y).f()||(this.g=this.g.D(y,l),u.push(e[b]));break;case"child_changed":!this.g.N(y).f()&&rd(n,y,g)&&(this.g=this.g.D(y,g),d.push(e[b]));break;case"child_moved":var v=!this.g.N(y).f(),m=rd(n,y,g);v?m?(this.g=this.g.D(y,g),p.push(e[b])):(u.push(new V("child_removed",this.g.N(y),y)),this.g=this.g.D(y,l)):m&&(this.g=this.g.D(y,g),f.push(e[b]))}}var w=r||a;if(w){var F=(b=a!==l)?this.g.Kc():this.g.Lc(),S=o,A=o,E=this;(b?t.lc:t.B).call(t,function(t,e){return!A&&F===l&&(A=k),A&&S?k:(S?(u.push(new V("child_removed",E.g.N(t),t)),E.g=E.g.D(t,l)):A&&(f.push(new V("child_added",e,t)),E.g=E.g.D(t,e)),F===t&&(A=k),void(t===w&&(S=k)))})}for(b=0;b<f.length;b++)n=f[b],y=this.g.T(n.V,n.ja),u.push(new V("child_added",n.ja,n.V,y));for(b=0;b<p.length;b++)n=p[b],y=this.g.T(n.V,n.ja),u.push(new V("child_moved",n.ja,n.V,y));for(b=0;b<d.length;b++)n=d[b],y=this.g.T(n.V,n.ja),u.push(new V("child_changed",n.ja,n.V,y));return this.fb&&0<u.length&&u.push(new V("value",this.g)),u},pd.prototype.mc=function(t){return this.g.N(t)!==O},pd.prototype.bb=function(t,e,n){var i={};this.g.J()||this.g.B(function(t){i[t]=k});var r=this.g,n=T(n,new I("")),o=new Ra;M(J(o,this.I.path),k);var a=O.Ya(t,e),s=[];return jd(n,a,t,o,function(t,e,n){n!==l&&(s=s.concat(n))}),this.Tb(e,s),this.g.J()||this.g.B(function(t){i[t]=k}),this.g=r,i},sd.prototype.Bb=function(t,e,n,i,r){var o=t.path,a=J(this.pa,o),s=a.j();s===l?(s=new md,M(a,s)):z(!s.f(),"We shouldn't be storing empty QueryMaps");var c=t.Ia();if(s.contains(c))bd(s.get(c),e,n,i,r);else{var h=this.i.Ka.F(o),t="default"===t.Ia()?new hd(t,h):new pd(t,h);if(od(s)||td(a))s.add(c,t),s.L||(s.L=t.I.path);else{var u,f;s.f()||(u=s.toString(),f=s.Va()),s.add(c,t),s.L||(s.L=t.I.path),s.setActive(ud(this,s)),u&&f&&this.n.dd(s.path(),u,f)}od(s)&&Ta(a,function(t){(t=t.j())&&(t.na&&t.na(),t.na=l)}),bd(t,e,n,i,r),(e=(e=Ua(J(this.pa,o),function(t){var e;return(e=t.j())&&(e=t.j().defaultView())&&(e=t.j().defaultView().fb),e?k:void 0},k))||this.n===l)&&gd(t)}},sd.prototype.Wb=function(t,e,n,i){var r=J(this.pa,t.path).j();return r===l?l:wd(this,r,t,e,n,i)},sd.prototype.Sb=function(t,e,n){t=J(this.pa,t).j(),t!==l&&S(t.set,function(t){t.Sb(e,n)})},sd.prototype.bb=function(t,e,n,i){var r={};return S(e.set,function(e){e=e.bb(t,n,i),S(e,function(t,e){r[e]=t?k:ua(r,e)||o})}),n.J()||n.B(function(t){D(r,t)||(r[t]=o)}),r},r=Cd.prototype,r.toString=function(){return(this.M.Yb?"https://":"http://")+this.M.host},r.name=function(){return this.M.jb},r.Lb=function(t,e,n){var i=[],r=l;if(9<=t.length&&t.lastIndexOf(".priority")===t.length-9)t=new I(t.substring(0,t.length-9)),n=T(this.i.za,t).ec(e),i.push(t);else if(n){var a,r=e,t=new I(t),n=T(this.i.za,t);for(a in e){var s=Q(e[a]),n=n.D(a,s);i.push(t.C(a))}}else t=new I(t),n=Q(e),i.push(t);for(e=Bd(this.Q,t,n,this.i.K,r),r=o,a=0;a<e.length;++a){var n=e[a],s=this.i,c=n.path;U(s.za,c,n.Fa),r=Wc(s,c)||r}r&&(t=Ed(this,t),Fd(this,t),t=t.path()),yd(this.Q,t,i)},r.Jb=function(t){Dd(this,"connected",t)},r.kb=function(t){Dd(this,"authenticated",t)},r.Za=function(t,e,n){this.n.Za(t,function(t,n){X(e,t,n)},function(t,e){if(Vb("auth() was canceled: "+e),n){var i=Error(e);i.code=t.toUpperCase(),n(i)}})},r.zb=function(){this.n.zb()},r.Xa=function(t,e,n,i){this.e("set",{path:t.toString(),value:e});var e=Q(e,n),n=Bd(this.Q,t,e,this.i.K,l),r=this.i.set(t,n),o=this;this.n.put(t.toString(),e.P(k),function(e){var n="ok"===e;Yc(o.i,r),n||(Vb("set at "+t+" failed: "+e),Wc(o.i,t),n=Ed(o,t),Fd(o,n),yd(o.Q,n.path(),[])),X(i,e)}),e=Ed(this,t),Gd(this,t),Fd(this,e),yd(this.Q,e.path(),[t])},r.update=function(t,e,n){this.e("update",{path:t.toString(),value:e});var i,r=T(this.i.Aa,t),a=k,s=[];for(i in e){var a=o,c=Q(e[i]),r=r.D(i,c);s.push(t.C(i))}if(a)Pb("update() called with empty data.  Don't do anything."),X(n,"ok");else{var r=Bd(this.Q,t,r,this.i.K,e),h=this.i.set(t,r),u=this;Sc(this.n,"m",t.toString(),e,function(e){z("ok"===e||"permission_denied"===e,"merge at "+t+" failed."),Yc(u.i,h),X(n,e)},j),e=Ed(this,t),Gd(this,t),Fd(this,e),yd(this.Q,e.path(),s)}},r.xc=function(t,e,n){this.e("setPriority",{path:t.toString(),wa:e});var i=T(this.i.K,t).ec(e),i=Bd(this.Q,t,i,this.i.K,l),r=this.i.set(t,i),o=this;this.n.put(t.toString()+"/.priority",e,function(t){Yc(o.i,r),X(n,t)}),t=Ed(this,t),Fd(this,t),yd(this.Q,t.path(),[])},r.qc=function(t,e){this.n.qc(t.toString(),function(t){X(e,t)})},r.Bb=function(t,e,n,i,r){".info"===F(t.path)?this.nc.Bb(t,e,n,i,r):this.Q.Bb(t,e,n,i,r)},r.Wb=function(t,e,n,i){if(".info"===F(t.path))this.nc.Wb(t,e,n,i);else if(e=this.Q.Wb(t,e,n,i),e!==l){for(var n=this.i,t=t.path,i=[],r=0;r<e.length;++r)i[r]=T(n.za,e[r]);for(U(n.za,t,O),r=0;r<e.length;++r)U(n.za,e[r],i[r])}},r.Ra=function(){this.n.Ra()},r.ub=function(){this.n.ub()},r.yc=function(t){if("undefined"!=typeof console){t?(this.$b||(this.$b=new jc(this.$)),t=this.$b.get()):t=this.$.get();var e,n=t,i=[],r=0;for(e in n)i[r++]=e;var o=function(t,e){return Math.max(e.length,t)};if(i.reduce)e=i.reduce(o,0);else{var a=0;lb(i,function(t){a=o.call(j,a,t)}),e=a}for(var s in t){for(n=t[s],i=s.length;e+2>i;i++)s+=" ";console.log(s+n)}}},r.e=function(){Pb("r:"+this.n.id+":",arguments)},Y.pd=function(){return Y.Nc?Y.Nc:Y.Nc=new Y},Y.prototype.Ra=function(){for(var t in this.Wa)this.Wa[t].Ra()},Y.prototype.interrupt=Y.prototype.Ra,Y.prototype.ub=function(){for(var t in this.Wa)this.Wa[t].ub()},Y.prototype.resume=Y.prototype.ub;var Z={qd:function(t){var e=P.prototype.hash;return P.prototype.hash=t,function(){P.prototype.hash=e}}};Z.hijackHash=Z.qd,Z.Ia=function(t){return t.Ia()},Z.queryIdentifier=Z.Ia,Z.sd=function(t){return t.o.n.ba},Z.listens=Z.sd,Z.xd=function(t){return t.o.n.sb},Z.refConnection=Z.xd,Z.fd=Kc,Z.DataConnection=Z.fd,Kc.prototype.sendRequest=Kc.prototype.ya,Kc.prototype.interrupt=Kc.prototype.Ra,Z.gd=Ec,Z.RealTimeConnection=Z.gd,Ec.prototype.sendRequest=Ec.prototype.wc,Ec.prototype.close=Ec.prototype.close,Z.ed=sb,Z.ConnectionTarget=Z.ed,Z.nd=function(){xc=qc=k},Z.forceLongPolling=Z.nd,Z.od=function(){yc=k},Z.forceWebSockets=Z.od,Z.Dd=function(t,e){t.o.n.vc=e},Z.setSecurityDebugCallback=Z.Dd,Z.yc=function(t,e){t.o.yc(e)},Z.stats=Z.yc,ca("fb.api.onDisconnect",$),$.prototype.cancel=function(t){A("Firebase.onDisconnect().cancel",0,1,arguments.length),C("Firebase.onDisconnect().cancel",1,t,k),this.tb.qc(this.L,t)},$.prototype.cancel=$.prototype.cancel,$.prototype.remove=function(t){A("Firebase.onDisconnect().remove",0,1,arguments.length),E("Firebase.onDisconnect().remove",this.L),C("Firebase.onDisconnect().remove",1,t,k),Hd(this.tb,this.L,l,t)},$.prototype.remove=$.prototype.remove,$.prototype.set=function(t,e){A("Firebase.onDisconnect().set",1,2,arguments.length),E("Firebase.onDisconnect().set",this.L),za("Firebase.onDisconnect().set",t,o),C("Firebase.onDisconnect().set",2,e,k),Hd(this.tb,this.L,t,e)},$.prototype.set=$.prototype.set,$.prototype.Xa=function(t,e,n){A("Firebase.onDisconnect().setWithPriority",2,3,arguments.length),E("Firebase.onDisconnect().setWithPriority",this.L),za("Firebase.onDisconnect().setWithPriority",t,o),Ea("Firebase.onDisconnect().setWithPriority",2,e,o),C("Firebase.onDisconnect().setWithPriority",3,n,k),(".length"===this.ua||".keys"===this.ua)&&g("Firebase.onDisconnect().setWithPriority failed: "+this.ua+" is a read-only object.");var i=this.tb,r=this.L,a=Q(t,e);Qc(i.n,r.toString(),a.P(k),function(t){X(n,t)})},$.prototype.setWithPriority=$.prototype.Xa,$.prototype.update=function(t,e){A("Firebase.onDisconnect().update",1,2,arguments.length),E("Firebase.onDisconnect().update",this.L),Da("Firebase.onDisconnect().update",t),C("Firebase.onDisconnect().update",2,e,k);var n,i=this.tb,r=this.L,a=k;for(n in t)a=o;a?(Pb("onDisconnect().update() called with empty data.  Don't do anything."),X(e,k)):(i=i.n,r=r.toString(),a=function(t){X(e,t)},i.S?Rc(i,"om",r,t,a):i.lb.push({uc:r,action:"om",data:t,A:a}))},$.prototype.update=$.prototype.update;var Pd,Qd=0,Rd=[];Pd=function(){var t=(new Date).getTime()+Yb,e=t===Qd;Qd=t;for(var n=Array(8),i=7;i>=0;i--)n[i]="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz".charAt(t%64),t=Math.floor(t/64);if(z(0===t),t=n.join(""),e){for(i=11;i>=0&&63===Rd[i];i--)Rd[i]=0;Rd[i]++}else for(i=0;12>i;i++)Rd[i]=Math.floor(64*Math.random());for(i=0;12>i;i++)t+="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz".charAt(Rd[i]);return z(20===t.length,"NextPushId: Length should be 20."),t},ka(W,G),ca("Firebase",W),W.prototype.name=function(){return A("Firebase.name",0,0,arguments.length),this.path.f()?l:Ma(this.path)},W.prototype.name=W.prototype.name,W.prototype.C=function(t){if(A("Firebase.child",1,1,arguments.length),ga(t))t=String(t);else if(!(t instanceof I))if(F(this.path)===l){var e=t;e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),Ha("Firebase.child",e)}else Ha("Firebase.child",t);return new W(this.o,this.path.C(t))},W.prototype.child=W.prototype.C,W.prototype.parent=function(){A("Firebase.parent",0,0,arguments.length);var t=this.path.parent();return t===l?l:new W(this.o,t)},W.prototype.parent=W.prototype.parent,W.prototype.toString=function(){A("Firebase.toString",0,0,arguments.length);var t;if(this.parent()===l)t=this.o.toString();else{t=this.parent().toString()+"/";var e=this.name();t+=encodeURIComponent(String(e))}return t},W.prototype.toString=W.prototype.toString,W.prototype.set=function(t,e){return A("Firebase.set",1,2,arguments.length),E("Firebase.set",this.path),za("Firebase.set",t,o),C("Firebase.set",2,e,k),this.o.Xa(this.path,t,l,e)},W.prototype.set=W.prototype.set,W.prototype.update=function(t,e){return A("Firebase.update",1,2,arguments.length),E("Firebase.update",this.path),Da("Firebase.update",t),C("Firebase.update",2,e,k),this.o.update(this.path,t,e)},W.prototype.update=W.prototype.update,W.prototype.Xa=function(t,e,n){return A("Firebase.setWithPriority",2,3,arguments.length),E("Firebase.setWithPriority",this.path),za("Firebase.setWithPriority",t,o),Ea("Firebase.setWithPriority",2,e,o),C("Firebase.setWithPriority",3,n,k),(".length"===this.name()||".keys"===this.name())&&g("Firebase.setWithPriority failed: "+this.name()+" is a read-only object."),this.o.Xa(this.path,t,e,n)},W.prototype.setWithPriority=W.prototype.Xa,W.prototype.remove=function(t){A("Firebase.remove",0,1,arguments.length),E("Firebase.remove",this.path),C("Firebase.remove",1,t,k),this.set(l,t)},W.prototype.remove=W.prototype.remove,W.prototype.transaction=function(t,e){function n(){}A("Firebase.transaction",1,2,arguments.length),E("Firebase.transaction",this.path),C("Firebase.transaction",1,t,o),C("Firebase.transaction",2,e,k),(".length"===this.name()||".keys"===this.name())&&g("Firebase.transaction failed: "+this.name()+" is a read-only object.");var i=this.o,r=this.path;i.e("transaction on "+r);var a=new W(i,r);a.oc("value",n);var c={path:r,update:t,A:e,Sc:Jb(),Yc:0,dc:function(){a.Ib("value",n)}},h=i.i.Aa,u=c.update(T(h,r).P());if(s(u)){Aa("transaction failed: Data returned ",u);var f=T(i.i.K,r).k();U(h,r,Q(u,f)),yd(i.Q,r,[r]),c.status=1,r=J(i.ac,r),h=r.j()||[],h.push(c),M(r,h),Ld(i)}else c.dc(),c.A&&(i=Jd(i,r),c.A(l,o,i))},W.prototype.transaction=W.prototype.transaction,W.prototype.xc=function(t,e){A("Firebase.setPriority",1,2,arguments.length),E("Firebase.setPriority",this.path),Ea("Firebase.setPriority",1,t,o),C("Firebase.setPriority",2,e,k),this.o.xc(this.path,t,e)},W.prototype.setPriority=W.prototype.xc,W.prototype.push=function(t,e){A("Firebase.push",0,2,arguments.length),E("Firebase.push",this.path),za("Firebase.push",t,k),C("Firebase.push",2,e,k);var n=Pd(),n=this.C(n);return"undefined"!=typeof t&&t!==l&&n.set(t,e),n},W.prototype.push=W.prototype.push,W.prototype.da=function(){return new $(this.o,this.path,this.name())},W.prototype.onDisconnect=W.prototype.da,W.prototype.yd=function(){Vb("FirebaseRef.removeOnDisconnect() being deprecated. Please use FirebaseRef.onDisconnect().remove() instead."),this.da().remove(),Id(this.o)},W.prototype.removeOnDisconnect=W.prototype.yd,
W.prototype.Cd=function(t){Vb("FirebaseRef.setOnDisconnect(value) being deprecated. Please use FirebaseRef.onDisconnect().set(value) instead."),this.da().set(t),Id(this.o)},W.prototype.setOnDisconnect=W.prototype.Cd,W.prototype.Za=function(e,n,i){A("Firebase.auth",1,3,arguments.length),t(e)||g(Error(B("Firebase.auth",1,o)+"must be a valid credential (a string).")),C("Firebase.auth",2,n,k),C("Firebase.auth",3,n,k),this.o.Za(e,n,i)},W.prototype.auth=W.prototype.Za,W.prototype.zb=function(){this.o.zb()},W.prototype.unauth=W.prototype.zb,W.enableLogging=Qb,W.INTERNAL=Z,W.Context=Y}();
"use strict";!function(){function e(e,i){function c(e){w.deletePeer(e)}function f(e){if(w.socketAutoReConnect=!0,w.socket)return void(e&&e(w.socket));if("undefined"==typeof n)if("undefined"!=typeof FirebaseConnection)window.SocketConnection=FirebaseConnection;else{if("undefined"==typeof PubNubConnection)throw"SocketConnection.js seems missed.";window.SocketConnection=PubNubConnection}new n(w,function(n){e&&e(w.socket)})}function l(e,n){w.closeBeforeUnload&&(w.isInitiator===!0&&w.dontMakeMeModerator(),w.peers.getAllParticipants().forEach(function(e){S.onNegotiationNeeded({userLeft:!0},e),w.peers[e]&&w.peers[e].peer&&w.peers[e].peer.close(),delete w.peers[e]}),n||w.closeSocket(),w.broadcasters=[],w.isInitiator=!1)}function v(e,n){return e?(n.audio&&e.getAudioTracks().forEach(function(e){e.applyConstraints(n.audio)}),void(n.video&&e.getVideoTracks().forEach(function(e){e.applyConstraints(n.video)}))):void(w.enableLogs&&console.error("No stream to applyConstraints."))}function g(e,n,t){return n?void S.replaceTrack(e,n,t):void w.peers.getAllParticipants().forEach(function(n){S.replaceTrack(e,n,t)})}function h(){if(w.isInitiator&&!w.session.oneway&&!w.session.broadcast&&"many-to-many"===w.direction){var e=w.broadcasters[0],n=[];w.broadcasters.forEach(function(t){t!==e&&n.push(t)}),w.autoCloseEntireSession||w.shiftModerationControl(e,n,!0)}}i=i||{};var w=this;w.channel=w.sessionid=(e||location.href.replace(/\/|:|#|\?|\$|\^|%|\.|`|~|!|\+|@|\[|\||]|\|*. /g,"").split("\n").join("").split("\r").join(""))+"";var S=new t(w);S.onGettingLocalMedia=function(e){e.type="local",w.setStreamEndHandler(e),s(e,function(n){n.id=e.streamid,n.muted=!0,n.volume=0,-1===w.attachStreams.indexOf(e)&&w.attachStreams.push(e),"undefined"!=typeof se&&se.setHandlers(e,!0,w),w.streamEvents[e.streamid]={stream:e,type:"local",mediaElement:n,userid:w.userid,extra:w.extra,streamid:e.streamid,blobURL:n.src||URL.createObjectURL(e),isAudioMuted:!0},o(w,w.streamEvents[e.streamid]),r(w,w.streamEvents[e.streamid]),w.onstream(w.streamEvents[e.streamid])},w)},S.onGettingRemoteMedia=function(e,n){e.type="remote",w.setStreamEndHandler(e,"remote-stream"),s(e,function(t){t.id=e.streamid,"undefined"!=typeof se&&se.setHandlers(e,!1,w),w.streamEvents[e.streamid]={stream:e,type:"remote",userid:n,extra:w.peers[n]?w.peers[n].extra:{},mediaElement:t,streamid:e.streamid,blobURL:t.src||URL.createObjectURL(e)},r(w,w.streamEvents[e.streamid]),w.onstream(w.streamEvents[e.streamid])},w)},S.onRemovingRemoteMedia=function(e,n){var t=w.streamEvents[e.streamid];t||(t={stream:e,type:"remote",userid:n,extra:w.peers[n]?w.peers[n].extra:{},streamid:e.streamid,mediaElement:w.streamEvents[e.streamid]?w.streamEvents[e.streamid].mediaElement:null}),w.onstreamended(t),delete w.streamEvents[e.streamid]},S.onNegotiationNeeded=function(e,n,t){f(function(){w.socket.emit(w.socketMessageEvent,"password"in e?e:{remoteUserId:e.remoteUserId||n,message:e,sender:w.userid},t||function(){})})},S.onUserLeft=c,S.disconnectWith=function(e,n){w.socket&&w.socket.emit("disconnect-with",e,n||function(){}),w.deletePeer(e)},w.broadcasters=[],w.socketOptions={transport:"polling"},w.openOrJoin=function(e,n){w.checkPresence(e,function(t,i){if("function"==typeof n&&(n(t,i),n=null),t){w.sessionid=i;var o=!1,r=!1,a=!!w.session.oneway,s=u(w.session);r={OfferToReceiveAudio:w.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:w.sdpConstraints.mandatory.OfferToReceiveVideo},o={OfferToReceiveAudio:a?!!w.session.audio:w.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:a?!!w.session.video||!!w.session.screen:w.sdpConstraints.mandatory.OfferToReceiveVideo};var d={remoteUserId:w.sessionid,message:{newParticipationRequest:!0,isOneWay:a,isDataOnly:s,localPeerSdpConstraints:o,remotePeerSdpConstraints:r},sender:w.userid,password:n||!1};return void S.onNegotiationNeeded(d)}w.userid;w.userid=w.sessionid=e||w.sessionid,w.userid+="",w.socket.emit("changed-uuid",w.userid),n&&w.socket.emit("set-password",n),w.isInitiator=!0,u(w.session)||w.captureUserMedia()})},w.open=function(e,n){w.userid;return w.userid=w.sessionid=e||w.sessionid,w.userid+="",w.isInitiator=!0,f(function(){w.socket.emit("changed-uuid",w.userid),1==n&&w.becomePublicModerator()}),u(w.session)?void("function"==typeof n&&n()):void w.captureUserMedia("function"==typeof n?n:null)},w.becomePublicModerator=function(){w.isInitiator&&w.socket.emit("become-a-public-moderator")},w.dontMakeMeModerator=function(){w.socket.emit("dont-make-me-moderator")},w.deletePeer=function(e){if(e){if(w.onleave({userid:e,extra:w.peers[e]?w.peers[e].extra:{}}),w.peers[e]){w.peers[e].streams.forEach(function(e){e.stop()});var n=w.peers[e].peer;if(n&&"closed"!==n.iceConnectionState)try{n.close()}catch(t){}w.peers[e]&&(w.peers[e].peer=null,delete w.peers[e])}if(-1!==w.broadcasters.indexOf(e)){var i=[];w.broadcasters.forEach(function(n){n!==e&&i.push(n)}),w.broadcasters=i,h()}}},w.rejoin=function(e){if(!w.isInitiator&&e&&Object.keys(e).length){var n={};w.peers[e.remoteUserId]&&(n=w.peers[e.remoteUserId].extra,w.deletePeer(e.remoteUserId)),e&&e.remoteUserId&&(w.join(e.remoteUserId),w.onReConnecting({userid:e.remoteUserId,extra:n}))}},w.join=w.connect=function(e,n){w.sessionid=(e?e.sessionid||e.remoteUserId||e:!1)||w.sessionid,w.sessionid+="";var t=!1,i=!1,o=!1,r=!1;if(e&&e.session||!e||"string"==typeof e){var a=e?e.session||w.session:w.session;o=!!a.oneway,r=u(a),i={OfferToReceiveAudio:w.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:w.sdpConstraints.mandatory.OfferToReceiveVideo},t={OfferToReceiveAudio:o?!!w.session.audio:w.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:o?!!w.session.video||!!w.session.screen:w.sdpConstraints.mandatory.OfferToReceiveVideo}}n=n||{};var s=function(){};"function"==typeof n&&(s=n,n={}),"undefined"!=typeof n.localPeerSdpConstraints&&(t=n.localPeerSdpConstraints),"undefined"!=typeof n.remotePeerSdpConstraints&&(i=n.remotePeerSdpConstraints),"undefined"!=typeof n.isOneWay&&(o=n.isOneWay),"undefined"!=typeof n.isDataOnly&&(r=n.isDataOnly);var d={remoteUserId:w.sessionid,message:{newParticipationRequest:!0,isOneWay:o,isDataOnly:r,localPeerSdpConstraints:t,remotePeerSdpConstraints:i},sender:w.userid,password:!1};return f(function(){w.peers[w.sessionid]||(S.onNegotiationNeeded(d),s())}),d},w.connectWithAllParticipants=function(e){S.onNegotiationNeeded("connectWithAllParticipants",e||w.sessionid)},w.removeFromBroadcastersList=function(e){S.onNegotiationNeeded("removeFromBroadcastersList",e||w.sessionid),w.peers.getAllParticipants(e||w.sessionid).forEach(function(e){S.onNegotiationNeeded("dropPeerConnection",e),w.deletePeer(e)}),w.attachStreams.forEach(function(e){e.stop()})},w.getUserMedia=w.captureUserMedia=function(e,n){return n=n||w.session,w.dontCaptureUserMedia||u(n)?void(e&&e()):void((n.audio||n.video||n.screen)&&(n.screen?w.getScreenConstraints(function(e,t){if(e)throw e;w.invokeGetUserMedia({audio:m(w)?p(t):!1,video:t,isScreen:!0},function(){if((n.audio||n.video)&&!m(w)){var e={};for(var t in n)"screen"!==t&&(e[t]=n[t]);w.invokeGetUserMedia(null,null,e)}})}):(n.audio||n.video)&&w.invokeGetUserMedia()))},w.closeBeforeUnload=!0,window.addEventListener("beforeunload",l,!1),w.userid=a(),w.changeUserId=function(e,n){w.userid=e||a(),w.socket.emit("changed-uuid",w.userid,n||function(){})},w.extra={},w.attachStreams=[],w.session={audio:!0,video:!0},w.enableFileSharing=!1,w.bandwidth={screen:512,audio:128,video:512},w.codecs={audio:"opus",video:"VP9"},w.processSdp=function(e){return V||I?e:(e=X.setApplicationSpecificBandwidth(e,w.bandwidth,!!w.session.screen),e=X.setVideoBitrates(e,{min:8*w.bandwidth.video*1024,max:8*w.bandwidth.video*1024}),e=X.setOpusAttributes(e,{maxaveragebitrate:8*w.bandwidth.audio*1024,maxplaybackrate:8*w.bandwidth.audio*1024,stereo:1,maxptime:3}),"VP9"===w.codecs.video&&(e=X.preferVP9(e)),"H264"===w.codecs.video&&(e=X.removeVPX(e)),"G722"===w.codecs.audio&&(e=X.removeNonG722(e)),e)},"undefined"!=typeof X&&(w.BandwidthHandler=w.CodecsHandler=X),w.mediaConstraints={audio:{mandatory:{},optional:[{bandwidth:8*w.bandwidth.audio*1024||1048576}]},video:{mandatory:{},optional:[{bandwidth:8*w.bandwidth.video*1024||1048576},{facingMode:"user"}]}},I&&(w.mediaConstraints={audio:!0,video:!0}),i.useDefaultDevices||V||DetectRTC.load(function(){var e,n;if(DetectRTC.MediaDevices.forEach(function(t){"audioinput"===t.kind&&w.mediaConstraints.audio!==!1&&(e=t),"videoinput"===t.kind&&w.mediaConstraints.video!==!1&&(n=t)}),e){if(I)return void(w.mediaConstraints.audio!==!0?w.mediaConstraints.audio.deviceId=e.id:w.mediaConstraints.audio={deviceId:e.id});1==w.mediaConstraints.audio&&(w.mediaConstraints.audio={mandatory:{},optional:[]}),w.mediaConstraints.audio.optional||(w.mediaConstraints.audio.optional=[]);var t=[{sourceId:e.id}];w.mediaConstraints.audio.optional=t.concat(w.mediaConstraints.audio.optional)}if(n){if(I)return void(w.mediaConstraints.video!==!0?w.mediaConstraints.video.deviceId=n.id:w.mediaConstraints.video={deviceId:n.id});1==w.mediaConstraints.video&&(w.mediaConstraints.video={mandatory:{},optional:[]}),w.mediaConstraints.video.optional||(w.mediaConstraints.video.optional=[]);var t=[{sourceId:n.id}];w.mediaConstraints.video.optional=t.concat(w.mediaConstraints.video.optional)}}),w.sdpConstraints={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0},optional:[{VoiceActivityDetection:!1}]},w.optionalArgument={optional:[{DtlsSrtpKeyAgreement:!0},{googImprovedWifiBwe:!0},{googScreencastMinBitrate:300},{googIPv6:!0},{googDscp:!0},{googCpuUnderuseThreshold:55},{googCpuOveruseThreshold:85},{googSuspendBelowMinBitrate:!0},{googCpuOveruseDetection:!0}],mandatory:{}},w.iceServers=K.getIceServers(w),w.candidates={host:!0,stun:!0,turn:!0},w.iceProtocols={tcp:!0,udp:!0},w.onopen=function(e){w.enableLogs&&console.info("Data connection has been opened between you & ",e.userid)},w.onclose=function(e){w.enableLogs&&console.warn("Data connection has been closed between you & ",e.userid)},w.onerror=function(e){w.enableLogs&&console.error(e.userid,"data-error",e)},w.onmessage=function(e){w.enableLogs&&console.debug("data-message",e.userid,e.data)},w.send=function(e,n){w.peers.send(e,n)},w.close=w.disconnect=w.leave=function(){l(!1,!0)},w.closeEntireSession=function(e){e=e||function(){},w.socket.emit("close-entire-session",function n(){return w.getAllParticipants().length?void setTimeout(n,100):(w.onEntireSessionClosed({sessionid:w.sessionid,userid:w.userid,extra:w.extra}),void w.changeUserId(null,function(){w.close(),e()}))})},w.onEntireSessionClosed=function(e){w.enableLogs&&console.info("Entire session is closed: ",e.sessionid,e.extra)},w.onstream=function(e){var n=w.videosContainer;n.insertBefore(e.mediaElement,n.firstChild),e.mediaElement.play(),setTimeout(function(){e.mediaElement.play()},5e3)},w.onstreamended=function(e){e.mediaElement||(e.mediaElement=document.getElementById(e.streamid)),e.mediaElement&&e.mediaElement.parentNode&&e.mediaElement.parentNode.removeChild(e.mediaElement)},w.direction="many-to-many",w.removeStream=function(e){var n;return w.attachStreams.forEach(function(t){t.id===e&&(n=t)}),n?(w.peers.getAllParticipants().forEach(function(e){var t=w.peers[e];try{t.peer.removeStream(n)}catch(i){}}),void w.renegotiate()):void console.warn("No such stream exists.",e)},w.addStream=function(e,n){function t(t){e.streamCallback&&e.streamCallback(t),w.renegotiate(n)}return e.getAudioTracks?(-1===w.attachStreams.indexOf(e)&&(e.streamid||(e.streamid=e.id),w.attachStreams.push(e)),void w.renegotiate(n)):u(e)?void w.renegotiate(n):void((e.audio||e.video||e.screen)&&(e.screen?w.getScreenConstraints(function(n,i){return n?alert(n):void w.invokeGetUserMedia({audio:m(w)?p(i):!1,video:i,isScreen:!0},!e.audio&&!e.video||m(w)?t:w.invokeGetUserMedia(null,t))}):(e.audio||e.video)&&w.invokeGetUserMedia(null,t)))},w.invokeGetUserMedia=function(e,n,t){if(t||(t=w.session),e instanceof q)throw e;T({onGettingLocalMedia:function(t){var i=e?e.video:w.mediaConstraints;i&&(i.mediaSource||i.mozMediaSource?t.isScreen=!0:i.mandatory&&i.mandatory.chromeMediaSource&&(t.isScreen=!0)),t.isScreen||(t.isVideo=t.getVideoTracks().length,t.isAudio=!t.isVideo&&t.getAudioTracks().length),S.onGettingLocalMedia(t),n&&n(t)},onLocalMediaError:function(e,n){S.onLocalMediaError(e,n)},localMediaConstraints:e||{audio:t.audio?w.mediaConstraints.audio:!1,video:t.video?w.mediaConstraints.video:!1}})},w.applyConstraints=function(e,n){if(!_||!_.prototype.applyConstraints)return void alert("track.applyConstraints is NOT supported in your browser.");if(n){var t;return w.streamEvents[n]&&(t=w.streamEvents[n].stream),void v(t,e)}w.attachStreams.forEach(function(n){v(n,e)})},w.replaceTrack=function(e,n,t){function i(i){w.replaceTrack(i,n,t||e.video||e.screen)}if(e=e||{},!j.prototype.getSenders)return void w.addStream(e);if(e instanceof _)return void g(e,n,t);if(e instanceof q)return e.getVideoTracks().length&&g(e.getVideoTracks()[0],n,!0),void(e.getAudioTracks().length&&g(e.getAudioTracks()[0],n,!1));if(u(e))throw"connection.replaceTrack requires audio and/or video and/or screen.";(e.audio||e.video||e.screen)&&(e.screen?w.getScreenConstraints(function(n,t){return n?alert(n):void w.invokeGetUserMedia({audio:m(w)?p(t):!1,video:t,isScreen:!0},!e.audio&&!e.video||m(w)?i:w.invokeGetUserMedia(null,i))}):(e.audio||e.video)&&w.invokeGetUserMedia(null,i))},w.resetTrack=function(e,n){e||(e=w.getAllParticipants()),"string"==typeof e&&(e=[e]),e.forEach(function(e){var t=w.peers[e].peer;"undefined"!=typeof n&&n!==!0||!t.lastVideoTrack||w.replaceTrack(t.lastVideoTrack,e,!0),"undefined"!=typeof n&&n!==!1||!t.lastAudioTrack||w.replaceTrack(t.lastAudioTrack,e,!1)})},w.renegotiate=function(e){return e?void S.renegotiatePeer(e):void w.peers.getAllParticipants().forEach(function(e){S.renegotiatePeer(e)})},w.setStreamEndHandler=function(e,n){e&&e.addEventListener&&(n=!!n,e.alreadySetEndHandler||(e.alreadySetEndHandler=!0,e.addEventListener("ended",function(){e.idInstance&&ae.remove(e.idInstance),n||delete w.attachStreams[w.attachStreams.indexOf(e)];var t=w.streamEvents[e.streamid];t||(t={stream:e,streamid:e.streamid,type:n?"remote":"local",userid:w.userid,extra:w.extra,mediaElement:w.streamEvents[e.streamid]?w.streamEvents[e.streamid].mediaElement:null}),t.userid===w.userid&&"remote"===t.type||(w.onstreamended(t),delete w.streamEvents[e.streamid])},!1)))},w.onMediaError=function(e,n){w.enableLogs&&console.error(e,n)},w.addNewBroadcaster=function(e,n){w.broadcasters.length&&setTimeout(function(){S.connectNewParticipantWithAllBroadcasters(e,n,w.broadcasters.join("|-,-|"))},1e4),w.session.oneway||w.session.broadcast||"many-to-many"!==w.direction||-1!==w.broadcasters.indexOf(e)||(w.broadcasters.push(e),h())},w.autoCloseEntireSession=!1,w.filesContainer=w.videosContainer=document.body||document.documentElement,w.isInitiator=!1,w.shareFile=S.shareFile,"undefined"!=typeof le&&le.handle(w),"undefined"!=typeof me&&me.handle(w),w.token=a,w.onNewParticipant=function(e,n){w.acceptParticipationRequest(e,n)},w.acceptParticipationRequest=function(e,n){n.successCallback&&(n.successCallback(),delete n.successCallback),S.createNewPeer(e,n)},w.onShiftedModerationControl=function(e,n){w.acceptModerationControl(e,n)},w.acceptModerationControl=function(e,n){w.isInitiator=!0,w.broadcasters=n,w.peers.getAllParticipants().forEach(function(n){S.onNegotiationNeeded({changedUUID:e,oldUUID:w.userid,newUUID:e},n)}),w.userid=e,w.socket.emit("changed-uuid",w.userid)},w.shiftModerationControl=function(e,n,t){S.onNegotiationNeeded({shiftedModerationControl:!0,broadcasters:n,firedOnLeave:!!t},e)},"undefined"!=typeof se&&(w.StreamsHandler=se),w.onleave=function(e){},w.invokeSelectFileDialog=function(e){var n=new FileSelector;n.selectSingleFile(e)},w.getPublicModerators=function(e,n){"function"==typeof e&&(n=e),f(function(){w.socket.emit("get-public-moderators","string"==typeof e?e:"",n)})},w.onmute=function(e){e&&e.mediaElement&&("both"===e.muteType||"video"===e.muteType?(e.mediaElement.src=null,e.mediaElement.pause(),e.mediaElement.poster=e.snapshot||"https://cdn.webrtc-experiment.com/images/muted.png"):"audio"===e.muteType&&(e.mediaElement.muted=!0))},w.onunmute=function(e){e&&e.mediaElement&&e.stream&&("both"===e.unmuteType||"video"===e.unmuteType?(e.mediaElement.poster=null,e.mediaElement.src=URL.createObjectURL(e.stream),e.mediaElement.play()):"audio"===e.unmuteType&&(e.mediaElement.muted=!1))},w.onExtraDataUpdated=function(e){e.status="online",w.onUserStatusChanged(e,!0)},w.onJoinWithPassword=function(e){console.warn(e,"is password protected. Please join with password.")},w.onInvalidPassword=function(e,n){console.warn(e,"is password protected. Please join with valid password. Your old password",n,"is wrong.")},w.onPasswordMaxTriesOver=function(e){console.warn(e,"is password protected. Your max password tries exceeded the limit.")},w.getAllParticipants=function(e){return w.peers.getAllParticipants(e)},"undefined"!=typeof se&&(se.onSyncNeeded=function(e,n,t){w.peers.getAllParticipants().forEach(function(i){S.onNegotiationNeeded({streamid:e,action:n,streamSyncNeeded:!0,type:t||"both"},i)})}),w.connectSocket=function(e){f(e)},w.socketAutoReConnect=!0,w.closeSocket=function(){try{io.sockets={}}catch(e){}w.socket&&(w.socketAutoReConnect=!1,"function"==typeof w.socket.disconnect&&w.socket.disconnect(),w.socket=null)},w.getSocket=function(e){return w.socket?e&&e(w.socket):f(e),w.socket},w.getRemoteStreams=S.getRemoteStreams;var C=["selectFirst","selectAll","forEach"];if(w.streamEvents={selectFirst:function(e){if(!e){var n;for(var t in w.streamEvents)-1!==C.indexOf(t)||n||(n=w.streamEvents[t]);return n}},selectAll:function(){}},w.socketURL="/",w.socketMessageEvent="RTCMultiConnection-Message",w.socketCustomEvent="RTCMultiConnection-Custom-Message",w.DetectRTC=DetectRTC,w.onUserStatusChanged=function(e,n){w.enableLogs&&!n&&console.info(e.userid,e.status)},w.getUserMediaHandler=T,w.multiPeersHandler=S,w.enableLogs=!0,w.setCustomSocketHandler=function(e){"undefined"!=typeof n&&(n=e)},w.chunkSize=65e3,w.maxParticipantsAllowed=1e3,w.disconnectWith=S.disconnectWith,w.checkPresence=function(e,n){return w.socket?void w.socket.emit("check-presence",(e||w.sessionid)+"",n):void w.connectSocket(function(){w.checkPresence(e,n)})},w.onReadyForOffer=function(e,n){w.multiPeersHandler.createNewPeer(e,n)},w.setUserPreferences=function(e){return w.dontAttachStream&&(e.dontAttachLocalStream=!0),w.dontGetRemoteStream&&(e.dontGetRemoteStream=!0),e},w.updateExtraData=function(){w.socket.emit("extra-data-updated",w.extra)},w.enableScalableBroadcast=!1,w.maxRelayLimitPerUser=3,w.dontCaptureUserMedia=!1,w.dontAttachStream=!1,w.dontGetRemoteStream=!1,w.onReConnecting=function(e){w.enableLogs&&console.info("ReConnecting with",e.userid,"...")},w.beforeAddingStream=function(e){return e},w.beforeRemovingStream=function(e){return e},"undefined"!=typeof x&&(w.checkIfChromeExtensionAvailable=x),"undefined"!=typeof R&&(w.checkIfChromeExtensionAvailable=R),"undefined"!=typeof O&&(w.getChromeExtensionStatus=O),w.getScreenConstraints=function(e,n){m(w,n)&&(n=!0),M(function(n,t){n||(t=w.modifyScreenConstraints(t),e(n,t))},n)},w.modifyScreenConstraints=function(e){return e},w.onPeerStateChanged=function(e){w.enableLogs&&-1!==e.iceConnectionState.search(/closed|failed/gi)&&console.error("Peer connection is closed between you & ",e.userid,e.extra,"state:",e.iceConnectionState)},w.isOnline=!0,d("online",function(){w.isOnline=!0}),d("offline",function(){w.isOnline=!1}),w.isLowBandwidth=!1,navigator&&navigator.connection&&navigator.connection.type&&(w.isLowBandwidth=-1!==navigator.connection.type.toString().toLowerCase().search(/wifi|cell/g),w.isLowBandwidth)){if(w.bandwidth={audio:30,video:30,screen:30},w.mediaConstraints.audio&&w.mediaConstraints.audio.optional&&w.mediaConstraints.audio.optional.length){var y=[];w.mediaConstraints.audio.optional.forEach(function(e){"undefined"==typeof e.bandwidth&&y.push(e)}),w.mediaConstraints.audio.optional=y}if(w.mediaConstraints.video&&w.mediaConstraints.video.optional&&w.mediaConstraints.video.optional.length){var y=[];w.mediaConstraints.video.optional.forEach(function(e){"undefined"==typeof e.bandwidth&&y.push(e)}),w.mediaConstraints.video.optional=y}}w.getExtraData=function(e){if(!e)throw"remoteUserId is required.";return w.peers[e]?w.peers[e].extra:{}},i.autoOpenOrJoin&&w.openOrJoin(w.sessionid),w.onUserIdAlreadyTaken=function(e,n){w.enableLogs&&console.warn("Userid already taken.",e,"Your new userid:",n),w.join(e)},w.trickleIce=!0}function n(e,n){var t="";t+="?userid="+e.userid,t+="&msgEvent="+e.socketMessageEvent,t+="&socketCustomEvent="+e.socketCustomEvent,e.enableScalableBroadcast&&(t+="&enableScalableBroadcast=true",t+="&maxRelayLimitPerUser="+(e.maxRelayLimitPerUser||2));try{io.sockets={}}catch(i){}try{e.socket=io((e.socketURL||"/")+t)}catch(i){e.socket=io.connect((e.socketURL||"/")+t,e.socketOptions)}var o=e.multiPeersHandler;e.socket.on("extra-data-updated",function(n,t){e.peers[n]&&(e.peers[n].extra=t,e.onExtraDataUpdated({userid:n,extra:t}))}),e.socket.on(e.socketMessageEvent,function(n){if(n.remoteUserId==e.userid){if(e.peers[n.sender]&&e.peers[n.sender].extra!=n.extra&&(e.peers[n.sender].extra=n.extra,e.onExtraDataUpdated({userid:n.sender,extra:n.extra})),n.message.streamSyncNeeded&&e.peers[n.sender]){var t=e.streamEvents[n.message.streamid];if(!t||!t.stream)return;var i=n.message.action;if("ended"===i||"stream-removed"===i)return void e.onstreamended(t);var r="both"!=n.message.type?n.message.type:null;return void t.stream[i](r)}if("connectWithAllParticipants"===n.message)return-1===e.broadcasters.indexOf(n.sender)&&e.broadcasters.push(n.sender),void o.onNegotiationNeeded({allParticipants:e.getAllParticipants(n.sender)},n.sender);if("removeFromBroadcastersList"===n.message)return void(-1!==e.broadcasters.indexOf(n.sender)&&(delete e.broadcasters[e.broadcasters.indexOf(n.sender)],e.broadcasters=c(e.broadcasters)));if("dropPeerConnection"===n.message)return void e.deletePeer(n.sender);if(n.message.allParticipants)return-1===n.message.allParticipants.indexOf(n.sender)&&n.message.allParticipants.push(n.sender),void n.message.allParticipants.forEach(function(n){o[e.peers[n]?"renegotiatePeer":"createNewPeer"](n,{localPeerSdpConstraints:{OfferToReceiveAudio:e.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:e.sdpConstraints.mandatory.OfferToReceiveVideo},remotePeerSdpConstraints:{OfferToReceiveAudio:e.session.oneway?!!e.session.audio:e.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:e.session.oneway?!!e.session.video||!!e.session.screen:e.sdpConstraints.mandatory.OfferToReceiveVideo},isOneWay:!!e.session.oneway||"one-way"===e.direction,isDataOnly:u(e.session)})});if(n.message.newParticipant){if(n.message.newParticipant==e.userid)return;if(e.peers[n.message.newParticipant])return;return void o.createNewPeer(n.message.newParticipant,n.message.userPreferences||{localPeerSdpConstraints:{OfferToReceiveAudio:e.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:e.sdpConstraints.mandatory.OfferToReceiveVideo},remotePeerSdpConstraints:{OfferToReceiveAudio:e.session.oneway?!!e.session.audio:e.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:e.session.oneway?!!e.session.video||!!e.session.screen:e.sdpConstraints.mandatory.OfferToReceiveVideo},isOneWay:!!e.session.oneway||"one-way"===e.direction,isDataOnly:u(e.session)})}if((n.message.readyForOffer||n.message.addMeAsBroadcaster)&&e.addNewBroadcaster(n.sender),n.message.newParticipationRequest&&n.sender!==e.userid){e.peers[n.sender]&&e.deletePeer(n.sender);var a={extra:n.extra||{},localPeerSdpConstraints:n.message.remotePeerSdpConstraints||{OfferToReceiveAudio:e.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:e.sdpConstraints.mandatory.OfferToReceiveVideo},remotePeerSdpConstraints:n.message.localPeerSdpConstraints||{OfferToReceiveAudio:e.session.oneway?!!e.session.audio:e.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:e.session.oneway?!!e.session.video||!!e.session.screen:e.sdpConstraints.mandatory.OfferToReceiveVideo},isOneWay:"undefined"!=typeof n.message.isOneWay?n.message.isOneWay:!!e.session.oneway||"one-way"===e.direction,isDataOnly:"undefined"!=typeof n.message.isDataOnly?n.message.isDataOnly:u(e.session),dontGetRemoteStream:"undefined"!=typeof n.message.isOneWay?n.message.isOneWay:!!e.session.oneway||"one-way"===e.direction,dontAttachLocalStream:!!n.message.dontGetRemoteStream,connectionDescription:n,successCallback:function(){("undefined"!=typeof n.message.isOneWay?n.message.isOneWay:!!e.session.oneway||"one-way"===e.direction)&&e.addNewBroadcaster(n.sender,a),(e.session.oneway||"one-way"===e.direction||u(e.session))&&e.addNewBroadcaster(n.sender,a)}};return void e.onNewParticipant(n.sender,a)}return n.message.shiftedModerationControl?void e.onShiftedModerationControl(n.sender,n.message.broadcasters):(n.message.changedUUID&&e.peers[n.message.oldUUID]&&(e.peers[n.message.newUUID]=e.peers[n.message.oldUUID],delete e.peers[n.message.oldUUID]),n.message.userLeft?(o.onUserLeft(n.sender),void(n.message.autoCloseEntireSession&&e.leave())):void o.addNegotiatedMessage(n.message,n.sender))}}),e.socket.on("user-left",function(n){onUserLeft(n),e.onUserStatusChanged({userid:n,status:"offline",extra:e.peers[n]?e.peers[n].extra||{}:{}}),e.onleave({userid:n,extra:{}})}),e.socket.on("connect",function(){return e.socketAutoReConnect?(e.enableLogs&&console.info("socket.io connection is opened."),e.socket.emit("extra-data-updated",e.extra),void(n&&n(e.socket))):void(e.socket=null)}),e.socket.on("disconnect",function(){return e.socketAutoReConnect?void(e.enableLogs&&(console.info("socket.io connection is closed"),console.warn("socket.io reconnecting"))):void(e.socket=null)}),e.socket.on("join-with-password",function(n){e.onJoinWithPassword(n)}),e.socket.on("invalid-password",function(n,t){e.onInvalidPassword(n,t)}),e.socket.on("password-max-tries-over",function(n){e.onPasswordMaxTriesOver(n)}),e.socket.on("user-disconnected",function(n){n!==e.userid&&(e.onUserStatusChanged({userid:n,status:"offline",extra:e.peers[n]?e.peers[n].extra||{}:{}}),e.deletePeer(n))}),e.socket.on("user-connected",function(n){n!==e.userid&&e.onUserStatusChanged({userid:n,status:"online",extra:e.peers[n]?e.peers[n].extra||{}:{}})}),e.socket.on("closed-entire-session",function(n,t){e.leave(),e.onEntireSessionClosed({sessionid:n,userid:n,extra:t})}),e.socket.on("userid-already-taken",function(n,t){e.isInitiator=!1,e.userid=t,e.onUserIdAlreadyTaken(n,t)}),e.socket.on("logs",function(n){e.enableLogs&&console.debug("server-logs",n)})}function t(e){function n(n,t,o){var r={};e.attachStreams.forEach(function(e){r[e.streamid]={isAudio:!!e.isAudio,isVideo:!!e.isVideo,isScreen:!!e.isScreen}}),t.userPreferences.streamsToShare=r,i.onNegotiationNeeded({readyForOffer:!0,userPreferences:t.userPreferences},o)}function t(){r=new FileBufferReader,r.onProgress=function(n){e.onFileProgress(n)},r.onBegin=function(n){e.onFileStart(n)},r.onEnd=function(n){e.onFileEnd(n)}}var i=this,o=["getAllParticipants","getLength","selectFirst","streams","send","forEach"];e.peers={getLength:function(){var e=0;for(var n in this)-1==o.indexOf(n)&&e++;return e},selectFirst:function(){var e;for(var n in this)-1==o.indexOf(n)&&(e=this[n]);return e},getAllParticipants:function(e){var n=[];for(var t in this)-1==o.indexOf(t)&&t!=e&&n.push(t);return n},forEach:function(n){this.getAllParticipants().forEach(function(t){n(e.peers[t])})},send:function(n,t){var o=this;if(!f(n.size)&&!f(n.type))return void i.shareFile(n,t);if(!("text"===n.type||n instanceof ArrayBuffer||n instanceof DataView))return void fe.send({text:n,channel:this,connection:e,remoteUserId:t});if("text"===n.type&&(n=JSON.stringify(n)),t){var r=e.peers[t];if(r)return r.channels.length?void r.channels.forEach(function(e){e.send(n)}):(e.peers[t].createDataChannel(),e.renegotiate(t),void setTimeout(function(){o.send(n,t)},3e3))}this.getAllParticipants().forEach(function(t){return o[t].channels.length?void o[t].channels.forEach(function(e){e.send(n)}):(e.peers[t].createDataChannel(),e.renegotiate(t),void setTimeout(function(){o[t].channels.forEach(function(e){e.send(n)})},3e3))})}},this.uuid=e.userid,this.getLocalConfig=function(n,o,a){return a||(a={}),{streamsToShare:a.streamsToShare||{},rtcMultiConnection:e,connectionDescription:a.connectionDescription,userid:o,localPeerSdpConstraints:a.localPeerSdpConstraints,remotePeerSdpConstraints:a.remotePeerSdpConstraints,dontGetRemoteStream:!!a.dontGetRemoteStream,dontAttachLocalStream:!!a.dontAttachLocalStream,renegotiatingPeer:!!a.renegotiatingPeer,peerRef:a.peerRef,channels:a.channels||[],onLocalSdp:function(e){i.onNegotiationNeeded(e,o)},onLocalCandidate:function(n){n=Y.processCandidates(e,n),n&&i.onNegotiationNeeded(n,o)},remoteSdp:n,onDataChannelMessage:function(n){if(!r&&e.enableFileSharing&&t(),"string"==typeof n||!e.enableFileSharing)return void i.onDataChannelMessage(n,o);var a=this;return n instanceof ArrayBuffer||n instanceof DataView?void r.convertToObject(n,function(e){a.onDataChannelMessage(e)}):n.readyForNextChunk?void r.getNextChunk(n.uuid,function(n,t){e.peers[o].channels.forEach(function(e){e.send(n)})},o):void r.addChunk(n,function(n){e.peers[o].peer.channel.send(n)})},onDataChannelError:function(e){i.onDataChannelError(e,o)},onDataChannelOpened:function(e){i.onDataChannelOpened(e,o)},onDataChannelClosed:function(e){i.onDataChannelClosed(e,o)},onRemoteStream:function(n){if(e.peers[o].streams.push(n),W&&window.PluginRTC){var t=document.createElement("video"),r=e.videosContainer;return r.insertBefore(t,r.firstChild),void setTimeout(function(){window.PluginRTC.attachMediaStream(t,n)},3e3)}i.onGettingRemoteMedia(n,o)},onRemoteStreamRemoved:function(e){i.onRemovingRemoteMedia(e,o)},onPeerStateChanged:function(e){i.onPeerStateChanged(e),"new"===e.iceConnectionState&&i.onNegotiationStarted(o,e),"connected"===e.iceConnectionState&&i.onNegotiationCompleted(o,e),-1!==e.iceConnectionState.search(/closed|failed/gi)&&(i.onUserLeft(o),i.disconnectWith(o))}}},this.createNewPeer=function(n,t){if(!(e.maxParticipantsAllowed<=e.getAllParticipants().length)){if(t=t||{},e.isInitiator&&e.session.audio&&"two-way"===e.session.audio&&!t.streamsToShare&&(t.isOneWay=!1,t.isDataOnly=!1,t.session=e.session),!t.isOneWay&&!t.isDataOnly)return t.isOneWay=!0,void this.onNegotiationNeeded({enableMedia:!0,userPreferences:t},n);t=e.setUserPreferences(t,n);var i=this.getLocalConfig(null,n,t);e.peers[n]=new h(i)}},this.createAnsweringPeer=function(n,t,i){i=e.setUserPreferences(i||{},t);var o=this.getLocalConfig(n,t,i);e.peers[t]=new h(o)},this.renegotiatePeer=function(n,t,i){if(!e.peers[n])return void(e.enableLogs&&console.error("This peer ("+n+") does not exists. Renegotiation skipped."));t||(t={}),t.renegotiatingPeer=!0,t.peerRef=e.peers[n].peer,t.channels=e.peers[n].channels;var o=this.getLocalConfig(i,n,t);e.peers[n]=new h(o)},this.replaceTrack=function(n,t,i){if(!e.peers[t])throw"This peer ("+t+") does not exists.";var o=e.peers[t].peer;return o.getSenders&&"function"==typeof o.getSenders&&o.getSenders().length?void o.getSenders().forEach(function(o){i&&o.track instanceof VideoStreamTrack&&(e.peers[t].peer.lastVideoTrack=o.track,o.replaceTrack(n)),!i&&o.track instanceof AudioStreamTrack&&(e.peers[t].peer.lastAudioTrack=o.track,o.replaceTrack(n))}):(console.warn("RTPSender.replaceTrack is NOT supported."),void this.renegotiatePeer(t))},this.onNegotiationNeeded=function(e,n){},this.addNegotiatedMessage=function(t,o){function r(e){n(e,t,o)}if(t.type&&t.sdp)return"answer"==t.type&&e.peers[o]&&e.peers[o].addRemoteSdp(t),"offer"==t.type&&(t.renegotiatingPeer?this.renegotiatePeer(o,null,t):this.createAnsweringPeer(t,o)),void(e.enableLogs&&console.log("Remote peer's sdp:",t.sdp));if(t.candidate)return e.peers[o]&&e.peers[o].addRemoteCandidate(t),void(e.enableLogs&&console.log("Remote peer's candidate pairs:",t.candidate));if(t.enableMedia){if(e.attachStreams.length||e.dontCaptureUserMedia){
var a={};return e.attachStreams.forEach(function(e){a[e.streamid]={isAudio:!!e.isAudio,isVideo:!!e.isVideo,isScreen:!!e.isScreen}}),t.userPreferences.streamsToShare=a,void i.onNegotiationNeeded({readyForOffer:!0,userPreferences:t.userPreferences},o)}var s={},d=t.userPreferences;d.localPeerSdpConstraints.OfferToReceiveAudio&&(s.audio=e.mediaConstraints.audio),d.localPeerSdpConstraints.OfferToReceiveVideo&&(s.video=e.mediaConstraints.video);var c=d.session||e.session;c.oneway&&c.audio&&"two-way"===c.audio&&(c={audio:!0}),(c.audio||c.video||c.screen)&&(c.screen?e.getScreenConstraints(function(n,t){e.invokeGetUserMedia({audio:m(e)?p(t):!1,video:t,isScreen:!0},!c.audio&&!c.video||m(e)?r:e.invokeGetUserMedia(null,r))}):(c.audio||c.video)&&e.invokeGetUserMedia(null,r,c))}t.readyForOffer&&e.onReadyForOffer(o,t.userPreferences)},this.connectNewParticipantWithAllBroadcasters=function(e,n,t){if(t=t.split("|-,-|"),t.length){var o=t[0];i.onNegotiationNeeded({newParticipant:e,userPreferences:n||!1},o),delete t[0];var r=[];t.forEach(function(e){e&&r.push(e)}),setTimeout(function(){i.connectNewParticipantWithAllBroadcasters(e,n,r.join("|-,-|"))},1e4)}},this.onGettingRemoteMedia=function(e,n){},this.onRemovingRemoteMedia=function(e,n){},this.onGettingLocalMedia=function(e){},this.onLocalMediaError=function(n,t){e.onMediaError(n,t)};var r;this.shareFile=function(n,i){if(!e.enableFileSharing)throw'"connection.enableFileSharing" is false.';t(),r.readAsArrayBuffer(n,function(n){var t=e.getAllParticipants();i&&(t=[i]),t.forEach(function(t){r.getNextChunk(n,function(n){e.peers[t].channels.forEach(function(e){e.send(n)})},t)})},{userid:e.userid,chunkSize:I?15e3:e.chunkSize||0})};var a=new A(e);this.onDataChannelMessage=function(n,t){a.receive(JSON.parse(n),t,e.peers[t]?e.peers[t].extra:{})},this.onDataChannelClosed=function(n,t){n.userid=t,n.extra=e.peers[t]?e.peers[t].extra:{},e.onclose(n)},this.onDataChannelError=function(n,t){n.userid=t,event.extra=e.peers[t]?e.peers[t].extra:{},e.onerror(n)},this.onDataChannelOpened=function(n,t){return e.peers[t].channels.length?void(e.peers[t].channels=[n]):(e.peers[t].channels.push(n),void e.onopen({userid:t,extra:e.peers[t]?e.peers[t].extra:{},channel:n}))},this.onPeerStateChanged=function(n){e.onPeerStateChanged(n)},this.onNegotiationStarted=function(e,n){},this.onNegotiationCompleted=function(e,n){},this.getRemoteStreams=function(n){return n=n||e.peers.getAllParticipants()[0],e.peers[n]?e.peers[n].streams:[]},this.isPluginRTC=e.isPluginRTC=W}function i(e,n,t){if("undefined"!=typeof CustomEvent){var i={arguments:t,__exposedProps__:t},o=new CustomEvent(n,i);e.dispatchEvent(o)}}function o(e,n){if(!e||!n)throw"Both arguments are required.";if(e.onspeaking&&e.onsilence){if("undefined"==typeof hark)throw"hark.js not found.";hark(n.stream,{onspeaking:function(){e.onspeaking(n)},onsilence:function(){e.onsilence(n)},onvolumechange:function(t,i){e.onvolumechange&&e.onvolumechange(merge({volume:t,threshold:i},n))}})}}function r(e,n){n.stream&&n.stream&&n.stream.addEventListener&&(n.stream.addEventListener("mute",function(t){t=e.streamEvents[n.streamid],t.session={audio:"audio"===t.muteType,video:"video"===t.muteType},e.onmute(t)},!1),n.stream.addEventListener("unmute",function(t){t=e.streamEvents[n.streamid],t.session={audio:"audio"===t.unmuteType,video:"video"===t.unmuteType},e.onunmute(t)},!1))}function a(){if(window.crypto&&window.crypto.getRandomValues&&-1===navigator.userAgent.indexOf("Safari")){for(var e=window.crypto.getRandomValues(new Uint32Array(3)),n="",t=0,i=e.length;i>t;t++)n+=e[t].toString(36);return n}return(Math.random()*(new Date).getTime()).toString(36).replace(/\./g,"")}function s(e,n,t){var i=!1;e.getVideoTracks&&!e.getVideoTracks().length&&(i=!0);var o=document.createElement(i?"audio":"video");return W&&window.PluginRTC?(t.videosContainer.insertBefore(o,t.videosContainer.firstChild),void setTimeout(function(){window.PluginRTC.attachMediaStream(o,e),n(o)},1e3)):(o[I?"mozSrcObject":"src"]=I?e:window.URL.createObjectURL(e),o.controls=!0,I&&o.addEventListener("ended",function(){if(ae.remove(e.idInstance),"local"===e.type){se.onSyncNeeded(e.streamid,"ended"),t.attachStreams.forEach(function(n,i){e.streamid===n.streamid&&delete t.attachStreams[i]});var n=[];t.attachStreams.forEach(function(e){e&&n.push(e)}),t.attachStreams=n;var i=t.streamEvents[e.streamid];if(i)return void t.onstreamended(i);this.parentNode&&this.parentNode.removeChild(this)}},!1),o.play(),void n(o))}function d(e,n){window.removeEventListener(e,n),window.addEventListener(e,n,!1)}function c(e){var n=[];return e.forEach(function(e){e&&n.push(e)}),n}function u(e){return!e.audio&&!e.video&&!e.screen&&e.data}function f(e){return"undefined"==typeof e}function l(e){return"string"==typeof e}function m(e,n){return e.session.audio&&"two-way"===e.session.audio?!1:I&&n!==!1?!0:!L||50>B?!1:typeof n===!0?!0:"undefined"==typeof n&&e.session.audio&&e.session.screen&&!e.session.video?(n=!0,!0):!1}function p(e){return I?!0:L?{mandatory:{chromeMediaSource:e.mandatory.chromeMediaSource,chromeMediaSourceId:e.mandatory.chromeMediaSourceId}}:!1}function v(){if("iOS"===DetectRTC.osName&&"undefined"!=typeof cordova&&"undefined"!=typeof cordova.plugins&&"undefined"!=typeof cordova.plugins.iosrtc){var e=cordova.plugins.iosrtc;window.webkitRTCPeerConnection=e.RTCPeerConnection,window.RTCSessionDescription=e.RTCSessionDescription,window.RTCIceCandidate=e.RTCIceCandidate,window.MediaStream=e.MediaStream,window.MediaStreamTrack=e.MediaStreamTrack,navigator.getUserMedia=navigator.webkitGetUserMedia=e.getUserMedia,e.debug.enable("iosrtc*"),e.registerGlobals()}}function g(e){var n,t={OfferToReceiveAudio:!!e.OfferToReceiveAudio,OfferToReceiveVideo:!!e.OfferToReceiveVideo};return n={mandatory:t,optional:[{VoiceActivityDetection:!1}]},navigator.mozGetUserMedia&&G>34&&(n={OfferToReceiveAudio:!!e.OfferToReceiveAudio,OfferToReceiveVideo:!!e.OfferToReceiveVideo}),n}function h(e){function n(n){n.binaryType="arraybuffer",n.onmessage=function(n){e.onDataChannelMessage(n.data)},n.onopen=function(){e.onDataChannelOpened(n)},n.onerror=function(n){e.onDataChannelError(n)},n.onclose=function(n){e.onDataChannelClosed(n)},n.internalSend=n.send,n.send=function(e){"open"===n.readyState&&n.internalSend(e)},a.channel=n}if(!j)throw"WebRTC 1.0 (RTCPeerConnection) API are NOT available in this browser.";var t=e.rtcMultiConnection;this.extra=e.remoteSdp?e.remoteSdp.extra:t.extra,this.userid=e.userid,this.streams=[],this.channels=e.channels||[],this.connectionDescription=e.connectionDescription;var o=this;e.remoteSdp&&(this.connectionDescription=e.remoteSdp.connectionDescription);var r={};z.sdpConstraints=g({OfferToReceiveAudio:!0,OfferToReceiveVideo:!0});var a,s=!!e.renegotiatingPeer;e.remoteSdp&&(s=!!e.remoteSdp.renegotiatingPeer);var d=[];t.attachStreams.forEach(function(e){e&&d.push(e)}),a=s?e.peerRef:new j(navigator.onLine?{iceServers:t.iceServers,iceTransports:"all"}:null,window.PluginRTC?null:t.optionalArgument),a.onicecandidate=function(n){if(n.candidate)t.trickleIce&&e.onLocalCandidate({candidate:n.candidate.candidate,sdpMid:n.candidate.sdpMid,sdpMLineIndex:n.candidate.sdpMLineIndex});else if(!t.trickleIce){var i=a.localDescription;e.onLocalSdp({type:i.type,sdp:i.sdp,remotePeerSdpConstraints:e.remotePeerSdpConstraints||!1,renegotiatingPeer:!!e.renegotiatingPeer||!1,connectionDescription:o.connectionDescription,dontGetRemoteStream:!!e.dontGetRemoteStream,extra:t?t.extra:{},streamsToShare:l,isFirefoxOffered:I})}};var c=!I;e.remoteSdp&&e.remoteSdp.remotePeerSdpConstraints&&e.remoteSdp.remotePeerSdpConstraints.isFirefoxOffered&&(c=!0),d.forEach(function(n){e.remoteSdp&&e.remoteSdp.remotePeerSdpConstraints&&e.remoteSdp.remotePeerSdpConstraints.dontGetRemoteStream||e.dontAttachLocalStream||(n=t.beforeAddingStream(n),n&&(a.getLocalStreams().forEach(function(e){e.id==n.id&&(n=null)}),n&&a.addStream(n)))}),a.oniceconnectionstatechange=a.onsignalingstatechange=function(){var n=o.extra;t.peers[o.userid]&&(n=t.peers[o.userid].extra||n),a&&e.onPeerStateChanged({iceConnectionState:a.iceConnectionState,iceGatheringState:a.iceGatheringState,signalingState:a.signalingState,extra:n,userid:o.userid})};var u={OfferToReceiveAudio:!!d.length,OfferToReceiveVideo:!!d.length};e.localPeerSdpConstraints&&(u=e.localPeerSdpConstraints),z.sdpConstraints=g(u),a.onaddstream=function(n){var t={};e.remoteSdp&&e.remoteSdp.streamsToShare?t=e.remoteSdp.streamsToShare:e.streamsToShare&&(t=e.streamsToShare);var o=t[n.stream.id];o&&(n.stream.isAudio=o.isAudio,n.stream.isVideo=o.isVideo,n.stream.isScreen=o.isScreen),n.stream.streamid=n.stream.id,n.stream.stop||(n.stream.stop=function(){I&&i(this,"ended")}),r[n.stream.id]=n.stream,e.onRemoteStream(n.stream)},a.onremovestream=function(n){n.stream.streamid=n.stream.id,r[n.stream.id]&&delete r[n.stream.id],e.onRemoteStreamRemoved(n.stream)},this.addRemoteCandidate=function(e){a.addIceCandidate(new J(e))},this.addRemoteSdp=function(e,n){e.sdp=t.processSdp(e.sdp),a.setRemoteDescription(new H(e),n||function(){},function(n){t.enableLogs&&console.error(JSON.stringify(n,null,"	"),"\n",e.type,e.sdp)})};var f=!0;e.remoteSdp&&(f=!1),this.createDataChannel=function(){var e=a.createDataChannel("sctp",{});n(e)},t.session.data!==!0||s||(f?this.createDataChannel():a.ondatachannel=function(e){var t=e.channel;n(t)}),e.remoteSdp&&(e.remoteSdp.remotePeerSdpConstraints&&(u=e.remoteSdp.remotePeerSdpConstraints),z.sdpConstraints=g(u),this.addRemoteSdp(e.remoteSdp)),"two-way"!=t.session.audio&&"two-way"!=t.session.video&&"two-way"!=t.session.screen||(z.sdpConstraints=g({OfferToReceiveAudio:"two-way"==t.session.audio||e.remoteSdp&&e.remoteSdp.remotePeerSdpConstraints&&e.remoteSdp.remotePeerSdpConstraints.OfferToReceiveAudio,OfferToReceiveVideo:"two-way"==t.session.video||"two-way"==t.session.screen||e.remoteSdp&&e.remoteSdp.remotePeerSdpConstraints&&e.remoteSdp.remotePeerSdpConstraints.OfferToReceiveAudio}));var l={};a.getLocalStreams().forEach(function(e){l[e.streamid]={isAudio:!!e.isAudio,isVideo:!!e.isVideo,isScreen:!!e.isScreen}}),a[f?"createOffer":"createAnswer"](function(n){n.sdp=t.processSdp(n.sdp),a.setLocalDescription(n),t.trickleIce&&e.onLocalSdp({type:n.type,sdp:n.sdp,remotePeerSdpConstraints:e.remotePeerSdpConstraints||!1,renegotiatingPeer:!!e.renegotiatingPeer||!1,connectionDescription:o.connectionDescription,dontGetRemoteStream:!!e.dontGetRemoteStream,extra:t?t.extra:{},streamsToShare:l,isFirefoxOffered:I})},function(e){t.enableLogs&&console.error("sdp-error",e)},z.sdpConstraints),a.nativeClose=a.close,a.close=function(){if(a){try{-1===a.iceConnectionState.search(/closed|failed/gi)&&a.getRemoteStreams().forEach(function(e){e.stop()}),a.nativeClose()}catch(e){}a=null,o.peer=null}},this.peer=a}function w(e,n){if(!$){if(!n)return w(e,!0);$=!0;var t=document.createElement("iframe");t.onload=function(){function n(t){t.data&&t.data.iceServers&&(e(t.data.iceServers),window.removeEventListener("message",n))}t.isLoaded=!0,d("message",n),t.contentWindow.postMessage("get-ice-servers","*")},t.src="https://cdn.webrtc-experiment.com/getIceServers/",t.style.display="none",(document.body||document.documentElement).appendChild(t)}}function S(e){var n="urls";W&&(n="url");var t={};return t[n]=e,t}function C(e,n,t){var i="urls";W&&(i="url");var o={username:n,credential:t};return o[i]=e,o}function y(){var e=[];return window.RMCExternalIceServers.forEach(function(n){n.urls||(n.urls=n.url),-1!==n.urls.search("stun|stuns")&&e.push(S(n.urls)),-1!==n.urls.search("turn|turns")&&e.push(C(n.urls,n.username,n.credential))}),e}function b(e){return new Promise(function(n,t){Q(e,n,t)})}function k(e,n){e.mandatory&&e.mandatory.chromeMediaSource?n.isScreen=!0:e.mozMediaSource||e.mediaSource?n.isScreen=!0:e.video?n.isVideo=!0:e.audio&&(n.isAudio=!0)}function T(e){function n(n,i){k(e.localMediaConstraints,n),e.onGettingLocalMedia(n,i),n.addEventListener("ended",function(){delete ae.streams[t],ae.mutex=!1,ae.queueRequests.indexOf(e)&&(delete ae.queueRequests[ae.queueRequests.indexOf(e)],ae.queueRequests=c(ae.queueRequests))},!1),ae.streams[t]={stream:n},ae.mutex=!1,ae.queueRequests.length&&T(ae.queueRequests.shift())}if(ae.mutex===!0)return void ae.queueRequests.push(e);ae.mutex=!0;var t=JSON.stringify(e.localMediaConstraints);if(ae.streams[t])n(ae.streams[t].stream,!0);else{if(W&&window.PluginRTC){document.createElement("video");return void window.PluginRTC.getUserMedia({audio:!0,video:!0},function(e){e.streamid=e.id||a(),n(e)},function(e){})}navigator.mediaDevices.getUserMedia(e.localMediaConstraints).then(function(e){e.streamid=e.streamid||e.id||a(),e.idInstance=t,n(e)})["catch"](function(n){e.onLocalMediaError(n,e.localMediaConstraints)})}}function P(e){if("PermissionDeniedError"==e){if(ue="PermissionDeniedError",ce)return ce("PermissionDeniedError");throw new Error("PermissionDeniedError")}"rtcmulticonnection-extension-loaded"==e&&(ue="desktop"),e.sourceId&&ce&&ce(de=e.sourceId)}function x(e){if(e){if(I)return R(e);if("desktop"==ue)return e(!0);window.postMessage("are-you-there","*"),setTimeout(function(){e("screen"==ue?!1:!0)},2e3)}}function R(e){function n(i){var o=i.data;o&&"undefined"!=typeof o.isScreenCapturingEnabled&&(t=!0,e(o.isScreenCapturingEnabled===!0?!0:!1),window.removeEventListener("message",n,!1))}if(e){if(!I)return x(e);var t=!1;window.addEventListener("message",n,!1),window.postMessage({checkIfScreenCapturingEnabled:!0,domains:[document.domain]},"*"),setTimeout(function(){t||e(!0)},2e3)}}function E(e,n){if(!e)throw'"callback" parameter is mandatory.';return de?(e(de),void(de=null)):(ce=e,n?void window.postMessage("audio-plus-tab","*"):void window.postMessage("get-sourceId","*"))}function O(e,n){if(2!=arguments.length&&(n=e,e=window.RMCExtensionID||"ajhifddimkapgcifgcodmmfdlknahffk"),I)return n("not-chrome");var t=document.createElement("img");t.src="chrome-extension://"+e+"/icon.png",t.onload=function(){ue="screen",window.postMessage("are-you-there","*"),setTimeout(function(){n("screen"==ue?e==e?"installed-enabled":"installed-disabled":"installed-enabled")},2e3)},t.onerror=function(){n("not-installed")}}function M(e,n){var t={mozMediaSource:"window",mediaSource:"window",width:29999,height:8640};return I?e(null,t):void x(function(t){var i={mandatory:{chromeMediaSource:ue,maxWidth:29999,maxHeight:8640,minFrameRate:30,maxFrameRate:128,minAspectRatio:1.77},optional:[]};return"desktop"!=ue||de?("desktop"==ue&&(i.mandatory.chromeMediaSourceId=de),void e(null,i)):void E(function(){i.mandatory.chromeMediaSourceId=de,e("PermissionDeniedError"==de?de:null,i),de=null},n)})}function A(e){function n(n,i,o){var r=n.uuid;if(t[r]||(t[r]=[]),t[r].push(n.message),n.last){var a=t[r].join("");n.isobject&&(a=JSON.parse(a));var s=(new Date).getTime(),d=s-n.sendingTime,c={data:a,userid:i,extra:o,latency:d};e.autoTranslateText?(c.original=c.data,e.Translator.TranslateText(c.data,function(n){c.data=n,e.onmessage(c)})):e.onmessage(c),delete t[r]}}var t={};return{receive:n}}var D=!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0,I="undefined"!=typeof window.InstallTrigger,U=Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0,L=!!window.chrome&&!D,N=!!document.documentMode,V=!!navigator.userAgent.match(/Android|iPhone|iPad|iPod|BlackBerry|IEMobile/i);"undefined"!=typeof cordova&&(V=!0,L=!0),navigator&&navigator.userAgent&&-1!==navigator.userAgent.indexOf("Crosswalk")&&(V=!0,L=!0);var W=!V&&(U||N);W&&"undefined"!=typeof URL&&(URL.createObjectURL=function(){});var B=(!!(window.process&&"object"==typeof window.process&&window.process.versions&&window.process.versions["node-webkit"]),50),F=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);L&&F&&F[2]&&(B=parseInt(F[2],10));var G=50;F=navigator.userAgent.match(/Firefox\/(.*)/),I&&F&&F[1]&&(G=parseInt(F[1],10)),window.addEventListener||(window.addEventListener=function(e,n,t){e.attachEvent&&e.attachEvent("on"+n,t)}),window.attachEventListener=function(e,n,t,i){e.addEventListener(n,t,i)};var q=window.MediaStream;"undefined"==typeof q&&"undefined"!=typeof webkitMediaStream&&(q=webkitMediaStream),"undefined"!=typeof q&&("getVideoTracks"in q.prototype||(q.prototype.getVideoTracks=function(){if(!this.getTracks)return[];var e=[];return this.getTracks.forEach(function(n){-1!==n.kind.toString().indexOf("video")&&e.push(n)}),e},q.prototype.getAudioTracks=function(){if(!this.getTracks)return[];var e=[];return this.getTracks.forEach(function(n){-1!==n.kind.toString().indexOf("audio")&&e.push(n)}),e}),"stop"in q.prototype||(q.prototype.stop=function(){this.getAudioTracks().forEach(function(e){e.stop&&e.stop()}),this.getVideoTracks().forEach(function(e){e.stop&&e.stop()})})),function(){function e(){var e,n,t,i=(d.appVersion,d.userAgent),o=d.appName,r=""+parseFloat(d.appVersion),a=parseInt(d.appVersion,10);if(f){o="Opera";try{r=d.userAgent.split("OPR/")[1].split(" ")[0],a=r.split(".")[0]}catch(s){r="0.0.0.0",a=0}}else v?(n=i.indexOf("MSIE"),o="IE",r=i.substring(n+5)):p?(n=i.indexOf("Chrome"),o="Chrome",r=i.substring(n+7)):m?(n=i.indexOf("Safari"),o="Safari",r=i.substring(n+7),-1!==(n=i.indexOf("Version"))&&(r=i.substring(n+8))):l?(n=i.indexOf("Firefox"),o="Firefox",r=i.substring(n+8)):(e=i.lastIndexOf(" ")+1)<(n=i.lastIndexOf("/"))&&(o=i.substring(e,n),r=i.substring(n+1),o.toLowerCase()===o.toUpperCase()&&(o=d.appName));return u&&(o="Edge",r=parseInt(d.userAgent.match(/Edge\/(\d+).(\d+)$/)[2],10).toString()),-1!==(t=r.indexOf(";"))&&(r=r.substring(0,t)),-1!==(t=r.indexOf(" "))&&(r=r.substring(0,t)),a=parseInt(""+r,10),isNaN(a)&&(r=""+parseFloat(d.appVersion),a=parseInt(d.appVersion,10)),{fullVersion:r,version:a,name:o,isPrivateBrowsing:!1}}function n(e,n){var t=0,i=50,o=!1,r=window.setInterval(function(){e()&&(window.clearInterval(r),n(o)),t++>i&&(window.clearInterval(r),o=!0,n(o))},10)}function t(e){var n=e.toLowerCase();if(0===n.indexOf("msie")&&0===n.indexOf("trident"))return!1;var t=/(?:msie|rv:)\s?([\d\.]+)/.exec(n);return!!(t&&parseInt(t[1],10)>=10)}function i(e){var i;if(window.webkitRequestFileSystem)window.webkitRequestFileSystem(window.TEMPORARY,1,function(){i=!1},function(e){console.log(e),i=!0});else if(window.indexedDB&&/Firefox/.test(window.navigator.userAgent)){var o;try{o=window.indexedDB.open("test")}catch(r){i=!0}"undefined"==typeof i&&n(function(){return"done"===o.readyState},function(e){e||(i=!o.result)})}else if(t(window.navigator.userAgent)){i=!1;try{window.indexedDB||(i=!0)}catch(r){i=!0}}else if(window.localStorage&&/Safari/.test(window.navigator.userAgent)){try{window.localStorage.setItem("test",1)}catch(r){i=!0}"undefined"==typeof i&&(i=!1,window.localStorage.removeItem("test"))}n(function(){return"undefined"!=typeof i},function(n){e(i)})}function o(){var e="-",n=d.appVersion,t=d.userAgent,i=e,o=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 3.11",r:/Win16/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}];for(var r in o){var a=o[r];if(a.r.test(t)){i=a.s;break}}var s=e;switch(/Windows/.test(i)&&(/Windows (.*)/.test(i)&&(s=/Windows (.*)/.exec(i)[1]),i="Windows"),i){case"Mac OS X":/Mac OS X (10[\.\_\d]+)/.test(t)&&(s=/Mac OS X (10[\.\_\d]+)/.exec(t)[1]);break;case"Android":/Android ([\.\_\d]+)/.test(t)&&(s=/Android ([\.\_\d]+)/.exec(t)[1]);break;case"iOS":/OS (\d+)_(\d+)_?(\d+)?/.test(t)&&(s=/OS (\d+)_(\d+)_?(\d+)?/.exec(n),s=s[1]+"."+s[2]+"."+(0|s[3]))}return{osName:i,osVersion:s}}function r(e){D.isWebRTCSupported&&(D.isORTCSupported||a(function(n){e(n.match(/^(192\.168\.|169\.254\.|10\.|172\.(1[6-9]|2\d|3[01]))/)?"Local: "+n:"Public: "+n)}))}function a(e){function n(n){var i=/([0-9]{1,3}(\.[0-9]{1,3}){3})/,o=i.exec(n);if(!o)return void console.warn("Could not match IP address in",n);var r=o[1];void 0===t[r]&&e(r),t[r]=!0}var t={},i=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,o=!!window.webkitRTCPeerConnection;if(!i){var r=document.getElementById("iframe");if(!r)throw"NOTE: you need to have an iframe in the page right above the script tag.";var a=r.contentWindow;i=a.RTCPeerConnection||a.mozRTCPeerConnection||a.webkitRTCPeerConnection,o=!!a.webkitRTCPeerConnection}if(i){var s,d={optional:[{RtpDataChannels:!0}]};o&&(s={iceServers:[{urls:"stun:stun.services.mozilla.com"}]},"undefined"!=typeof D&&D.browser.isFirefox&&D.browser.version<=38&&(s[0]={url:s[0].urls}));var c=new i(s,d);c.onicecandidate=function(e){e.candidate&&n(e.candidate.candidate)},c.createDataChannel(""),c.createOffer(function(e){c.setLocalDescription(e,function(){},function(){})},function(){}),setTimeout(function(){var e=c.localDescription.sdp.split("\n");e.forEach(function(e){0===e.indexOf("a=candidate:")&&n(e)})},1e3)}}function s(e){if(x){if(!d.enumerateDevices&&window.MediaStreamTrack&&window.MediaStreamTrack.getSources&&(d.enumerateDevices=window.MediaStreamTrack.getSources.bind(window.MediaStreamTrack)),!d.enumerateDevices&&d.enumerateDevices&&(d.enumerateDevices=d.enumerateDevices.bind(d)),!d.enumerateDevices)return void(e&&e());b=[],k=[],T=[],P=[],d.enumerateDevices(function(n){n.forEach(function(e){var n={};for(var t in e)n[t]=e[t];"audio"===n.kind&&(n.kind="audioinput"),"video"===n.kind&&(n.kind="videoinput");var i;b.forEach(function(e){e.id===n.id&&e.kind===n.kind&&(i=!0)}),i||(n.deviceId||(n.deviceId=n.id),n.id||(n.id=n.deviceId),n.label?("videoinput"!==n.kind||A||(A=!0),"audioinput"!==n.kind||M||(M=!0)):(n.label="Please invoke getUserMedia once.","https:"!==location.protocol&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g)&&(n.label="HTTPs is required to get label of this "+n.kind+" device.")),"audioinput"===n.kind&&(R=!0,-1===k.indexOf(n)&&k.push(n)),"audiooutput"===n.kind&&(E=!0,-1===T.indexOf(n)&&T.push(n)),"videoinput"===n.kind&&(O=!0,-1===P.indexOf(n)&&P.push(n)),-1===b.indexOf(n)&&b.push(n))}),"undefined"!=typeof D&&(D.MediaDevices=b,D.hasMicrophone=R,D.hasSpeakers=E,D.hasWebcam=O,D.isWebsiteHasWebcamPermissions=A,D.isWebsiteHasMicrophonePermissions=M,D.audioInputDevices=k,D.audioOutputDevices=T,D.videoInputDevices=P),e&&e()})}}var d=window.navigator;"undefined"!=typeof d?("undefined"!=typeof d.webkitGetUserMedia&&(d.getUserMedia=d.webkitGetUserMedia),"undefined"!=typeof d.mozGetUserMedia&&(d.getUserMedia=d.mozGetUserMedia)):d={getUserMedia:function(){},userAgent:"Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45"};var c=!!d.userAgent.match(/Android|iPhone|iPad|iPod|BlackBerry|IEMobile/i),u=!(-1===d.userAgent.indexOf("Edge")||!d.msSaveOrOpenBlob&&!d.msSaveBlob),f=!!window.opera||d.userAgent.indexOf(" OPR/")>=0,l="undefined"!=typeof window.InstallTrigger,m=Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0,p=!!window.chrome&&!f,v=!!document.documentMode&&!u,g={Android:function(){return d.userAgent.match(/Android/i)},BlackBerry:function(){return d.userAgent.match(/BlackBerry/i)},iOS:function(){return d.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return d.userAgent.match(/Opera Mini/i)},Windows:function(){return d.userAgent.match(/IEMobile/i)},any:function(){return g.Android()||g.BlackBerry()||g.iOS()||g.Opera()||g.Windows()},getOsName:function(){var e="Unknown OS";return g.Android()&&(e="Android"),g.BlackBerry()&&(e="BlackBerry"),g.iOS()&&(e="iOS"),g.Opera()&&(e="Opera Mini"),g.Windows()&&(e="Windows"),e}},h="Unknown OS",w="Unknown OS Version";if(g.any())h=g.getOsName();else{var S=o();h=S.osName,w=S.osVersion}var C=!1,y=!1;["captureStream","mozCaptureStream","webkitCaptureStream"].forEach(function(e){!C&&e in document.createElement("canvas")&&(C=!0),!y&&e in document.createElement("video")&&(y=!0)});var b=[],k=[],T=[],P=[];d.mediaDevices&&d.mediaDevices.enumerateDevices&&(d.enumerateDevices=function(e){d.mediaDevices.enumerateDevices().then(e)});var x=!1;"undefined"!=typeof _&&"getSources"in _?x=!0:d.mediaDevices&&d.mediaDevices.enumerateDevices&&(x=!0);var R=!1,E=!1,O=!1,M=!1,A=!1;s();var D=window.DetectRTC||{};D.browser=e(),i(function(e){D.browser.isPrivateBrowsing=!!e}),D.browser["is"+D.browser.name]=!0;var I=(!!(window.process&&"object"==typeof window.process&&window.process.versions&&window.process.versions["node-webkit"]),!1);["RTCPeerConnection","webkitRTCPeerConnection","mozRTCPeerConnection","RTCIceGatherer"].forEach(function(e){I||e in window&&(I=!0)}),D.isWebRTCSupported=I,D.isORTCSupported="undefined"!=typeof RTCIceGatherer;var U=!1;D.browser.isChrome&&D.browser.version>=35?U=!0:D.browser.isFirefox&&D.browser.version>=34&&(U=!0),"https:"!==location.protocol&&(U=!1),D.isScreenCapturingSupported=U;var L={isSupported:!1,isCreateMediaStreamSourceSupported:!1};["AudioContext","webkitAudioContext","mozAudioContext","msAudioContext"].forEach(function(e){L.isSupported||e in window&&(L.isSupported=!0,"createMediaStreamSource"in window[e].prototype&&(L.isCreateMediaStreamSourceSupported=!0))}),D.isAudioContextSupported=L.isSupported,D.isCreateMediaStreamSourceSupported=L.isCreateMediaStreamSourceSupported;var N=!1;D.browser.isChrome&&D.browser.version>31&&(N=!0),D.isRtpDataChannelsSupported=N;var V=!1;D.browser.isFirefox&&D.browser.version>28?V=!0:D.browser.isChrome&&D.browser.version>25?V=!0:D.browser.isOpera&&D.browser.version>=11&&(V=!0),D.isSctpDataChannelsSupported=V,D.isMobileDevice=c;var W=!1;d.getUserMedia?W=!0:d.mediaDevices&&d.mediaDevices.getUserMedia&&(W=!0),D.browser.isChrome&&D.browser.version>=46&&"https:"!==location.protocol&&(D.isGetUserMediaSupported="Requires HTTPs"),D.isGetUserMediaSupported=W,D.osName=h,D.osVersion=w;var B="";if(screen.width){var F=screen.width?screen.width:"",G=screen.height?screen.height:"";B+=""+F+" x "+G}D.displayResolution=B,D.isCanvasSupportsStreamCapturing=C,D.isVideoSupportsStreamCapturing=y,D.DetectLocalIPAddress=r,D.isWebSocketsSupported="WebSocket"in window&&2===window.WebSocket.CLOSING,D.isWebSocketsBlocked=!D.isWebSocketsSupported,D.checkWebSocketsSupport=function(e){e=e||function(){};try{var n=new WebSocket("wss://echo.websocket.org:443/");n.onopen=function(){D.isWebSocketsBlocked=!1,e(),n.close(),n=null},n.onerror=function(){D.isWebSocketsBlocked=!0,e()}}catch(t){D.isWebSocketsBlocked=!0,e()}},D.load=function(e){e=e||function(){},s(e)},D.MediaDevices=b,D.hasMicrophone=R,D.hasSpeakers=E,D.hasWebcam=O,D.isWebsiteHasWebcamPermissions=A,D.isWebsiteHasMicrophonePermissions=M,D.audioInputDevices=k,D.audioOutputDevices=T,D.videoInputDevices=P;var q=!1;"setSinkId"in document.createElement("video")&&(q=!0),D.isSetSinkIdSupported=q;var j=!1;D.browser.isFirefox?"getSenders"in mozRTCPeerConnection.prototype&&(j=!0):D.browser.isChrome&&"undefined"!=typeof webkitRTCPeerConnection&&"getSenders"in webkitRTCPeerConnection.prototype&&(j=!0),D.isRTPSenderReplaceTracksSupported=j;var z=!1;D.browser.isFirefox&&D.browser.version>38&&(z=!0),D.isRemoteStreamProcessingSupported=z;var H=!1;"undefined"!=typeof _&&"applyConstraints"in _.prototype&&(H=!0),D.isApplyConstraintsSupported=H;var J=!1;D.browser.isFirefox&&D.browser.version>=43&&(J=!0),D.isMultiMonitorScreenCapturingSupported=J,window.DetectRTC=D}(),document.addEventListener("deviceready",v,!1),v();var j,z={};"undefined"!=typeof mozRTCPeerConnection?j=mozRTCPeerConnection:"undefined"!=typeof webkitRTCPeerConnection?j=webkitRTCPeerConnection:"undefined"!=typeof window.RTCPeerConnection&&(j=window.RTCPeerConnection);var H=window.RTCSessionDescription||window.mozRTCSessionDescription,J=window.RTCIceCandidate||window.mozRTCIceCandidate,_=window.MediaStreamTrack;window.onPluginRTCInitialized=function(){_=window.PluginRTC.MediaStreamTrack,j=window.PluginRTC.RTCPeerConnection,J=window.PluginRTC.RTCIceCandidate,H=window.PluginRTC.RTCSessionDescription},"undefined"!=typeof window.PluginRTC&&window.onPluginRTCInitialized();var X=function(){function e(e){if(!e||"string"!=typeof e)throw"Invalid arguments.";return e=e.replace("a=rtpmap:100 VP8/90000\r\n",""),e=e.replace("a=rtpmap:101 VP9/90000\r\n",""),e=e.replace(/m=video ([0-9]+) RTP\/SAVPF ([0-9 ]*) 100/g,"m=video $1 RTP/SAVPF $2"),e=e.replace(/m=video ([0-9]+) RTP\/SAVPF ([0-9 ]*) 101/g,"m=video $1 RTP/SAVPF $2"),e=e.replace(/m=video ([0-9]+) RTP\/SAVPF 100([0-9 ]*)/g,"m=video $1 RTP/SAVPF$2"),e=e.replace(/m=video ([0-9]+) RTP\/SAVPF 101([0-9 ]*)/g,"m=video $1 RTP/SAVPF$2"),e=e.replace("a=rtcp-fb:120 nack\r\n",""),e=e.replace("a=rtcp-fb:120 nack pli\r\n",""),e=e.replace("a=rtcp-fb:120 ccm fir\r\n",""),e=e.replace("a=rtcp-fb:101 nack\r\n",""),e=e.replace("a=rtcp-fb:101 nack pli\r\n",""),e=e.replace("a=rtcp-fb:101 ccm fir\r\n","")}function n(e){if(!e||"string"!=typeof e)throw"Invalid arguments.";return e=e.replace("a=rtcp-fb:126 nack\r\n",""),e=e.replace("a=rtcp-fb:126 nack pli\r\n","a=rtcp-fb:126 pli\r\n"),e=e.replace("a=rtcp-fb:97 nack\r\n",""),e=e.replace("a=rtcp-fb:97 nack pli\r\n","a=rtcp-fb:97 pli\r\n")}function t(e,n){if(n&&n.getSenders&&n.getSenders().length){if(!e||"string"!=typeof e)throw"Invalid arguments.";n.getSenders().forEach(function(n){for(var t=n.getParameters(),i=0;i<t.codecs.length;i++)if(t.codecs[i].mimeType==e){t.codecs.unshift(t.codecs.splice(i,1));break}n.setParameters(t)})}}function i(e){return e.replace(/m=audio ([0-9]+) RTP\/SAVPF ([0-9 ]*)/g,"m=audio $1 RTP/SAVPF 9")}function o(e,n,t){return n?"undefined"!=typeof I&&I?e:l?e:(t&&(n.screen?n.screen<300&&console.warn("It seems that you are using wrong bandwidth value for screen. Screen sharing is expected to fail."):console.warn("It seems that you are not using bandwidth for screen. Screen sharing is expected to fail.")),n.screen&&t&&(e=e.replace(/b=AS([^\r\n]+\r\n)/g,""),e=e.replace(/a=mid:video\r\n/g,"a=mid:video\r\nb=AS:"+n.screen+"\r\n")),(n.audio||n.video||n.data)&&(e=e.replace(/b=AS([^\r\n]+\r\n)/g,"")),n.audio&&(e=e.replace(/a=mid:audio\r\n/g,"a=mid:audio\r\nb=AS:"+n.audio+"\r\n")),n.video&&(e=e.replace(/a=mid:video\r\n/g,"a=mid:video\r\nb=AS:"+(t?n.screen:n.video)+"\r\n")),e):e}function r(e,n,t){return a(e,0,-1,n,t)}function a(e,n,t,i,o){for(var r=-1!==t?t:e.length,a=n;r>a;++a)if(0===e[a].indexOf(i)&&(!o||-1!==e[a].toLowerCase().indexOf(o.toLowerCase())))return a;return null}function s(e){var n=new RegExp("a=rtpmap:(\\d+) \\w+\\/\\d+"),t=e.match(n);return t&&2===t.length?t[1]:null}function d(e,n){if(l)return e;n=n||{};var t,i=n.min,o=n.max,a=e.split("\r\n"),d=r(a,"a=rtpmap","VP8/90000");if(d&&(t=s(a[d])),!t)return e;var c,u=r(a,"a=rtpmap","rtx/90000");if(u&&(c=s(a[u])),!u)return e;var f=r(a,"a=fmtp:"+c.toString());if(null!==f){var m="\r\n";m+="a=fmtp:"+t+" x-google-min-bitrate="+(i||"228")+"; x-google-max-bitrate="+(o||"228"),a[f]=a[f].concat(m),e=a.join("\r\n")}return e}function c(e,n){if(l)return e;n=n||{};var t,i=e.split("\r\n"),o=r(i,"a=rtpmap","opus/48000");if(o&&(t=s(i[o])),!t)return e;var a=r(i,"a=fmtp:"+t.toString());if(null===a)return e;var d="";return d+="; stereo="+("undefined"!=typeof n.stereo?n.stereo:"1"),d+="; sprop-stereo="+("undefined"!=typeof n["sprop-stereo"]?n["sprop-stereo"]:"1"),"undefined"!=typeof n.maxaveragebitrate&&(d+="; maxaveragebitrate="+(n.maxaveragebitrate||1048576)),"undefined"!=typeof n.maxplaybackrate&&(d+="; maxplaybackrate="+(n.maxplaybackrate||1048576)),"undefined"!=typeof n.cbr&&(d+="; cbr="+("undefined"!=typeof n.cbr?n.cbr:"1")),
"undefined"!=typeof n.useinbandfec&&(d+="; useinbandfec="+n.useinbandfec),"undefined"!=typeof n.usedtx&&(d+="; usedtx="+n.usedtx),"undefined"!=typeof n.maxptime&&(d+="\r\na=maxptime:"+n.maxptime),i[a]=i[a].concat(d),e=i.join("\r\n")}function u(e){return-1===e.indexOf("SAVPF 100 101")||-1===e.indexOf("VP9/90000")?e:e.replace("SAVPF 100 101","SAVPF 101 100")}function f(e){for(var n=e.split("\r\n"),t=null,i=0;i<n.length;i++)if(-1!==n[i].search("opus/48000")){var o=extractSdp(n[i],/:(\d+) opus\/48000/i);break}for(var i=0;i<n.length;i++)if(-1!==n[i].search("a=fmtp")){var r=extractSdp(n[i],/a=fmtp:(\d+)/);if(r===o){t=i;break}}return null===t?e:(n[t]=n[t].concat("; stereo=1; sprop-stereo=1"),e=n.join("\r\n"))}var l=!!navigator.userAgent.match(/Android|iPhone|iPad|iPod|BlackBerry|IEMobile/i);return"undefined"!=typeof cordova&&(l=!0),navigator&&navigator.userAgent&&-1!==navigator.userAgent.indexOf("Crosswalk")&&(l=!0),{removeVPX:e,disableNACK:n,prioritize:t,removeNonG722:i,setApplicationSpecificBandwidth:function(e,n,t){return o(e,n,t)},setVideoBitrates:function(e,n){return d(e,n)},setOpusAttributes:function(e,n){return c(e,n)},preferVP9:u,forceStereoAudio:f}}();window.BandwidthHandler=X;var $,Y=function(){function e(e,n){var t=n.candidate,i=e.candidates,o=i.stun,r=i.turn;if(f(i.reflexive)||(o=i.reflexive),f(i.relay)||(r=i.relay),(i.host||!t.match(/typ host/g))&&(r||!t.match(/typ relay/g))&&(o||!t.match(/typ srflx/g))){var a=e.iceProtocols;if((a.udp||!t.match(/ udp /g))&&(a.tcp||!t.match(/ tcp /g)))return e.enableLogs&&console.debug("Your candidate pairs:",t),{candidate:t,sdpMid:n.sdpMid,sdpMLineIndex:n.sdpMLineIndex}}}return{processCandidates:e}}();"undefined"!=typeof window.getExternalIceServers&&1==window.getExternalIceServers&&w(function(e){e&&e.length&&(window.RMCExternalIceServers=e,window.iceServersLoadCallback&&"function"==typeof window.iceServersLoadCallback&&window.iceServersLoadCallback(e))});var K=function(){function e(e){var n=[];return n.push(S("stun:stun.l.google.com:19302")),n.push(C("turn:webrtcweb.com:80","muazkh","muazkh")),n.push(C("turn:webrtcweb.com:443","muazkh","muazkh")),window.RMCExternalIceServers?n=n.concat(y()):"undefined"!=typeof window.getExternalIceServers&&1==window.getExternalIceServers&&(e.iceServers=n,window.iceServersLoadCallback=function(){e.iceServers=e.iceServers.concat(y())}),n}return{getIceServers:e}}(),Q=null,Z=null,ee=null,ne=null,te=window.webrtcUtils||{};if(te.enableLogs||(te.enableLogs=!0),te.log||(te.log=function(){te.enableLogs&&("undefined"!=typeof module||"function"==typeof require&&"function"==typeof define||console.log.apply(console,arguments))}),te.extractVersion||(te.extractVersion=function(e,n,t){var i=e.match(n);return i&&i.length>=t&&parseInt(i[t],10)}),"object"==typeof window&&(!window.HTMLMediaElement||"srcObject"in window.HTMLMediaElement.prototype||Object.defineProperty(window.HTMLMediaElement.prototype,"srcObject",{get:function(){return"mozSrcObject"in this?this.mozSrcObject:this._srcObject},set:function(e){"mozSrcObject"in this?this.mozSrcObject=e:(this._srcObject=e,this.src=e?URL.createObjectURL(e):null)}}),Q=window.navigator&&window.navigator.getUserMedia),"undefined"!=typeof window&&window.navigator)if(navigator.mozGetUserMedia&&window.mozRTCPeerConnection){if(Z="firefox",ee=te.extractVersion(navigator.userAgent,/Firefox\/([0-9]+)\./,1),ne=31,Q=function(e,n,t){var i=function(e){if("object"!=typeof e||e.require)return e;var n=[];return Object.keys(e).forEach(function(t){if("require"!==t&&"advanced"!==t&&"mediaSource"!==t){var i=e[t]="object"==typeof e[t]?e[t]:{ideal:e[t]};if(void 0===i.min&&void 0===i.max&&void 0===i.exact||n.push(t),void 0!==i.exact&&("number"==typeof i.exact?i.min=i.max=i.exact:e[t]=i.exact,delete i.exact),void 0!==i.ideal){e.advanced=e.advanced||[];var o={};"number"==typeof i.ideal?o[t]={min:i.ideal,max:i.ideal}:o[t]=i.ideal,e.advanced.push(o),delete i.ideal,Object.keys(i).length||delete e[t]}}}),n.length&&(e.require=n),e};return 38>ee&&(te.log("spec: "+JSON.stringify(e)),e.audio&&(e.audio=i(e.audio)),e.video&&(e.video=i(e.video)),te.log("ff37: "+JSON.stringify(e))),navigator.mozGetUserMedia(e,n,t)},navigator.getUserMedia=Q,navigator.mediaDevices||(navigator.mediaDevices={getUserMedia:b,addEventListener:function(){},removeEventListener:function(){}}),navigator.mediaDevices.enumerateDevices=navigator.mediaDevices.enumerateDevices||function(){return new Promise(function(e){var n=[{kind:"audioinput",deviceId:"default",label:"",groupId:""},{kind:"videoinput",deviceId:"default",label:"",groupId:""}];e(n)})},41>ee){var ie=navigator.mediaDevices.enumerateDevices.bind(navigator.mediaDevices);navigator.mediaDevices.enumerateDevices=function(){return ie().then(void 0,function(e){if("NotFoundError"===e.name)return[];throw e})}}}else if(navigator.webkitGetUserMedia&&window.webkitRTCPeerConnection){Z="chrome",ee=te.extractVersion(navigator.userAgent,/Chrom(e|ium)\/([0-9]+)\./,2),ne=38;var oe=function(e){if("object"!=typeof e||e.mandatory||e.optional)return e;var n={};return Object.keys(e).forEach(function(t){if("require"!==t&&"advanced"!==t&&"mediaSource"!==t){var i="object"==typeof e[t]?e[t]:{ideal:e[t]};void 0!==i.exact&&"number"==typeof i.exact&&(i.min=i.max=i.exact);var o=function(e,n){return e?e+n.charAt(0).toUpperCase()+n.slice(1):"deviceId"===n?"sourceId":n};if(void 0!==i.ideal){n.optional=n.optional||[];var r={};"number"==typeof i.ideal?(r[o("min",t)]=i.ideal,n.optional.push(r),r={},r[o("max",t)]=i.ideal,n.optional.push(r)):(r[o("",t)]=i.ideal,n.optional.push(r))}void 0!==i.exact&&"number"!=typeof i.exact?(n.mandatory=n.mandatory||{},n.mandatory[o("",t)]=i.exact):["min","max"].forEach(function(e){void 0!==i[e]&&(n.mandatory=n.mandatory||{},n.mandatory[o(e,t)]=i[e])})}}),e.advanced&&(n.optional=(n.optional||[]).concat(e.advanced)),n};if(Q=function(e,n,t){return e.audio&&(e.audio=oe(e.audio)),e.video&&(e.video=oe(e.video)),te.log("chrome: "+JSON.stringify(e)),navigator.webkitGetUserMedia(e,n,t)},navigator.getUserMedia=Q,navigator.mediaDevices||(navigator.mediaDevices={getUserMedia:b}),navigator.mediaDevices.getUserMedia){var re=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);navigator.mediaDevices.getUserMedia=function(e){return te.log("spec:   "+JSON.stringify(e)),e.audio=oe(e.audio),e.video=oe(e.video),te.log("chrome: "+JSON.stringify(e)),re(e)}}else navigator.mediaDevices.getUserMedia=function(e){return b(e)};"undefined"==typeof navigator.mediaDevices.addEventListener&&(navigator.mediaDevices.addEventListener=function(){te.log("Dummy mediaDevices.addEventListener called.")}),"undefined"==typeof navigator.mediaDevices.removeEventListener&&(navigator.mediaDevices.removeEventListener=function(){te.log("Dummy mediaDevices.removeEventListener called.")})}else navigator.mediaDevices&&navigator.userAgent.match(/Edge\/(\d+).(\d+)$/)?(te.log("This appears to be Edge"),Z="edge",ee=te.extractVersion(navigator.userAgent,/Edge\/(\d+).(\d+)$/,2),ne=12):te.log("Browser does not appear to be WebRTC-capable");else Z="not a browser";"undefined"!=typeof module?module.exports={getUserMedia:Q,webrtcDetectedBrowser:Z,webrtcDetectedVersion:ee,webrtcMinimumVersion:ne,webrtcUtils:te}:"function"==typeof require&&"function"==typeof define&&define([],function(){return{getUserMedia:Q,webrtcDetectedBrowser:Z,webrtcDetectedVersion:ee,webrtcMinimumVersion:ne,webrtcUtils:te}}),"undefined"!=typeof te&&(te.enableLogs=!1);var ae={streams:[],mutex:!1,queueRequests:[],remove:function(e){this.mutex=!1;var n=this.streams[e];if(n){n=n.stream;var t=n.currentUserMediaRequestOptions;this.queueRequests.indexOf(t)&&(delete this.queueRequests[this.queueRequests.indexOf(t)],this.queueRequests=c(this.queueRequests)),this.streams[e].stream=null,delete this.streams[e]}}},se=function(){function e(e){return e?"string"==typeof e||"undefined"==typeof e?e:e.audio&&e.video?null:e.audio?"audio":e.video?"video":void 0:void 0}function n(n,o,r){function a(){if(r.streamEvents[n.streamid].mediaElement){var e=r.streamEvents[n.streamid].mediaElement;e.volume=0,t(200,5,function(){e.volume+=.2})}}n&&n.addEventListener&&("undefined"!=typeof o&&1!=o||n.addEventListener("ended",function(){se.onSyncNeeded(this.streamid,"ended")},!1),n.mute=function(t,a){t=e(t),"undefined"!=typeof a&&(o=a),"undefined"!=typeof t&&"audio"!=t||n.getAudioTracks().forEach(function(e){e.enabled=!1,r.streamEvents[n.streamid].isAudioMuted=!0}),"undefined"!=typeof t&&"video"!=t||n.getVideoTracks().forEach(function(e){e.enabled=!1}),"undefined"!=typeof o&&1!=o||se.onSyncNeeded(n.streamid,"mute",t),r.streamEvents[n.streamid].muteType=t||"both",i(n,"mute",t)},n.unmute=function(t,s){t=e(t),"undefined"!=typeof s&&(o=s),a(),"undefined"!=typeof t&&"audio"!=t||n.getAudioTracks().forEach(function(e){e.enabled=!0,r.streamEvents[n.streamid].isAudioMuted=!1}),"undefined"!=typeof t&&"video"!=t||(n.getVideoTracks().forEach(function(e){e.enabled=!0}),"undefined"!=typeof t&&"video"==t&&r.streamEvents[n.streamid].isAudioMuted&&!function d(e){e||(e=0),e++,100>e&&r.streamEvents[n.streamid].isAudioMuted&&(n.mute("audio"),setTimeout(function(){d(e)},50))}()),"undefined"!=typeof o&&1!=o||se.onSyncNeeded(n.streamid,"unmute",t),r.streamEvents[n.streamid].unmuteType=t||"both",i(n,"unmute",t)})}function t(e,n,i,o){o=(o||0)+1,o>=n||setTimeout(function(){i(),t(e,n,i,o)},e)}return{setHandlers:n,onSyncNeeded:function(e,n,t){}}}();window.addEventListener("message",function(e){e.origin==window.location.origin&&P(e.data)});var de,ce,ue="screen",fe={send:function(e){function n(e,r){var a={type:"text",uuid:u,sendingTime:f};e&&(r=e,a.packets=parseInt(r.length/s)),r.length>s?a.message=r.slice(0,s):(a.message=r,a.last=!0,a.isobject=c),i.send(a,o),d=r.slice(a.message.length),d.length&&setTimeout(function(){n(null,d)},t.chunkInterval||100)}var t=e.connection,i=e.channel,o=e.remoteUserId,r=e.text,s=t.chunkSize||1e3,d="",c=!1;l(r)||(c=!0,r=JSON.stringify(r));var u=a(),f=(new Date).getTime();n(r)}},le=function(){function e(e){function n(e,n){if(-1!==e.position){var t=+e.position.toFixed(2).split(".")[1]||100;n.innerHTML=t+"%"}}var t={};e.onFileStart=function(n){var i=document.createElement("div");return i.title=n.name,i.innerHTML="<label>0%</label> <progress></progress>",n.remoteUserId&&(i.innerHTML+=" (Sharing with:"+n.remoteUserId+")"),e.filesContainer||(e.filesContainer=document.body||document.documentElement),e.filesContainer.insertBefore(i,e.filesContainer.firstChild),n.remoteUserId?(t[n.uuid]||(t[n.uuid]={}),t[n.uuid][n.remoteUserId]={div:i,progress:i.querySelector("progress"),label:i.querySelector("label")},void(t[n.uuid][n.remoteUserId].progress.max=n.maxChunks)):(t[n.uuid]={div:i,progress:i.querySelector("progress"),label:i.querySelector("label")},void(t[n.uuid].progress.max=n.maxChunks))},e.onFileProgress=function(e){var i=t[e.uuid];i&&(e.remoteUserId&&!(i=t[e.uuid][e.remoteUserId])||(i.progress.value=e.currentPosition||e.maxChunks||i.progress.max,n(i.progress,i.label)))},e.onFileEnd=function(e){var n=t[e.uuid];if(!n)return void console.error("No such progress-helper element exists.",e);if(!e.remoteUserId||(n=t[e.uuid][e.remoteUserId])){var i=n.div;-1!=e.type.indexOf("image")?i.innerHTML='<a href="'+e.url+'" download="'+e.name+'">Download <strong style="color:red;">'+e.name+'</strong> </a><br /><img src="'+e.url+'" title="'+e.name+'" style="max-width: 80%;">':i.innerHTML='<a href="'+e.url+'" download="'+e.name+'">Download <strong style="color:red;">'+e.name+'</strong> </a><br /><iframe src="'+e.url+'" title="'+e.name+'" style="width: 80%;border: 0;height: inherit;margin-top:1em;"></iframe>'}}}return{handle:e}}(),me=function(){function e(e){e.autoTranslateText=!1,e.language="en",e.googKey="AIzaSyCgB5hmFY74WYB-EoWkhr9cAGr6TiTHrEE",e.Translator={TranslateText:function(n,t){var i=document.createElement("script");i.type="text/javascript";var o=encodeURIComponent(n),r="method"+e.token();window[r]=function(e){e.data&&e.data.translations[0]&&t&&t(e.data.translations[0].translatedText),e.error&&"Daily Limit Exceeded"===e.error.message&&(warn('Text translation failed. Error message: "Daily Limit Exceeded."'),t(n))};var a="https://www.googleapis.com/language/translate/v2?key="+e.googKey+"&target="+(e.language||"en-US")+"&callback=window."+r+"&q="+o;i.src=a,document.getElementsByTagName("head")[0].appendChild(i)}}}return{handle:e}}();window.RTCMultiConnection=e}();
var CanvasDesigner=function(){function e(e){t&&t.contentWindow.postMessage({canvasDesignerSyncData:e},"*")}function n(){event.data&&event.data.canvasDesignerSyncData&&s(event.data.canvasDesignerSyncData)}var t,a={line:!0,pencil:!0,dragSingle:!0,dragMultiple:!0,eraser:!0,rectangle:!0,arc:!0,bezier:!0,quadratic:!0,text:!0},i="pencil",s=function(e){},c=window.addEventListener?"addEventListener":"attachEvent",d=window[c],r="attachEvent"==c?"onmessage":"message";return d(r,function(e){console.log("parent received message!:  ",e.data),e.data&&e.data.canvasDesignerSyncData&&s(e.data.canvasDesignerSyncData)},!1),{appendTo:function(e){t=document.createElement("iframe"),t.id="drawboard",t.src="widget.html?tools="+JSON.stringify(a)+"&selectedIcon="+i,t.style.width="100%",t.style.height="100%",t.style.border=0,e.appendChild(t)},destroy:function(){t&&t.parentNode.removeChild(t),window.removeEventListener("message",n)},addSyncListener:function(e){s=e},syncData:e,setTools:function(e){a=e},setSelected:function(e){"undefined"!=typeof a[e]&&(i=e)}}}();
!function(){function e(e,o){var n={audio:!1,video:{mandatory:{chromeMediaSource:e?"screen":"desktop",maxWidth:window.screen.width>1920?window.screen.width:1920,maxHeight:window.screen.height>1080?window.screen.height:1080},optional:[]}};return o&&(n.video.mandatory.chromeMediaSourceId=o),n}function o(){return d?d.isLoaded?void d.contentWindow.postMessage({captureSourceId:!0},"*"):void setTimeout(o,100):void n(o)}function n(e){return d?void e():(d=document.createElement("iframe"),d.onload=function(){d.isLoaded=!0,e()},d.src="getScreenId.html",d.style.display="none",void(document.body||document.documentElement).appendChild(d))}window.getScreenId=function(n){function d(o){o.data&&(o.data.chromeMediaSourceId&&("PermissionDeniedError"===o.data.chromeMediaSourceId?n("permission-denied"):n(null,o.data.chromeMediaSourceId,e(null,o.data.chromeMediaSourceId))),o.data.chromeExtensionStatus&&n(o.data.chromeExtensionStatus,null,e(o.data.chromeExtensionStatus)),window.removeEventListener("message",d))}return navigator.mozGetUserMedia?void n(null,"firefox",{video:{mozMediaSource:"window",mediaSource:"window"}}):(o(),void window.addEventListener("message",d))};var d;window.getScreenConstraints=function(e){n(function(){getScreenId(function(o,n,d){e(o,d.video)})})}}();
!function(){function e(e,n){function i(){a.signal({leaving:!0}),a.isbroadcaster&&(a.stopBroadcasting=!0),e.stream&&e.stream.stop(),window.Firebase&&o.remove()}var o,r=e.userid||t();e.userid||(e.userid=r);var a=this,d={},s={},c=0;this.onmessage=function(t){if(console.log(a.sentParticipationRequest),console.log(n),console.log(t),null!=t.roomid&&null!=t.userid&&(screen_roomid=t.roomid,screen_userid=t.userid),t.roomid==n&&t.broadcasting&&!a.sentParticipationRequest?e.onscreen(t):console.debug(JSON.stringify(t,function(e,n){return n.sdp?(console.log(n.sdp.type,"————",n.sdp.sdp),""):n},"————")),t.sdp&&t.to==r&&this.onsdp(t),t.candidate&&t.to==r&&this.onice(t),t.participationRequest&&t.to==r){var i=l;i.to=t.userid,i.stream=e.stream,d[t.userid]=w.createOffer(i),c++,e.onNumberOfParticipantsChnaged&&e.onNumberOfParticipantsChnaged(c)}},this.onsdp=function(n){var t=JSON.parse(n.sdp);if("offer"==t.type){var i=l;i.stream=e.stream,i.sdp=t,i.to=n.userid,d[n.userid]=b.createAnswer(i)}"answer"==t.type&&d[n.userid].setRemoteDescription(t)},this.onice=function(e){e.candidate=JSON.parse(e.candidate);var n=d[e.userid];if(n){n.addIceCandidate(e.candidate);var t=s[e.userid]||[];if(t.length){for(var i=0;i<t.length;i++)n.addIceCandidate(t[i]);s[e.userid]=[]}}else{var o=s[e.userid];o?s[e.userid][o.length]=e.candidate:s[e.userid]=[e.candidate]}};var l={onsdp:function(e,n){console.log("local-sdp",JSON.stringify(e.sdp,null,"	")),a.signal({sdp:JSON.stringify(e),to:n})},onicecandidate:function(e,n){a.signal({candidate:JSON.stringify(e),to:n})},onaddstream:function(n,t){function i(){return f?o():void(r.readyState<=HTMLMediaElement.HAVE_CURRENT_DATA||r.paused||r.currentTime<=0?setTimeout(i,300):o())}function o(){e.onaddstream&&e.onaddstream({video:r,stream:n,userid:t,type:"remote"})}console.debug("onaddstream",">>>>>>",n),document.getElementById("viewScreenShareButton").removeAttribute("disabled"),n.onended=function(){e.onuserleft&&e.onuserleft(t)};var r=document.createElement("video");r.id=t,r[u?"mozSrcObject":"src"]=u?n:window.webkitURL.createObjectURL(n),r.autoplay=!0,r.controls=!0,r.play(),i()}};if(this.broadcast=function(n){a.roomid=n.roomid||t(),n.userid&&(r=n.userid),a.isbroadcaster=!0,function i(){a.signal({roomid:a.roomid,broadcasting:!0}),a.stopBroadcasting||e.transmitOnce||setTimeout(i,3e3)}(),o.onDisconnect&&o.onDisconnect().remove()},this.join=function(e){a.roomid=e.roomid,this.signal({participationRequest:!0,to:e.to}),a.sentParticipationRequest=!0},window.addEventListener("beforeunload",function(){i()},!1),window.addEventListener("keyup",function(e){116==e.keyCode&&i()},!1),e.leave=i,e.openSignalingChannel)o=e.openSignalingChannel(function(n){n=JSON.parse(n);var t=!1;"number"==typeof r&&parseInt(n.userid)!=r&&(t=!0),"string"==typeof r&&n.userid+""!=r&&(t=!0),t&&(n.to&&("number"==typeof r&&(n.to=parseInt(n.to)),"string"==typeof r&&(n.to=n.to+"")),n.leaving?(e.onuserleft(n.userid),c--,e.onNumberOfParticipantsChnaged&&e.onNumberOfParticipantsChnaged(c)):a.onmessage(n))}),this.signal=function(e){e.userid=r,o.send(JSON.stringify(e))};else{if(!window.Firebase)throw"You must link <https://cdn.firebase.com/v0/firebase.js> file.";o=new window.Firebase("https://"+(e.firebase||"signaling")+".firebaseIO.com/"+e.channel),o.on("child_added",function(n){var t=n.val(),i=!1;"number"==typeof r&&parseInt(t.userid)!=r&&(i=!0),"string"==typeof r&&t.userid+""!=r&&(i=!0),i&&(t.to&&("number"==typeof r&&(t.to=parseInt(t.to)),"string"==typeof r&&(t.to=t.to+"")),t.leaving?(c--,e.onNumberOfParticipantsChnaged&&e.onNumberOfParticipantsChnaged(c),e.onuserleft(t.userid)):a.onmessage(t)),i&&n.ref().remove()}),this.signal=function(e){e.userid=r,o.push(e)}}}function n(e,t){if(!p){if(!t)return n(e,!0);p=!0;var i=document.createElement("iframe");i.onload=function(){i.isLoaded=!0,window.addEventListener("message",function(n){window.iceServers=n.data.iceServers,n.data&&n.data.iceServers&&e(n.data.iceServers)}),i.contentWindow.postMessage("get-ice-servers","*")},i.src="getIceServers.html",i.style.display="none",(document.body||document.documentElement).appendChild(i)}}function t(){return Math.round(9999999999*Math.random())+9999999999}function i(){}function o(e){console.error("sdp error:",e)}function r(e){if(u)return e;if(f)return e;if("undefined"!=typeof BandwidthHandler){window.isMobileDevice=f,window.isFirefox=u;var n={screen:300,video:256},t=!1;return e=BandwidthHandler.setApplicationSpecificBandwidth(e,n,t),e=BandwidthHandler.setVideoBitrates(e,{min:n.video,max:n.video})}return e=e.replace(/b=AS([^\r\n]+\r\n)/g,""),e=e.replace(/a=mid:video\r\n/g,"a=mid:video\r\nb=AS:300\r\n")}function a(e,n){var t=document.createElement("script");t.src=e,t.async=!0,document.documentElement.appendChild(t),console.log("loaded",e)}window.Screen=function(n){function t(n){o=new e(r,n&&n.length||r.channel)}function i(e,n){getScreenId(function(n,t,i){console.log("screen_constraints",JSON.stringify(i,null,"	")),navigator.getUserMedia(i,function(n){n.onended=function(){r.onuserleft&&r.onuserleft("self")},r.stream=n;var t=document.createElement("video");t.id="self",t[u?"mozSrcObject":"src"]=u?n:window.webkitURL.createObjectURL(n),t.autoplay=!0,t.controls=!0,t.play(),r.onaddstream({video:t,stream:n,userid:"self",type:"local"}),e(n)},function(e){l&&"http:"===location.protocol?alert("You're not testing it on SSL origin (HTTPS domain) otherwise you didn't enable --allow-http-screen-capture command-line flag on canary."):l?alert("Screen capturing is either denied or not supported. Please install chrome extension for screen capturing or run chrome with command-line flag: --enable-usermedia-screen-capturing"):u&&alert(a),console.error(e)})})}var o,r=this;this.channel=n||location.href.replace(/\/|:|#|%|\.|\[|\]/g,""),this.onscreen=function(e){console.log(" onscreen ",e),r.detectedRoom||(r.detectedRoom=!0,r.view(e))};var a='Make sure that you are using Firefox Nightly and you enabled: media.getusermedia.screensharing.enabled flag from about:config page. You also need to add your domain in "media.getusermedia.screensharing.allowed_domains" flag.';this.share=function(e){i(function(){!o&&t(e),console.log("share new screen ",e),o.broadcast({roomid:e&&e.length||r.channel,userid:r.userid})})},this.view=function(e){!o&&t(),console.log("view and join new screen "),o.join({to:e.userid,roomid:e.roomid})},this.check=t};var d=window.mozRTCPeerConnection||window.webkitRTCPeerConnection,s=window.mozRTCSessionDescription||window.RTCSessionDescription,c=window.mozRTCIceCandidate||window.RTCIceCandidate;navigator.getUserMedia=navigator.mozGetUserMedia||navigator.webkitGetUserMedia;var u=!!navigator.mozGetUserMedia,l=!!navigator.webkitGetUserMedia,f=!!navigator.userAgent.match(/Android|iPhone|iPad|iPod|BlackBerry|IEMobile/i),m=[];m.push({url:"stun:stun.l.google.com:19302"}),m.push({url:"stun:stun.anyfirewall.com:3478"}),m.push({url:"turn:turn.bistri.com:80",credential:"homeo",username:"homeo"}),m.push({url:"turn:turn.anyfirewall.com:443?transport=tcp",credential:"webrtc",username:"webrtc"}),m={iceServers:m};var p;n(function(e){m.iceServers=m.iceServers.concat(e)});var g={optional:[{DtlsSrtpKeyAgreement:!0}]},h={optional:[],mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}},w={createOffer:function(e){var n=new d(m,g);return n.addStream(e.stream),n.onicecandidate=function(n){n.candidate&&e.onicecandidate(n.candidate,e.to)},n.createOffer(function(t){t.sdp=r(t.sdp),n.setLocalDescription(t),e.onsdp(t,e.to)},o,h),this.peer=n,this},setRemoteDescription:function(e){console.log("setting remote descriptions",e.sdp),this.peer.setRemoteDescription(new s(e),i,o)},addIceCandidate:function(e){console.log("adding ice",e.candidate),this.peer.addIceCandidate(new c({sdpMLineIndex:e.sdpMLineIndex,candidate:e.candidate}))}},v={optional:[],mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!0}},b={createAnswer:function(e){var n=new d(m,g);return n.onaddstream=function(n){e.onaddstream(n.stream,e.to)},n.onicecandidate=function(n){n.candidate&&e.onicecandidate(n.candidate,e.to)},console.log("setting remote descriptions",e.sdp.sdp),n.setRemoteDescription(new s(e.sdp),i,o),n.createAnswer(function(t){t.sdp=r(t.sdp),n.setLocalDescription(t),e.onsdp(t,e.to)},o,v),this.peer=n,this},addIceCandidate:function(e){console.log("adding ice",e.candidate),this.peer.addIceCandidate(new c({sdpMLineIndex:e.sdpMLineIndex,candidate:e.candidate}))}};!window.getScreenId&&a("getScreenId.js")}();